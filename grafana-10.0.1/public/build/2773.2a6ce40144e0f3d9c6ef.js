"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2773],{39846:(R,N,t)=>{t.d(N,{P:()=>n});var e=t(66111),h=t(26418),L=t(8581),o=t(36967);const n=v=>{const I=A(v),c=l(I,v);return e.createElement(h.EditorField,{label:"Group by function","data-testid":"cloud-monitoring-aggregation"},e.createElement(L.Ph,{width:"auto",onChange:({value:T})=>v.onChange(T),value:c,options:[{label:"Template Variables",options:v.templateVariableOptions},{label:"Aggregations",expanded:!0,options:I}],placeholder:"Select Reducer",inputId:`${v.refId}-group-by-function`,menuPlacement:"top"}))},A=({metricDescriptor:v})=>{const I=v?.valueType,c=v?.metricKind;return(0,e.useMemo)(()=>!I||!c?[]:(0,o.A_)(I,c).map(T=>({...T,label:T.text})),[I,c])},l=(v,I)=>(0,e.useMemo)(()=>[...v,...I.templateVariableOptions].find(T=>T.value===I.crossSeriesReducer),[v,I.crossSeriesReducer,I.templateVariableOptions])},71086:(R,N,t)=>{t.d(N,{B:()=>A});var e=t(82897),h=t.n(e),L=t(66111),o=t(26418),n=t(46967);const A=({refId:l,value:v="",onChange:I})=>{const[c,T]=(0,L.useState)(v??""),O=(0,e.debounce)(I,1e3);return I=_=>{T(_.target.value),O(_.target.value)},L.createElement(o.EditorField,{label:"Alias by"},L.createElement(n.I,{id:`${l}-alias-by`,value:c,onChange:I}))}},70019:(R,N,t)=>{t.d(N,{v:()=>l});var e=t(66111),h=t(26418),L=t(40467),o=t(36967),n=t(32566),A=t(33468);const l=({refId:v,templateVariableOptions:I,onChange:c,query:T,customMetaData:O,datasource:_,metricDescriptor:M,preprocessor:U})=>{const u=(0,e.useMemo)(()=>(0,o.kU)(O,_),[O,_]);return e.createElement(h.EditorFieldGroup,null,e.createElement(h.EditorField,{label:"Alignment function",tooltip:"The process of alignment consists of collecting all data points received in a fixed length of time, applying a function to combine those data points, and assigning a timestamp to the result."},e.createElement(n.X,{inputId:`${v}-alignment-function`,templateVariableOptions:I,query:T,onChange:a=>c({...T,...a}),metricDescriptor:M,preprocessor:U})),e.createElement(h.EditorField,{label:"Alignment period",tooltip:u},e.createElement(A.$,{inputId:`${v}-alignment-period`,templateVariableOptions:I,current:T.alignmentPeriod,onChange:a=>c({...T,alignmentPeriod:a}),aligmentPeriods:L.dD})))}},32566:(R,N,t)=>{t.d(N,{X:()=>o});var e=t(66111),h=t(8581),L=t(36967);const o=({inputId:n,query:A,templateVariableOptions:l,onChange:v,metricDescriptor:I,preprocessor:c})=>{const{perSeriesAligner:T}=A;let{valueType:O,metricKind:_}=I||{};const{perSeriesAligner:M,alignOptions:U}=(0,e.useMemo)(()=>(0,L.ID)(O,_,T,c),[O,_,T,c]);return e.createElement(h.Ph,{onChange:({value:u})=>v({...A,perSeriesAligner:u}),value:[...U,...l].find(u=>u.value===M),options:[{label:"Template Variables",options:l},{label:"Alignment options",expanded:!0,options:U}],placeholder:"Select Alignment",inputId:n,menuPlacement:"top"})}},29062:(R,N,t)=>{t.d(N,{X:()=>l});var e=t(66111),h=t(26418),L=t(8581),o=t(40467),n=t(36967),A=t(39846);const l=({refId:v,labels:I=[],query:c,onChange:T,variableOptionGroup:O,metricDescriptor:_})=>{const M=(0,e.useMemo)(()=>[O,...(0,n.gY)([...I,...o.$e])],[I,O]);return e.createElement(h.EditorFieldGroup,null,e.createElement(h.EditorField,{label:"Group by",tooltip:"You can reduce the amount of data returned for a metric by combining different time series. To combine multiple time series, you can specify a grouping and a function. Grouping is done on the basis of labels. The grouping function is used to combine the time series in the group into a single time series."},e.createElement(L.NU,{inputId:`${v}-group-by`,width:"auto",placeholder:"Choose label",options:M,value:c.groupBys??[],onChange:U=>{T({...c,groupBys:U.map(u=>u.value)})},menuPlacement:"top"})),e.createElement(A.P,{metricDescriptor:_,templateVariableOptions:O.options,crossSeriesReducer:c.crossSeriesReducer,groupBys:c.groupBys??[],onChange:U=>T({...c,crossSeriesReducer:U}),refId:v}))}},80202:(R,N,t)=>{t.d(N,{p:()=>O});var e=t(66111),h=t(13572),L=t(26418),o=t(52081),n=t(8581),A=t(36967);const l="=",v="AND",I=_=>_.flatMap(({key:M,operator:U,value:u,condition:a})=>[M,U,u,a]).slice(0,-1),c=["=","!=","=~","!=~"].map(h.E),T=["metric.type"],O=({labels:_={},filters:M,onChange:U,variableOptionGroup:u})=>{const a=(0,A.mi)(M),p=a.filter(({key:s})=>!T.includes(s)),r=a.filter(({key:s})=>T.includes(s)),E=(0,e.useMemo)(()=>[u,...(0,A.gY)(Object.keys(_))],[_,u]),i=({key:s="",value:d=""})=>{E.some(f=>f.options?E.some(K=>K.label===s):f.label===s)||E.push({label:s,value:s});const C=_.hasOwnProperty(s)?[u,..._[s].map(h.E)]:[u];return C.some(f=>f.label===d)||C.push({label:d,value:d}),{options:E,valueOptions:C}},m=s=>{const d=s.concat(r).map(({key:G,operator:C,value:$,condition:f})=>({key:G||"",operator:C||l,value:$||"",condition:f||v}));U(I(d))},D=(s,d,G)=>{const{key:C="",operator:$=l,value:f="",condition:K=v}=s,{options:y,valueOptions:X}=i(s);return e.createElement(o.Lh,{spacing:"xs",width:"auto"},e.createElement(n.Ph,{"aria-label":"Filter label key",formatCreateLabel:B=>`Use label key: ${B}`,allowCustomValue:!0,value:C,options:y,onChange:({value:B=""})=>d({key:B,operator:$,value:f,condition:K})}),e.createElement(n.Ph,{value:$,options:c,onChange:({value:B=l})=>d({key:C,operator:B,value:f,condition:K})}),e.createElement(n.Ph,{"aria-label":"Filter label value",placeholder:"add filter value",formatCreateLabel:B=>`Use label value: ${B}`,allowCustomValue:!0,value:f,options:X,onChange:({value:B=""})=>d({key:C,operator:$,value:B,condition:K})}),e.createElement(L.AccessoryButton,{"aria-label":"Remove",icon:"times",variant:"secondary",onClick:G,type:"button"}))};return e.createElement(L.EditorRow,null,e.createElement(L.EditorField,{label:"Filter",tooltip:"To reduce the amount of data charted, apply a filter. A filter has three components: a label, a comparison, and a value. The comparison can be an equality, inequality, or regular expression."},e.createElement(L.EditorList,{items:p,renderItem:D,onChange:m})))}},91797:(R,N,t)=>{t.d(N,{a:()=>L});var e=t(66111),h=t(97379);function L({query:o,onChange:n,onRunQuery:A}){const l=v=>{v.key==="Enter"&&(v.shiftKey||v.ctrlKey)&&(v.preventDefault(),A())};return e.createElement(e.Fragment,null,e.createElement(h.K,{name:"Query",className:"slate-query-field",value:o,rows:10,placeholder:"Enter a Cloud Monitoring MQL query (Run with Shift+Enter)",onBlur:A,onChange:v=>n(v.currentTarget.value),onKeyDown:l}))}},32060:(R,N,t)=>{t.d(N,{a1:()=>U,mO:()=>O});var e=t(66111),h=t(26418),L=t(12767),o=t(52081),n=t(8944),A=t(40467),l=t(98626);const v=({refId:u,onChange:a,graphPeriod:p,variableOptionGroup:r})=>e.createElement(h.EditorRow,null,e.createElement(h.EditorField,{label:"Graph period",htmlFor:`${u}-graph-period`,tooltip:e.createElement(e.Fragment,null,"Set ",e.createElement("code",null,"graph_period")," which forces a preferred period between points. Automatically set to the current interval if left blank.")},e.createElement(o.Lh,null,e.createElement(n.r,{"data-testid":`${u}-switch-graph-period`,value:p!=="disabled",onChange:E=>a(E.currentTarget.checked?"":"disabled")}),e.createElement(l.$d,{inputId:`${u}-graph-period`,templateVariableOptions:r.options,current:p,onChange:a,disabled:p==="disabled",aligmentPeriods:A.Ry}))));var I=t(91797),c=t(66377),T=t(31697);const O=u=>({projectName:u.getDefaultProject(),crossSeriesReducer:"REDUCE_NONE",alignmentPeriod:"cloud-monitoring-auto",perSeriesAligner:L.CS.ALIGN_MEAN,groupBys:[],filters:[]}),_=u=>({projectName:u.getDefaultProject(),query:""});function M({refId:u,query:a,datasource:p,onChange:r,onRunQuery:E,customMetaData:i,variableOptionGroup:m}){const D=(0,e.useCallback)(d=>{r({...a,timeSeriesList:d}),E()},[r,E,a]),s=(0,e.useCallback)(d=>{r({...a,timeSeriesQuery:d}),E()},[r,E,a]);return(0,e.useEffect)(()=>{a.queryType===L.xL.TIME_SERIES_LIST&&!a.timeSeriesList&&r({refId:a.refId,datasource:a.datasource,queryType:L.xL.TIME_SERIES_LIST,intervalMs:a.intervalMs,timeSeriesList:O(p)}),a.queryType===L.xL.TIME_SERIES_QUERY&&!a.timeSeriesQuery&&r({refId:a.refId,datasource:a.datasource,queryType:L.xL.TIME_SERIES_QUERY,intervalMs:a.intervalMs,timeSeriesQuery:_(p)})},[r,a,p]),e.createElement(h.EditorRows,null,[L.xL.TIME_SERIES_LIST,L.xL.ANNOTATION].includes(a.queryType)&&a.timeSeriesList&&e.createElement(T.s,{refId:u,variableOptionGroup:m,customMetaData:i,onChange:D,datasource:p,query:a.timeSeriesList,aliasBy:a.aliasBy,onChangeAliasBy:d=>r({...a,aliasBy:d})}),a.queryType===L.xL.TIME_SERIES_QUERY&&a.timeSeriesQuery&&e.createElement(e.Fragment,null,e.createElement(c.I,{refId:u,datasource:p,onChange:d=>s({...a.timeSeriesQuery,projectName:d}),templateVariableOptions:m.options,projectName:a.timeSeriesQuery.projectName}),e.createElement(I.a,{onChange:d=>s({...a.timeSeriesQuery,query:d}),onRunQuery:E,query:a.timeSeriesQuery.query}),e.createElement(v,{onChange:d=>s({...a.timeSeriesQuery,graphPeriod:d}),graphPeriod:a.timeSeriesQuery.graphPeriod,refId:u,variableOptionGroup:m})))}const U=e.memo(M)},33468:(R,N,t)=>{t.d(N,{$:()=>L});var e=t(66111),h=t(8581);function L({inputId:o,templateVariableOptions:n,onChange:A,current:l,disabled:v,aligmentPeriods:I}){const c=(0,e.useMemo)(()=>I.map(O=>({...O,label:O.text})),[I]),T=(0,e.useMemo)(()=>c.filter(O=>!O.hidden),[c]);return e.createElement(h.Ph,{width:"auto",onChange:({value:O})=>A(O),value:[...c,...n].find(O=>O.value===l),options:[{label:"Template Variables",options:n},{label:"Aggregations",expanded:!0,options:T}],placeholder:"Select Period",inputId:o,disabled:v,allowCustomValue:!0,menuPlacement:"top"})}},75740:(R,N,t)=>{t.d(N,{A:()=>l});var e=t(66111),h=t(26418),L=t(2594),o=t(36967),n=t(12767);const A={label:"None",value:n.mG.None},l=({query:I,metricDescriptor:c,onChange:T})=>{const O=v(c);return e.createElement(h.EditorField,{label:"Pre-processing",tooltip:"Preprocessing options are displayed when the selected metric has a metric kind of delta or cumulative. The specific options available are determined by the metric's value type. If you select 'Rate', data points are aligned and converted to a rate per time series. If you select 'Delta', data points are aligned by their delta (difference) per time series"},e.createElement(L.S,{onChange:_=>{const{perSeriesAligner:M}=I,{valueType:U,metricKind:u}=c??{},{perSeriesAligner:a}=(0,o.ID)(U,u,M,_);T({...I,preprocessor:_,perSeriesAligner:a})},value:I.preprocessor??n.mG.None,options:O}))},v=I=>{const c=I?.metricKind,T=I?.valueType;return(0,e.useMemo)(()=>{if(!c||c===n.lH.GAUGE||T===n.$h.DISTRIBUTION)return[A];const O=[A,{label:"Rate",value:n.mG.Rate,description:"Data points are aligned and converted to a rate per time series"}];return c===n.lH.CUMULATIVE?[...O,{label:"Delta",value:n.mG.Delta,description:"Data points are aligned by their delta (difference) per time series"}]:O},[c,T])}},66377:(R,N,t)=>{t.d(N,{I:()=>o});var e=t(66111),h=t(26418),L=t(8581);function o({refId:n,projectName:A,datasource:l,onChange:v,templateVariableOptions:I}){const[c,T]=(0,e.useState)([]);(0,e.useEffect)(()=>{l.getProjects().then(_=>T(_))},[l]);const O=(0,e.useMemo)(()=>[{label:"Template Variables",options:I},...c],[c,I]);return e.createElement(h.EditorField,{label:"Project"},e.createElement(L.Ph,{width:"auto",allowCustomValue:!0,formatCreateLabel:_=>`Use project: ${_}`,onChange:({value:_})=>v(_),options:O,value:{value:A,label:A},placeholder:"Select Project",inputId:`${n}-project`}))}},92773:(R,N,t)=>{t.d(N,{W:()=>I});var e=t(66111),h=t(13572),L=t(26418),o=t(12767),n=t(40467);const A=c=>{const{query:T,onChange:O,onRunQuery:_}=c,{queryType:M}=T;return e.createElement(L.EditorHeader,null,e.createElement(L.InlineSelect,{label:"Query type",options:n.XI,value:M,onChange:({value:U})=>{O({...T,queryType:U}),_()}}),e.createElement(L.FlexItem,{grow:1}))};var l=t(58424),v=t(98626);const I=c=>{const{datasource:T,query:O,onRunQuery:_,onChange:M}=c,[U,u]=(0,e.useState)(!1),a=(0,e.useMemo)(()=>{if(!U){u(!0);const s=T.migrateQuery(O);return M({...s}),s}return O},[O,T,M,U]),p={...(0,l.w)(T),...a.sloQuery},r=s=>{M({...a,sloQuery:s}),_()},i=(c.data?.series.length?c.data?.series[0].meta:{})?.custom??{},m={label:"Template Variables",expanded:!1,options:T.getVariables().map(h.E)};(0,e.useEffect)(()=>{Object.values(o.xL).includes(a.queryType)||M({...a,queryType:o.xL.TIME_SERIES_LIST})});const D=a.queryType;return e.createElement(L.EditorRows,null,e.createElement(A,{query:a,onChange:M,onRunQuery:_}),D!==o.xL.SLO&&e.createElement(v.a1,{refId:a.refId,variableOptionGroup:m,customMetaData:i,onChange:M,onRunQuery:_,datasource:T,query:a}),D===o.xL.SLO&&e.createElement(v.D6,{refId:a.refId,variableOptionGroup:m,customMetaData:i,onChange:r,onRunQuery:_,datasource:T,query:p,aliasBy:a.aliasBy,onChangeAliasBy:s=>M({...a,aliasBy:s})}))}},58424:(R,N,t)=>{t.d(N,{D:()=>U,w:()=>M});var e=t(66111),h=t(26418),L=t(40467),o=t(36967),n=t(12767),A=t(71086),l=t(8581);const v=({refId:u,current:a,templateVariableOptions:p,onChange:r})=>{const E=L.yy.map(m=>({...m,label:m.text}));a&&!E.find(m=>m.value===a)&&E.push({label:a,text:a,value:a,hidden:!1});const i=E.filter(m=>!m.hidden);return e.createElement(h.EditorField,{label:"Lookback period",htmlFor:`${u}-lookback-period`},e.createElement(l.Ph,{inputId:`${u}-lookback-period`,width:"auto",allowCustomValue:!0,value:[...E,...p].find(m=>m.value===a),options:[{label:"Template Variables",options:p},{label:"Predefined periods",expanded:!0,options:i}],onChange:({value:m})=>r(m)}))};var I=t(33468),c=t(66377);const T=({refId:u,query:a,templateVariableOptions:p,onChange:r,datasource:E})=>{const[i,m]=(0,e.useState)([]),{projectName:D,serviceId:s}=a;return(0,e.useEffect)(()=>{!D||!s||E.getServiceLevelObjectives(D,s).then(d=>{m([{label:"Template Variables",options:p},...d])})},[E,D,s,p]),e.createElement(h.EditorField,{label:"SLO"},e.createElement(l.Ph,{inputId:`${u}-slo`,width:"auto",allowCustomValue:!0,value:a?.sloId&&{value:a?.sloId,label:a?.sloName||a?.sloId},placeholder:"Select SLO",options:i,onChange:async({value:d="",label:G=""})=>{const $=(await E.getServiceLevelObjectives(D,s)).find(({value:f})=>f===E.templateSrv.replace(d));r({...a,sloId:d,sloName:G,goal:$?.goal})}}))},O=({refId:u,query:a,templateVariableOptions:p,onChange:r,datasource:E})=>e.createElement(h.EditorField,{label:"Selector",htmlFor:`${u}-slo-selector`},e.createElement(l.Ph,{inputId:`${u}-slo-selector`,width:"auto",allowCustomValue:!0,value:[...L.IR,...p].find(i=>i.value===a?.selectorName),options:[{label:"Template Variables",options:p},...L.IR],onChange:({value:i})=>r({...a,selectorName:i??""})})),_=({refId:u,query:a,templateVariableOptions:p,onChange:r,datasource:E})=>{const[i,m]=(0,e.useState)([]),{projectName:D}=a;return(0,e.useEffect)(()=>{D&&E.getSLOServices(D).then(s=>{m([{label:"Template Variables",options:p},...s])})},[E,D,p]),e.createElement(h.EditorField,{label:"Service"},e.createElement(l.Ph,{inputId:`${u}-slo-service`,width:"auto",allowCustomValue:!0,value:a?.serviceId&&{value:a?.serviceId,label:a?.serviceName||a?.serviceId},placeholder:"Select service",options:i,onChange:({value:s="",label:d=""})=>r({...a,serviceId:s,serviceName:d,sloId:""})}))},M=u=>({projectName:u.getDefaultProject(),alignmentPeriod:"cloud-monitoring-auto",perSeriesAligner:n.CS.ALIGN_MEAN,aliasBy:"",selectorName:"select_slo_health",serviceId:"",serviceName:"",sloId:"",sloName:"",lookbackPeriod:""});function U({refId:u,query:a,datasource:p,onChange:r,variableOptionGroup:E,customMetaData:i,aliasBy:m,onChangeAliasBy:D}){const s=(0,e.useMemo)(()=>(0,o.kU)(i,p),[i,p]);return e.createElement(e.Fragment,null,e.createElement(h.EditorRow,null,e.createElement(c.I,{refId:u,templateVariableOptions:E.options,projectName:a.projectName,datasource:p,onChange:d=>r({...a,projectName:d})}),e.createElement(_,{refId:u,datasource:p,templateVariableOptions:E.options,query:a,onChange:r}),e.createElement(T,{refId:u,datasource:p,templateVariableOptions:E.options,query:a,onChange:r}),e.createElement(O,{refId:u,datasource:p,templateVariableOptions:E.options,query:a,onChange:r}),a.selectorName===L.Fh&&e.createElement(v,{refId:u,onChange:d=>r({...a,lookbackPeriod:d}),current:a.lookbackPeriod,templateVariableOptions:E.options}),e.createElement(h.EditorFieldGroup,null,e.createElement(h.EditorField,{label:"Alignment period",tooltip:s},e.createElement(I.$,{inputId:`${u}-alignment-period`,templateVariableOptions:E.options,current:a.alignmentPeriod,onChange:d=>r({...a,alignmentPeriod:d}),aligmentPeriods:L.dD}))),e.createElement(A.B,{refId:u,value:m,onChange:D})))}},31697:(R,N,t)=>{t.d(N,{s:()=>E});var e=t(9892),h=t(82897),L=t.n(h),o=t(66111),n=t(26418),A=t(72648),l=t(27501),v=t(8581),I=t(36967),c=t(12767),T=t(71086),O=t(70019),_=t(29062),M=t(80202),U=t(32060),u=t(75740),a=t(66377);function p({refId:i,onChange:m,datasource:D,query:s,variableOptionGroup:d,customMetaData:G,aliasBy:C,onChangeAliasBy:$}){const[f,K]=(0,o.useState)({}),[y,X]=(0,o.useState)([]),[B,k]=(0,o.useState)(),[q,z]=(0,o.useState)([]),[ee,ne]=(0,o.useState)([]),[se,J]=(0,o.useState)(""),[b,oe]=(0,o.useState)({...D.timeSrv.timeRange()});(P=>{b!==null&&(b.raw.from.toString()!==P.raw.from.toString()||b.raw.to.toString()!==P.raw.to.toString())&&oe({...P})})(D.timeSrv.timeRange());const re=(0,A.l4)(),Z=(0,l.D)(re),w=(0,A.wW)(r),{projectName:H,groupBys:te,crossSeriesReducer:le}=s,x=(0,I.WH)(s),{templateSrv:V}=D,j=(0,o.useCallback)((P,S)=>P.find(g=>g.type===V.replace(S)),[V]);(0,o.useEffect)(()=>{H&&x&&D.getLabels(x,i,H,{groupBys:te,crossSeriesReducer:le},b).then(P=>K(P))},[D,te,x,H,i,le,b]),(0,o.useEffect)(()=>{(async()=>{if(H){const S=await D.getMetricTypes(H),g=Ee(S);X(S),ne(g)}})()},[D,H,w,Z.optionDescription]),(0,o.useEffect)(()=>{const S=(F=>{const Q=j(F,x);return Q?F.filter(W=>W.service===Q.service).map(W=>({service:W.service,value:W.type,label:W.displayName,component:function(){return o.createElement("div",null,o.createElement("div",{className:w},W.type),o.createElement("div",{className:Z.optionDescription},W.description))}})):[]})(y),g=S.length>0?S[0].service:"",Y=j(y,x);k(Y),z(S),J(g)},[y,j,x,w,Z.optionDescription]);const ie=({value:P})=>{const S=y.filter(g=>g.service===V.replace(P)).map(g=>({service:g.service,value:g.type,label:g.displayName,description:g.description}));s.filters=[],S.length>0&&!S.some(g=>g.value===V.replace(x))?(ae(S[0]),J(P),z(S)):(J(P),z(S))},Ee=P=>{const S=P.map(g=>({value:g.service,label:(0,h.startCase)(g.serviceShortName)}));return S.length>0?(0,h.uniqBy)(S,g=>g.value):[]},ae=({value:P})=>{const S=j(y,P);k(S);const{metricKind:g,valueType:Y}=S,F=g===c.lH.GAUGE||Y===c.$h.DISTRIBUTION?c.mG.None:c.mG.Rate,{perSeriesAligner:Q}=(0,I.ID)(Y,g,s.perSeriesAligner,F);Object.assign(s,{...(0,U.mO)(D),projectName:s.projectName,filters:s.filters}),m({...(0,I.Av)({...s,perSeriesAligner:Q},P),preprocessor:F})};return o.createElement(o.Fragment,null,o.createElement(n.EditorRow,null,o.createElement(n.EditorFieldGroup,null,o.createElement(a.I,{refId:i,templateVariableOptions:d.options,projectName:H,datasource:D,onChange:P=>{m({...s,projectName:P})}}),o.createElement(n.EditorField,{label:"Service",width:"auto"},o.createElement(v.Ph,{width:"auto",onChange:ie,value:[...ee,...d.options].find(P=>P.value===se),options:[{label:"Template Variables",options:d.options},...ee],placeholder:"Select Services",inputId:`${i}-service`})),o.createElement(n.EditorField,{label:"Metric name",width:"auto"},o.createElement(v.Ph,{width:"auto",onChange:ae,value:[...q,...d.options].find(P=>P.value===x),options:[{label:"Template Variables",options:d.options},...q],placeholder:"Select Metric",inputId:`${i}-select-metric`})))),o.createElement(o.Fragment,null,o.createElement(M.p,{labels:f,filters:s.filters,onChange:P=>m({...s,filters:P}),variableOptionGroup:d}),o.createElement(n.EditorRow,null,o.createElement(u.A,{metricDescriptor:B,query:s,onChange:m}),o.createElement(_.X,{refId:i,labels:Object.keys(f),query:s,onChange:m,variableOptionGroup:d,metricDescriptor:B}),o.createElement(O.v,{refId:i,datasource:D,templateVariableOptions:d.options,query:s,customMetaData:G,onChange:m,metricDescriptor:B,preprocessor:s.preprocessor}),o.createElement(T.B,{refId:i,value:C,onChange:$}))))}const r=i=>e.css`
  label: grafana-select-option-description;
  font-weight: normal;
  font-style: italic;
  color: ${i.colors.text.secondary};
`,E=o.memo(p)},98626:(R,N,t)=>{t.d(N,{zI:()=>A,a1:()=>c.a1,$d:()=>a.$,D6:()=>T.D,Th:()=>U});var e=t(66377),h=t(29062),L=t(70019),o=t(80202),n=t(66111);const A=()=>n.createElement("div",{className:"gf-form grafana-info-box alert-info"},n.createElement("div",null,n.createElement("h5",null,"Annotation Query Format"),n.createElement("p",null,"An annotation is an event that is overlaid on top of graphs. Annotation rendering is expensive so it is important to limit the number of rows returned."," "),n.createElement("p",null,"The Title and Text fields support templating and can use data returned from the query. For example, the Title field could have the following text:"),n.createElement("code",null,"{{metric.type}}"," has value: ","{{metric.value}}"),n.createElement("p",null,"Example Result: ",n.createElement("code",null,"monitoring.googleapis.com/uptime_check/http_status has this value: 502")),n.createElement("span",null,"Patterns:"),n.createElement("p",null,n.createElement("code",null,"{{metric.value}}")," = value of the metric/point"),n.createElement("p",null,n.createElement("code",null,"{{metric.type}}")," = metric type e.g. compute.googleapis.com/instance/cpu/usage_time"),n.createElement("p",null,n.createElement("code",null,"{{metric.name}}")," = name part of metric e.g. instance/cpu/usage_time"),n.createElement("p",null,n.createElement("code",null,"{{metric.service}}")," = service part of metric e.g. compute"),n.createElement("p",null,n.createElement("code",null,"{{metric.label.label_name}}")," = Metric label metadata e.g. metric.label.instance_name"),n.createElement("p",null,n.createElement("code",null,"{{resource.label.label_name}}")," = Resource label metadata e.g. resource.label.zone")));var l=t(32566),v=t(71086),I=t(39846),c=t(32060),T=t(58424),O=t(91797),_=t(81764),M=t(8581);const U=({label:r,onChange:E,value:i,options:m,allowCustomValue:D=!1})=>n.createElement(_._,{label:r,labelWidth:20},n.createElement(M.Ph,{width:25,allowCustomValue:D,value:i,onChange:({value:s})=>E(s),options:m}));var u=t(31697),a=t(33468),p=t(75740)},40467:(R,N,t)=>{t.d(N,{$e:()=>T,Eu:()=>A,Fh:()=>O,IR:()=>_,Ry:()=>I,XI:()=>M,dD:()=>v,lx:()=>l,yy:()=>c});var e=t(12767);const h=71,L=19,o=14,n=28,A=[{text:"none",value:"ALIGN_NONE",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION,e.$h.STRING,e.$h.VALUE_TYPE_UNSPECIFIED,e.$h.BOOL],metricKinds:[e.lH.GAUGE]},{text:"delta",value:"ALIGN_DELTA",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION],metricKinds:[e.lH.CUMULATIVE,e.lH.DELTA]},{text:"rate",value:"ALIGN_RATE",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY],metricKinds:[e.lH.CUMULATIVE,e.lH.DELTA]},{text:"interpolate",value:"ALIGN_INTERPOLATE",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY],metricKinds:[e.lH.GAUGE]},{text:"next older",value:"ALIGN_NEXT_OLDER",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION,e.$h.STRING,e.$h.VALUE_TYPE_UNSPECIFIED,e.$h.BOOL],metricKinds:[e.lH.GAUGE]},{text:"min",value:"ALIGN_MIN",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"max",value:"ALIGN_MAX",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"mean",value:"ALIGN_MEAN",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"count",value:"ALIGN_COUNT",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.BOOL],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"sum",value:"ALIGN_SUM",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"stddev",value:"ALIGN_STDDEV",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"count true",value:"ALIGN_COUNT_TRUE",valueTypes:[e.$h.BOOL],metricKinds:[e.lH.GAUGE]},{text:"count false",value:"ALIGN_COUNT_FALSE",valueTypes:[e.$h.BOOL],metricKinds:[e.lH.GAUGE]},{text:"fraction true",value:"ALIGN_FRACTION_TRUE",valueTypes:[e.$h.BOOL],metricKinds:[e.lH.GAUGE]},{text:"percentile 99",value:"ALIGN_PERCENTILE_99",valueTypes:[e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"percentile 95",value:"ALIGN_PERCENTILE_95",valueTypes:[e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"percentile 50",value:"ALIGN_PERCENTILE_50",valueTypes:[e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"percentile 05",value:"ALIGN_PERCENTILE_05",valueTypes:[e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"percent change",value:"ALIGN_PERCENT_CHANGE",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY],metricKinds:[e.lH.GAUGE,e.lH.DELTA]}],l=[{text:"none",value:"REDUCE_NONE",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION,e.$h.BOOL,e.$h.STRING],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE,e.lH.METRIC_KIND_UNSPECIFIED]},{text:"mean",value:"REDUCE_MEAN",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE]},{text:"min",value:"REDUCE_MIN",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE,e.lH.METRIC_KIND_UNSPECIFIED]},{text:"max",value:"REDUCE_MAX",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE,e.lH.METRIC_KIND_UNSPECIFIED]},{text:"sum",value:"REDUCE_SUM",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE,e.lH.METRIC_KIND_UNSPECIFIED]},{text:"std. dev.",value:"REDUCE_STDDEV",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE,e.lH.METRIC_KIND_UNSPECIFIED]},{text:"count",value:"REDUCE_COUNT",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION,e.$h.BOOL,e.$h.STRING],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE]},{text:"count true",value:"REDUCE_COUNT_TRUE",valueTypes:[e.$h.BOOL],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"count false",value:"REDUCE_COUNT_FALSE",valueTypes:[e.$h.BOOL],metricKinds:[e.lH.GAUGE,e.lH.DELTA]},{text:"99th percentile",value:"REDUCE_PERCENTILE_99",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE]},{text:"95th percentile",value:"REDUCE_PERCENTILE_95",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE]},{text:"50th percentile",value:"REDUCE_PERCENTILE_50",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE]},{text:"5th percentile",value:"REDUCE_PERCENTILE_05",valueTypes:[e.$h.INT64,e.$h.DOUBLE,e.$h.MONEY,e.$h.DISTRIBUTION],metricKinds:[e.lH.GAUGE,e.lH.DELTA,e.lH.CUMULATIVE]}],v=[{text:"grafana auto",value:"grafana-auto"},{text:"stackdriver auto",value:"stackdriver-auto",hidden:!0},{text:"cloud monitoring auto",value:"cloud-monitoring-auto"},{text:"1m",value:"+60s"},{text:"2m",value:"+120s"},{text:"5m",value:"+300s"},{text:"10m",value:"+600s"},{text:"30m",value:"+1800s"},{text:"1h",value:"+3600s"},{text:"3h",value:"+7200s"},{text:"6h",value:"+21600s"},{text:"1d",value:"+86400s"},{text:"3d",value:"+259200s"},{text:"1w",value:"+604800s"}],I=[{text:"auto",value:"auto"},{text:"1m",value:"1m"},{text:"2m",value:"2m"},{text:"5m",value:"5m"},{text:"10m",value:"10m"},{text:"30m",value:"30m"},{text:"1h",value:"1h"},{text:"3h",value:"3h"},{text:"6h",value:"6h"},{text:"1d",value:"1d"},{text:"3d",value:"3d"},{text:"1w",value:"1w"}],c=[{text:"1m",value:"1m"},{text:"2m",value:"2m"},{text:"5m",value:"5m"},{text:"10m",value:"10m"},{text:"30m",value:"30m"},{text:"1h",value:"1h"},{text:"3h",value:"3h"},{text:"6h",value:"6h"},{text:"24h",value:"24h"},{text:"72h",value:"72h"}],T=["metadata.system_labels.cloud_account","metadata.system_labels.name","metadata.system_labels.region","metadata.system_labels.state","metadata.system_labels.instance_group","metadata.system_labels.node_name","metadata.system_labels.service_name","metadata.system_labels.top_level_controller_type","metadata.system_labels.top_level_controller_name","metadata.system_labels.container_image"],O="select_slo_burn_rate",_=[{label:"SLI Value",value:"select_slo_health"},{label:"SLO Compliance",value:"select_slo_compliance"},{label:"SLO Error Budget Remaining",value:"select_slo_budget_fraction"},{label:"SLO Burn Rate",value:O}],M=[{label:"Builder",value:e.xL.TIME_SERIES_LIST},{label:"MQL",value:e.xL.TIME_SERIES_QUERY},{label:"Service Level Objectives (SLO)",value:e.xL.SLO}]},36967:(R,N,t)=>{t.d(N,{A_:()=>T,Av:()=>p,FL:()=>I,ID:()=>_,Qd:()=>O,Qf:()=>v,WH:()=>a,gY:()=>M,kU:()=>u,mi:()=>U,oU:()=>c,qA:()=>l});var e=t(82897),h=t.n(e),L=t(47891),o=t(20308),n=t(40467),A=t(12767);const l=r=>(0,e.uniqBy)(r,"service"),v=(r,E)=>r.filter(i=>i.service===E),I=(r,E,i,m)=>{const D=v(r,m).map(C=>({value:C.type,name:C.displayName})),s=D.some(C=>C.value===i),d=D.length?D[0].value:"";return{metricTypes:D,selectedMetricType:s?E:d}},c=(r,E,i)=>(i&&i===A.mG.Rate&&(E=A.lH.GAUGE),r?n.Eu.filter(m=>m.valueTypes.indexOf(r)!==-1&&m.metricKinds.indexOf(E)!==-1):[]),T=(r,E)=>E?n.lx.filter(i=>i.valueTypes.indexOf(r)!==-1&&i.metricKinds.indexOf(E)!==-1):[],O=async(r,E,i)=>{const m="handleLabelKeysQuery",D=await r.getLabels(E,m,i);return[...Object.keys(D),...n.$e]},_=(r=A.$h.DOUBLE,E=A.lH.GAUGE,i=A.CS.ALIGN_MEAN,m)=>{const D=(0,o.J)(),s=c(r,E,m).map(d=>({...d,label:d.text}));return s.some(d=>d.value===D.replace(i))||(i=s.length>0?s[0].value:A.CS.ALIGN_MEAN),{alignOptions:s,perSeriesAligner:i}},M=r=>{const E=r.reduce((i,m)=>{const D=m.split(".").map(e.startCase),s=(D.length===2?D:(0,e.initial)(D)).join(" "),d={value:m,label:m};return i[s]?i[s]=[...i[s],d]:i[s]=[d],i},{});return Object.entries(E).map(([i,m])=>({label:i,options:m,expanded:!0}),[])},U=r=>(0,e.chunk)(r,4).map(([E,i,m,D="AND"])=>({key:E,operator:i,value:m,condition:D})),u=(r,E)=>{const{perSeriesAligner:i,alignmentPeriod:m}=r;if(!m||!i)return"";const D=n.Eu.find(G=>G.value===E.templateSrv.replace(i)),s=parseInt(m,10);return`${L.secondsToHms(s)} interval (${D?.text??""})`},a=r=>{const E=r?.filters?.findIndex(m=>m==="metric.type");return r?.filters?.[E+2]||""},p=(r,E)=>{if(!r.filters)return r.filters=["metric.type","=",E],r;const i=r?.filters?.findIndex(m=>m==="metric.type");return i===-1?r.filters.push("metric.type","=",E):r.filters[i+2]=E,r}},12767:(R,N,t)=>{t.d(N,{$h:()=>n,Bp:()=>e,CS:()=>A,lH:()=>o,mG:()=>L,xL:()=>h});var e=(l=>(l.Projects="projects",l.Services="services",l.DefaultProject="defaultProject",l.MetricTypes="metricTypes",l.LabelKeys="labelKeys",l.LabelValues="labelValues",l.ResourceTypes="resourceTypes",l.Aggregations="aggregations",l.Aligners="aligners",l.AlignmentPeriods="alignmentPeriods",l.Selectors="selectors",l.SLOServices="sloServices",l.SLO="slo",l))(e||{}),h=(l=>(l.TIME_SERIES_LIST="timeSeriesList",l.TIME_SERIES_QUERY="timeSeriesQuery",l.SLO="slo",l.ANNOTATION="annotation",l))(h||{}),L=(l=>(l.None="none",l.Rate="rate",l.Delta="delta",l))(L||{}),o=(l=>(l.METRIC_KIND_UNSPECIFIED="METRIC_KIND_UNSPECIFIED",l.GAUGE="GAUGE",l.DELTA="DELTA",l.CUMULATIVE="CUMULATIVE",l))(o||{}),n=(l=>(l.VALUE_TYPE_UNSPECIFIED="VALUE_TYPE_UNSPECIFIED",l.BOOL="BOOL",l.INT64="INT64",l.DOUBLE="DOUBLE",l.STRING="STRING",l.DISTRIBUTION="DISTRIBUTION",l.MONEY="MONEY",l))(n||{}),A=(l=>(l.ALIGN_DELTA="ALIGN_DELTA",l.ALIGN_RATE="ALIGN_RATE",l.ALIGN_INTERPOLATE="ALIGN_INTERPOLATE",l.ALIGN_NEXT_OLDER="ALIGN_NEXT_OLDER",l.ALIGN_MIN="ALIGN_MIN",l.ALIGN_MAX="ALIGN_MAX",l.ALIGN_MEAN="ALIGN_MEAN",l.ALIGN_COUNT="ALIGN_COUNT",l.ALIGN_SUM="ALIGN_SUM",l.ALIGN_STDDEV="ALIGN_STDDEV",l.ALIGN_COUNT_TRUE="ALIGN_COUNT_TRUE",l.ALIGN_COUNT_FALSE="ALIGN_COUNT_FALSE",l.ALIGN_FRACTION_TRUE="ALIGN_FRACTION_TRUE",l.ALIGN_PERCENTILE_99="ALIGN_PERCENTILE_99",l.ALIGN_PERCENTILE_95="ALIGN_PERCENTILE_95",l.ALIGN_PERCENTILE_50="ALIGN_PERCENTILE_50",l.ALIGN_PERCENTILE_05="ALIGN_PERCENTILE_05",l.ALIGN_PERCENT_CHANGE="ALIGN_PERCENT_CHANGE",l.ALIGN_NONE="ALIGN_NONE",l))(A||{})}}]);

//# sourceMappingURL=2773.2a6ce40144e0f3d9c6ef.js.map