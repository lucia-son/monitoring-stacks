{"version":3,"file":"NotificationsListPage.fb1c2bae6997bab62fc0.js","mappings":"iPA2HA,QA9GkC,IAAM,CACtC,MAAMA,KAAW,KAAY,UAAU,EAEjC,CAACC,EAAeC,CAAgB,KAAI,YAA8B,CAAC,CAAC,EAEpEC,EAAmB,SAChB,QAAM,KAAc,EAAE,IAAI,0BAA0B,EAGvD,CAACC,EAAOC,EAAkB,KAAI,KAAWF,CAAgB,KAC/D,aAAU,IAAM,CACdE,GAAmB,EAAE,KAAMC,GAAQ,CACjCJ,EAAiBI,CAAG,CACtB,CAAC,CACH,EAAG,CAACD,EAAkB,CAAC,EAEvB,MAAME,GAAsBC,GAAe,CACzC,aACE,IAAI,KAAsB,CACxB,MAAO,SACP,KAAM,mDACN,MAAO,sFACP,KAAM,YACN,YAAa,SACb,QAAS,SACT,UAAW,SAAY,CACrBC,GAA4BD,CAAE,CAChC,CACF,CAAC,CACH,CACF,EAEMC,GAA8B,MAAOD,GAAe,CACxD,QAAM,KAAc,EAAE,OAAO,4BAA4BA,GAAI,EAC7D,MAAMP,GAAgB,MAAMI,GAAmB,EAC/CH,EAAiBD,EAAa,CAChC,EAEA,OACE,gBAAC,IAAI,CAAC,SAAAD,CAAA,EACJ,gBAAC,kBACEI,EAAM,OAAS,gBAAC,SAAGA,EAAM,MAAM,OAAQ,EACvC,CAAC,CAACH,EAAc,QACf,gCACE,gBAAC,OAAI,UAAU,mBACb,gBAAC,OAAI,UAAU,yBAA0B,GACzC,gBAAC,KAAU,CAAC,KAAK,cAAc,KAAK,6BAA4B,aAEhE,CACF,EACA,gBAAC,SAAM,UAAU,oCACf,gBAAC,aACC,gBAAC,UACC,gBAAC,MAAG,MAAO,CAAE,SAAU,OAAQ,GAC7B,gBAAC,cAAO,MAAI,CACd,EACA,gBAAC,MAAG,MAAO,CAAE,SAAU,OAAQ,GAAG,MAAI,EACtC,gBAAC,MAAG,MAAO,CAAE,MAAO,IAAK,EAAG,CAC9B,CACF,EACA,gBAAC,aACEA,EAAc,IAAKS,GAClB,gBAAC,MAAG,IAAKA,EAAa,IACpB,gBAAC,MAAG,UAAU,WACZ,gBAAC,KAAE,KAAM,yBAAyBA,EAAa,WAAYA,EAAa,IAAK,CAC/E,EACA,gBAAC,MAAG,UAAU,WACZ,gBAAC,KAAE,KAAM,yBAAyBA,EAAa,WAAYA,EAAa,IAAK,CAC/E,EACA,gBAAC,MAAG,UAAU,cACZ,gBAAC,KAAe,CAAC,QAAQ,YACtBA,EAAa,WACZ,gBAAC,KAAM,CAAC,SAAQ,GAAC,QAAQ,YAAY,KAAK,MAAK,SAE/C,EAEF,gBAAC,MACC,QAAQ,cACR,KAAK,QACL,KAAK,KACL,QAAS,IAAM,CACbH,GAAmBG,EAAa,EAAE,CACpC,EACF,CACF,CACF,CACF,CACD,CACH,CACF,CACF,EAGD,EAAET,EAAc,QAAUG,EAAM,UAC/B,gBAAC,KACC,MAAM,iDACN,WAAW,cACX,WAAW,4BACX,YAAY,cACZ,OAAO,sDACP,WAAW,kDACX,gBAAgB,aAChB,aAAa,SACf,CAEJ,CACF,CAEJ,C,mQCvHO,SAASO,GAAaC,EAAsBC,EAAiC,CAIlF,IAAIC,EAAUD,EAAgB,KAAK,EACnC,GAAI,CAACC,EAAQ,MAAM,eAAe,EAAG,CACnC,MAAMC,EAAkBD,EACrB,MAAM;AAAA,CAAI,EACV,IAAKE,GAAS,KAAOA,CAAI,EACzB,KAAK;AAAA,CAAI,EACZF,EAAU,cAAcF;AAAA,EAAqBG;AAAA,UAC/C,CACA,OAAOD,CACT,CACO,SAASG,EAA6BJ,EAAiC,CAC5E,MAAMK,EAAc,CAACC,EAAgBC,IAC5B,cAAcA,YAA0B,QAAI,QAErD,OAAOP,EAAgB,QAAQ,gDAAiDK,CAAW,CAC7F,C,wCCCe,SAASG,GAAQC,EAAWC,EAAa,IACtDC,GAAA,GAAa,EAAG,SAAS,EACzB,IAAIC,KAASC,GAAA,GAAUH,CAAW,EAClC,SAAOI,GAAA,GAAQL,EAAW,CAACG,CAAM,CACnC,C,kJCxBO,MAAMG,GAAqB,yDAyBrBC,GAAeC,GAAA,kBAA4B,CACtD,UAAYC,IAAW,CACrB,gBAAiBA,EAAM,SAA4F,CACjH,MAAO,CAAC,CAAE,SAAAC,EAAU,OAAAC,EAAQ,KAAAC,CAAK,KAAO,CACtC,IAAKN,GACL,KAAM,CAAE,SAAAI,EAAoB,OAAAC,EAAgB,KAAAC,CAAW,EACvD,OAAQ,MACV,EACF,CAAC,CACH,EACF,CAAC,EAEY,CAAE,2BAAAC,EAA2B,EAAIN,G,kMCfvC,SAASO,GAA2B,CACzC,SAAAC,EACA,OAAAC,EACA,QAAAC,CACF,EAIG,CACD,MAAMC,KAAS,MAAWC,EAAS,EAE7B,CAACC,EAAcC,CAAe,KAAI,YAAiB,EACnD,CAACC,EAAmBC,CAAoB,KAAI,YAAqC,IAAI,EACrF,CAAE,8BAAAC,CAA8B,EAAIC,GAAA,EAEpC,CACJ,YAAaC,EAAS,CAAC,EACvB,WAAYC,EACZ,QAASC,CACX,EAAIJ,EAA8B,CAChC,aAAc,KACd,OAAQ,CACN,UAAW,GACX,SAAU,GACV,OAAQ,EACV,CACF,CAAC,EAEK,CAACK,EAAYC,CAAa,KAAI,YAAS,EAAE,EAEzCC,KAA0D,WAAQ,IAAM,CAC5E,MAAMC,EAA6C,CAAC,EACpD,MAAI,CAACL,GAAWD,GACdA,EAAO,QAASO,GAAa,CACtBD,EAAMC,EAAS,OAAO,SAAY,IACrCD,EAAMC,EAAS,OAAO,SAAY,EAAI,CAAC,GAEzCD,EAAMC,EAAS,OAAO,SAAY,EAAE,KAAKA,CAAQ,CACnD,CAAC,EAEID,CACT,EAAG,CAACL,EAASD,CAAM,CAAC,EAEdQ,KAAmB,eAAaC,GAAiB,CACrDd,EAAgBc,CAAI,EACpBZ,EAAqB,IAAI,CAC3B,EAAG,CAAC,CAAC,EAECa,KAAqD,WAAQ,IAAM,CACvE,MAAMA,EAAgB,OAAO,KAAKL,CAAkB,EAAE,OAAQI,GAC5DA,EAAK,YAAY,EAAE,SAASN,EAAW,YAAY,CAAC,CACtD,EACMQ,EAA2D,CAAC,EAClED,OAAAA,EAAc,QAASD,GAAS,CAC9BE,EAAoBF,CAAI,EAAIJ,EAAmBI,CAAI,CACrD,CAAC,EACME,CACT,EAAG,CAACN,EAAoBF,CAAU,CAAC,EAEnC,GAAID,EACF,OAAO,KAGT,MAAMU,EAAoB,OAAO,KAAKF,GAAiB,CAAC,CAAC,EAEnDG,EAAU,CAAC,CAAE,MAAAC,EAAO,MAAAC,CAAM,IAAgD,CAC9E,GAAI,CAACL,EACH,OAAO,KAET,MAAMM,EAAWJ,EAAkBE,CAAK,EAElCG,EAAaD,IAAatB,EAEhC,OACE,gBAAC,UACC,KAAK,SACL,MAAOsB,EACP,MAAAD,EACA,aAAW,MAAGvB,EAAO,UAAW,CAAE,CAACA,EAAO,MAAM,EAAGsB,EAAQ,IAAM,EAAG,CAACtB,EAAO,WAAW,EAAGyB,CAAW,CAAC,EACtG,QAAS,IAAMT,EAAiBQ,CAAQ,GAExC,gBAAC,OAAI,aAAW,MAAGxB,EAAO,UAAWA,EAAO,cAAc,GAAIwB,CAAS,EACvE,gBAAC,OAAI,UAAWxB,EAAO,aACrB,gCACE,gBAAC0B,EAAA,EAAI,CAAC,KAAK,QAAS,GAAE,IAAER,EAAcM,CAAQ,EAAE,CAAC,EAAE,OAAO,gBAAqB,EACjF,CACF,CACF,CAEJ,EAEMG,EAAuB,CAACC,EAAgCC,IAAoC,CAEhG,MAAMC,EADYF,EAAU,IAAKG,IAAUA,GAAM,MAAM,EACvB,IAAI,KAAmB,EAEjDC,KAAmB,MAAoBF,CAAa,EACpDG,KAAoB,SAAW,OAAoBJ,EAAa,MAAM,EAAGG,CAAgB,EAM/F,OAJaC,EAAkB,UAC3BC,GAAA,OAAa,OAAoBD,CAAiB,CAAC,KACnDC,GAAA,IAAaL,EAAa,MAAM,CAGtC,EAEMM,EAAc,CAAC,CAAE,MAAAb,EAAO,MAAAC,CAAM,IAA+C,CACjF,MAAM9B,KAAS,WAAQ,IAAOS,EAAeW,EAAmBX,CAAY,EAAI,CAAC,EAAI,CAAC,CAAC,EACjF6B,EAAQtC,EAAO6B,CAAK,EACpBG,EAAarB,GAAmB,SAAS2B,CAAK,EAC9CK,KAAO,WAAQ,IAAMT,EAAqBlC,EAAQsC,CAAK,EAAG,CAACtC,EAAQsC,CAAK,CAAC,EAEzEM,EAAwB,IAAM,CAClC,GAAIZ,GAAcrB,EAAmB,CACnCC,EAAqBD,EAAkB,OAAQW,IAAaA,KAAagB,CAAK,CAAC,EAC/E,MACF,CACA1B,EAAqB,CAAC,GAAID,GAAqB,CAAC,EAAI2B,CAAK,CAAC,CAC5D,EAEA,OACE,gBAAC,UACC,KAAK,SACL,MAAAR,EACA,aAAW,MAAGvB,EAAO,UAAWA,EAAO,eAAgB,CACrD,CAACA,EAAO,MAAM,EAAGsB,EAAQ,IAAM,EAC/B,CAACtB,EAAO,WAAW,EAAGyB,CACxB,CAAC,EACD,QAASY,CAAA,EAET,gBAAC,OAAI,UAAWrC,EAAO,eAAgB,MAAO+B,EAAM,OAAO,SAAW,EACpE,gBAACO,GAAA,EAAO,CAAC,UAAU,SAAS,QAAS,gBAAC,WAAK,KAAK,UAAUP,EAAO,KAAM,CAAC,CAAE,EAAQ,MAAO,QACvF,gBAAC,WACEK,EAAK,IAAI,CAACG,GAAKjB,KACd,gBAACkB,GAAA,EAAG,CAAC,IAAKlB,GAAO,KAAMiB,GAAK,UAAWvC,EAAO,IAAK,CACpD,CACH,CACF,CACF,CACF,CAEJ,EAEMyC,EAAgB,IAAM,CAC1B,MAAMC,EACJtC,GAAmB,IAAKW,IACW,CAC/B,YAAaA,EAAS,YACtB,OAAQA,EAAS,OACjB,SAAUA,EAAS,SACnB,OAAQA,EAAS,MACnB,EAED,GAAK,CAAC,EAETlB,EAAS6C,CAAS,EAClBC,GAAW,CACb,EAEMA,GAAa,IAAM,CACvBxC,EAAgB,MAAS,EACzBE,EAAqB,IAAI,EACzBO,EAAc,EAAE,EAChBgC,GAAkB,EAAE,CACtB,EAEMC,GAAY,IAAM,CACtBF,GAAW,EACX5C,EAAQ,CACV,EAEM6C,GAAqBE,GAAmB,CAC5ClC,EAAckC,CAAM,CACtB,EAEA,OACE,gBAAC,WACC,gBAACC,GAAA,GACC,MAAM,yBACN,UAAW/C,EAAO,MAClB,cAAa,GACb,OAAAF,EACA,UAAA+C,GACA,iBAAkB7C,EAAO,cAEzB,gBAAC,OAAI,UAAWA,EAAO,WACrB,gBAACgD,GAAA,GACC,MAAOrC,EACP,SAAUiC,GACV,MAAM,oBACN,YAAY,oBACZ,UAAS,GACX,EACA,gBAAC,WAAM1C,GAAgB,oDAAuD,EAAG,EAEjF,gBAAC,OAAI,UAAWF,EAAO,QACpBS,GAAW,gBAACwC,EAAA,EAAkB,CAAC,KAAK,mBAAmB,UAAWjD,EAAO,mBAAoB,EAE7F,CAACS,GACA,gBAAC,KAAS,KACP,CAAC,CAAE,OAAAyC,EAAQ,MAAAC,CAAM,IAChB,gBAAC,MAAa,CAAC,SAAU,GAAI,OAAAD,EAAgB,MAAAC,EAAc,UAAW/B,EAAkB,QACrFC,CACH,CAEJ,CAEJ,EAEA,gBAAC,OAAI,UAAWrB,EAAO,QACpB,CAACE,GAAgB,CAACO,GACjB,gBAAC,OAAI,UAAWT,EAAO,yBACrB,gBAAC,WAAI,2DAAyD,CAChE,EAEDS,GAAW,gBAACwC,EAAA,EAAkB,CAAC,KAAK,kBAAkB,UAAWjD,EAAO,mBAAoB,EAE5FE,GAAgBW,EAAmBX,CAAY,EAAE,QAAU,CAACO,GAC3D,gBAAC,KAAS,KACP,CAAC,CAAE,MAAA0C,EAAO,OAAAD,CAAO,IAChB,gBAAC,OACC,SAAU,GACV,OAAAA,EACA,MAAAC,EACA,UAAWtC,EAAmBX,CAAY,EAAE,QAAU,GAErDiC,CACH,CAEJ,CAEJ,CACF,EACA,gBAACY,GAAA,iBACC,gBAACK,EAAA,GAAM,CAAC,KAAK,SAAS,QAAQ,YAAY,QAASP,EAAA,EAAW,QAE9D,EACA,gBAACO,EAAA,IACC,KAAK,SACL,QAAQ,UACR,SAAU,EAAElD,GAAgBE,GAC5B,QAAS,IAAM,CACTF,GAAgBE,GAClBqC,EAAc,CAElB,GACD,2BAED,CACF,CACF,CACF,CAEJ,CAEA,MAAMxC,GAAaoD,GAAyB,CAC1C,MAAMC,KAAc,MAAkBD,CAAK,EAE3C,MAAO,CACL,UAAW;AAAA;AAAA;AAAA;AAAA,aAIFA,EAAM,QAAQ,CAAC;AAAA;AAAA,MAIxB,IAAK;AAAA;AAAA,MAIL,OAAQ;AAAA;AAAA,MAIR,YAAa;AAAA;AAAA;AAAA,MAIb,UAAW;AAAA;AAAA,qBAEMA,EAAM,WAAW;AAAA,MAElC,UAAW;AAAA,QACPC;AAAA,iBACSD,EAAM,QAAQ,EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAUjBA,EAAM,OAAO,KAAK;AAAA;AAAA,MAG/B,eAAgB;AAAA;AAAA,MAGhB,YAAa;AAAA,sBACKA,EAAM,OAAO,QAAQ;AAAA,MAEvC,OAAQ;AAAA,0BACcA,EAAM,OAAO,WAAW;AAAA,MAE9C,eAAgB;AAAA;AAAA,aAEPA,EAAM,QAAQ,CAAC;AAAA;AAAA;AAAA,MAIxB,mBAAoB;AAAA;AAAA;AAAA;AAAA;AAAA,MAMpB,wBAAyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAORA,EAAM,WAAW;AAAA,MAElC,MAAO;AAAA;AAAA,MAGP,aAAc;AAAA;AAAA;AAAA;AAAA,MAKd,WAAY;AAAA;AAAA,MAGZ,SAAU;AAAA,cACAA,EAAM,OAAO,QAAQ;AAAA,MAE/B,OAAQ;AAAA;AAAA,MAGR,YAAa;AAAA;AAAA,mBAEEA,EAAM,WAAW,UAAU;AAAA,eAC/BA,EAAM,OAAO,KAAK;AAAA;AAAA;AAAA;AAAA,oBAIbA,EAAM,QAAQ,CAAC;AAAA;AAAA,KAGjC,CACF,EC9WaE,GAAyC,CACpD,CACE,KAAM,WACN,KAAM,SACN,MAAO,mEACT,EACA,CACE,KAAM,SACN,KAAM,SACN,MAAO,4DACT,EACA,CACE,KAAM,SACN,KAAM,UACN,MAAO,+DACT,EACA,CACE,KAAM,gBACN,KAAM,UACN,MAAO,uBACT,EACA,CACE,KAAM,kBACN,KAAM,UACN,MAAO,yBACT,EACA,CACE,KAAM,cACN,KAAM,WACN,MAAO,sCACT,EACA,CACE,KAAM,eACN,KAAM,WACN,MAAO,gEACT,EACA,CACE,KAAM,oBACN,KAAM,WACN,MAAO,qEACT,EACA,CACE,KAAM,cACN,KAAM,SACN,MAAO,sDACT,CACF,EAEaC,GAA+C,CAC1D,CACE,KAAM,SACN,KAAM,WACN,MAAO,sCACT,EACA,CACE,KAAM,cACN,KAAM,WACN,MAAO,2CACT,EACA,CACE,KAAM,WACN,KAAM,YACN,MAAO,gCACT,EACA,CACE,KAAM,SACN,KAAM,YACN,MAAO,6BACT,CACF,EAEaC,GAAwC,CACnD,CACE,KAAM,SACN,KAAM,SACN,MAAO,qBACT,EACA,CACE,KAAM,SACN,KAAM,WACN,MAAO,sCACT,EACA,CACE,KAAM,cACN,KAAM,WACN,MAAO,2CACT,EACA,CACE,KAAM,SACN,KAAM,WACN,MACE,6IACJ,EACA,CACE,KAAM,WACN,KAAM,YACN,MAAO,gCACT,EACA,CACE,KAAM,SACN,KAAM,YACN,MACE,gJACJ,EACA,CACE,KAAM,eACN,KAAM,SACN,MAAO,kDACT,EACA,CACE,KAAM,aACN,KAAM,SACN,MAAO,qGACT,EACA,CACE,KAAM,eACN,KAAM,SACN,MAAO,2FACT,EACA,CACE,KAAM,WACN,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","sources":["webpack://grafana/./public/app/features/alerting/NotificationsListPage.tsx","webpack://grafana/./public/app/features/alerting/unified/utils/templates.ts","webpack://grafana/../../opt/drone/yarncache/date-fns-npm-2.29.3-fef7e3c72c-e01cf5b62a.zip/node_modules/date-fns/esm/subDays/index.js","webpack://grafana/./public/app/features/alerting/unified/api/templateApi.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/AlertInstanceModalSelector.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/TemplateData.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/TemplateDataDocs.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/GenerateAlertDataModal.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/PayloadEditor.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/editor/alertManagerSuggestions.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/editor/snippets.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/editor/templateDataSuggestions.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/editor/autocomplete.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/editor/definition.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/editor/register.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/TemplateEditor.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/TemplateForm.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/DuplicateTemplateView.tsx","webpack://grafana/./public/app/features/alerting/unified/utils/cloud-alertmanager-notifier-types.ts","webpack://grafana/./public/app/features/alerting/unified/utils/receiver-form.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/CloudCommonChannelSettings.tsx","webpack://grafana/./public/app/features/alerting/unified/hooks/useControlledFieldArray.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/KeyValueMapInput.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/StringArrayInput.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/CollapsibleSection.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/styles.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/SubformArrayField.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/SubformField.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/OptionField.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/ChannelOptions.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/ChannelSubForm.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/fields/DeletedSubform.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/util.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/ReceiverForm.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/CloudReceiverForm.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/GrafanaCommonChannelSettings.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/TestContactPointModal.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/form/GrafanaReceiverForm.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/EditReceiverView.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/EditTemplateView.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/GlobalConfigForm.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/NewReceiverView.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/NewTemplateView.tsx","webpack://grafana/./public/app/plugins/datasource/alertmanager/consts.ts","webpack://grafana/./public/app/features/alerting/unified/utils/receivers.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/ReceiversSection.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/grafanaAppReceivers/types.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/grafanaAppReceivers/GrafanaAppBadge.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/ReceiversTable.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/TemplatesTable.tsx","webpack://grafana/./public/app/features/alerting/unified/components/receivers/ReceiversAndTemplatesView.tsx","webpack://grafana/./public/app/features/alerting/unified/Receivers.tsx","webpack://grafana/./public/app/features/alerting/unified/api/receiversApi.ts","webpack://grafana/./public/app/features/alerting/unified/components/Authorize.tsx","webpack://grafana/./public/app/features/alerting/unified/components/GrafanaAlertmanagerDeliveryWarning.tsx","webpack://grafana/./public/app/features/alerting/unified/components/NoAlertManagerWarning.tsx","webpack://grafana/./public/app/features/alerting/unified/components/Provisioning.tsx","webpack://grafana/./public/app/features/alerting/unified/api/onCallApi.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/grafanaAppReceivers/onCall/onCall.ts","webpack://grafana/./public/app/features/alerting/unified/components/receivers/grafanaAppReceivers/grafanaApp.ts","webpack://grafana/./public/app/features/alerting/unified/components/rules/ActionIcon.tsx","webpack://grafana/./public/app/features/alerting/unified/components/rules/state-history/common.ts","webpack://grafana/./public/app/features/alerting/unified/hooks/useAlertManagerSourceName.ts","webpack://grafana/./public/app/features/alerting/unified/hooks/useAlertManagerSources.ts","webpack://grafana/./public/app/features/alerting/unified/styles/table.ts","webpack://grafana/./public/app/features/alerting/unified/utils/duplicate.ts"],"sourcesContent":["import React, { useState, FC, useEffect } from 'react';\nimport { useAsyncFn } from 'react-use';\n\nimport { getBackendSrv } from '@grafana/runtime';\nimport { HorizontalGroup, Button, LinkButton } from '@grafana/ui';\nimport EmptyListCTA from 'app/core/components/EmptyListCTA/EmptyListCTA';\nimport { Page } from 'app/core/components/Page/Page';\nimport { appEvents } from 'app/core/core';\nimport { useNavModel } from 'app/core/hooks/useNavModel';\nimport { AlertNotification } from 'app/types/alerting';\n\nimport { ShowConfirmModalEvent } from '../../types/events';\n\nconst NotificationsListPage: FC = () => {\n  const navModel = useNavModel('channels');\n\n  const [notifications, setNotifications] = useState<AlertNotification[]>([]);\n\n  const getNotifications = async () => {\n    return await getBackendSrv().get(`/api/alert-notifications`);\n  };\n\n  const [state, fetchNotifications] = useAsyncFn(getNotifications);\n  useEffect(() => {\n    fetchNotifications().then((res) => {\n      setNotifications(res);\n    });\n  }, [fetchNotifications]);\n\n  const deleteNotification = (id: number) => {\n    appEvents.publish(\n      new ShowConfirmModalEvent({\n        title: 'Delete',\n        text: 'Do you want to delete this notification channel?',\n        text2: `Deleting this notification channel will not delete from alerts any references to it`,\n        icon: 'trash-alt',\n        confirmText: 'Delete',\n        yesText: 'Delete',\n        onConfirm: async () => {\n          deleteNotificationConfirmed(id);\n        },\n      })\n    );\n  };\n\n  const deleteNotificationConfirmed = async (id: number) => {\n    await getBackendSrv().delete(`/api/alert-notifications/${id}`);\n    const notifications = await fetchNotifications();\n    setNotifications(notifications);\n  };\n\n  return (\n    <Page navModel={navModel}>\n      <Page.Contents>\n        {state.error && <p>{state.error.message}</p>}\n        {!!notifications.length && (\n          <>\n            <div className=\"page-action-bar\">\n              <div className=\"page-action-bar__spacer\" />\n              <LinkButton icon=\"channel-add\" href=\"alerting/notification/new\">\n                New channel\n              </LinkButton>\n            </div>\n            <table className=\"filter-table filter-table--hover\">\n              <thead>\n                <tr>\n                  <th style={{ minWidth: '200px' }}>\n                    <strong>Name</strong>\n                  </th>\n                  <th style={{ minWidth: '100px' }}>Type</th>\n                  <th style={{ width: '1%' }}></th>\n                </tr>\n              </thead>\n              <tbody>\n                {notifications.map((notification) => (\n                  <tr key={notification.id}>\n                    <td className=\"link-td\">\n                      <a href={`alerting/notification/${notification.id}/edit`}>{notification.name}</a>\n                    </td>\n                    <td className=\"link-td\">\n                      <a href={`alerting/notification/${notification.id}/edit`}>{notification.type}</a>\n                    </td>\n                    <td className=\"text-right\">\n                      <HorizontalGroup justify=\"flex-end\">\n                        {notification.isDefault && (\n                          <Button disabled variant=\"secondary\" size=\"sm\">\n                            default\n                          </Button>\n                        )}\n                        <Button\n                          variant=\"destructive\"\n                          icon=\"times\"\n                          size=\"sm\"\n                          onClick={() => {\n                            deleteNotification(notification.id);\n                          }}\n                        />\n                      </HorizontalGroup>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </>\n        )}\n\n        {!(notifications.length || state.loading) && (\n          <EmptyListCTA\n            title=\"There are no notification channels defined yet\"\n            buttonIcon=\"channel-add\"\n            buttonLink=\"alerting/notification/new\"\n            buttonTitle=\"Add channel\"\n            proTip=\"You can include images in your alert notifications.\"\n            proTipLink=\"http://docs.grafana.org/alerting/notifications/\"\n            proTipLinkTitle=\"Learn more\"\n            proTipTarget=\"_blank\"\n          />\n        )}\n      </Page.Contents>\n    </Page>\n  );\n};\n\nexport default NotificationsListPage;\n","import { now } from 'lodash';\n\nexport function ensureDefine(templateName: string, templateContent: string): string {\n  // notification template content must be wrapped in {{ define \"name\" }} tag,\n  // but this is not obvious because user also has to provide name separately in the form.\n  // so if user does not manually add {{ define }} tag, we do it automatically\n  let content = templateContent.trim();\n  if (!content.match(/\\{\\{\\s*define/)) {\n    const indentedContent = content\n      .split('\\n')\n      .map((line) => '  ' + line)\n      .join('\\n');\n    content = `{{ define \"${templateName}\" }}\\n${indentedContent}\\n{{ end }}`;\n  }\n  return content;\n}\nexport function updateDefinesWithUniqueValue(templateContent: string): string {\n  const getNewValue = (match_: string, originalDefineName: string) => {\n    return `{{ define \"${originalDefineName}_NEW_${now()}\" }}`;\n  };\n  return templateContent.replace(/\\{\\{\\s*define\\s*\\\"(?<defineName>.*)\\\"\\s*\\}\\}/g, getNewValue);\n}\n","import addDays from \"../addDays/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport toInteger from \"../_lib/toInteger/index.js\";\n/**\n * @name subDays\n * @category Day Helpers\n * @summary Subtract the specified number of days from the given date.\n *\n * @description\n * Subtract the specified number of days from the given date.\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of days to be subtracted. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the days subtracted\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Subtract 10 days from 1 September 2014:\n * const result = subDays(new Date(2014, 8, 1), 10)\n * //=> Fri Aug 22 2014 00:00:00\n */\n\nexport default function subDays(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addDays(dirtyDate, -amount);\n}","import { alertingApi } from './alertingApi';\n\nexport const previewTemplateUrl = `/api/alertmanager/grafana/config/api/v1/templates/test`;\n\nexport interface TemplatePreviewResult {\n  name: string;\n  text: string;\n}\nexport interface TemplatePreviewErrors {\n  name?: string;\n  message: string;\n  kind: string;\n}\nexport interface TemplatePreviewResponse {\n  results?: TemplatePreviewResult[];\n  errors?: TemplatePreviewErrors[];\n}\n\nexport interface KeyValueField {\n  key: string;\n  value: string;\n}\nexport interface AlertField {\n  annotations: KeyValueField[];\n  labels: KeyValueField[];\n}\n\nexport const templatesApi = alertingApi.injectEndpoints({\n  endpoints: (build) => ({\n    previewTemplate: build.mutation<TemplatePreviewResponse, { template: string; alerts: AlertField[]; name: string }>({\n      query: ({ template, alerts, name }) => ({\n        url: previewTemplateUrl,\n        data: { template: template, alerts: alerts, name: name },\n        method: 'POST',\n      }),\n    }),\n  }),\n});\n\nexport const { usePreviewTemplateMutation } = templatesApi;\n","import { css, cx } from '@emotion/css';\nimport React, { CSSProperties, useCallback, useMemo, useState } from 'react';\nimport AutoSizer from 'react-virtualized-auto-sizer';\nimport { FixedSizeList } from 'react-window';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport {\n  Button,\n  clearButtonStyles,\n  FilterInput,\n  LoadingPlaceholder,\n  Modal,\n  Tooltip,\n  useStyles2,\n  Icon,\n  Tag,\n} from '@grafana/ui';\nimport { AlertmanagerAlert, TestTemplateAlert } from 'app/plugins/datasource/alertmanager/types';\n\nimport { alertmanagerApi } from '../../api/alertmanagerApi';\nimport { GRAFANA_RULES_SOURCE_NAME } from '../../utils/datasource';\nimport { arrayLabelsToObject, labelsToTags, objectLabelsToArray } from '../../utils/labels';\nimport { extractCommonLabels, omitLabels } from '../rules/state-history/common';\n\nexport function AlertInstanceModalSelector({\n  onSelect,\n  isOpen,\n  onClose,\n}: {\n  onSelect: (alerts: TestTemplateAlert[]) => void;\n  isOpen: boolean;\n  onClose: () => void;\n}) {\n  const styles = useStyles2(getStyles);\n\n  const [selectedRule, setSelectedRule] = useState<string>();\n  const [selectedInstances, setSelectedInstances] = useState<AlertmanagerAlert[] | null>(null);\n  const { useGetAlertmanagerAlertsQuery } = alertmanagerApi;\n\n  const {\n    currentData: result = [],\n    isFetching: loading,\n    isError: error,\n  } = useGetAlertmanagerAlertsQuery({\n    amSourceName: GRAFANA_RULES_SOURCE_NAME,\n    filter: {\n      inhibited: true,\n      silenced: true,\n      active: true,\n    },\n  });\n\n  const [ruleFilter, setRuleFilter] = useState('');\n\n  const rulesWithInstances: Record<string, AlertmanagerAlert[]> = useMemo(() => {\n    const rules: Record<string, AlertmanagerAlert[]> = {};\n    if (!loading && result) {\n      result.forEach((instance) => {\n        if (!rules[instance.labels['alertname']]) {\n          rules[instance.labels['alertname']] = [];\n        }\n        rules[instance.labels['alertname']].push(instance);\n      });\n    }\n    return rules;\n  }, [loading, result]);\n\n  const handleRuleChange = useCallback((rule: string) => {\n    setSelectedRule(rule);\n    setSelectedInstances(null);\n  }, []);\n\n  const filteredRules: Record<string, AlertmanagerAlert[]> = useMemo(() => {\n    const filteredRules = Object.keys(rulesWithInstances).filter((rule) =>\n      rule.toLowerCase().includes(ruleFilter.toLowerCase())\n    );\n    const filteredRulesObject: Record<string, AlertmanagerAlert[]> = {};\n    filteredRules.forEach((rule) => {\n      filteredRulesObject[rule] = rulesWithInstances[rule];\n    });\n    return filteredRulesObject;\n  }, [rulesWithInstances, ruleFilter]);\n\n  if (error) {\n    return null;\n  }\n\n  const filteredRulesKeys = Object.keys(filteredRules || []);\n\n  const RuleRow = ({ index, style }: { index: number; style?: CSSProperties }) => {\n    if (!filteredRules) {\n      return null;\n    }\n    const ruleName = filteredRulesKeys[index];\n\n    const isSelected = ruleName === selectedRule;\n\n    return (\n      <button\n        type=\"button\"\n        title={ruleName}\n        style={style}\n        className={cx(styles.rowButton, { [styles.rowOdd]: index % 2 === 1, [styles.rowSelected]: isSelected })}\n        onClick={() => handleRuleChange(ruleName)}\n      >\n        <div className={cx(styles.ruleTitle, styles.rowButtonTitle)}>{ruleName}</div>\n        <div className={styles.alertFolder}>\n          <>\n            <Icon name=\"folder\" /> {filteredRules[ruleName][0].labels['grafana_folder'] ?? ''}\n          </>\n        </div>\n      </button>\n    );\n  };\n\n  const getAlertUniqueLabels = (allAlerts: AlertmanagerAlert[], currentAlert: AlertmanagerAlert) => {\n    const allLabels = allAlerts.map((alert) => alert.labels);\n    const labelsAsArray = allLabels.map(objectLabelsToArray);\n\n    const ruleCommonLabels = extractCommonLabels(labelsAsArray);\n    const alertUniqueLabels = omitLabels(objectLabelsToArray(currentAlert.labels), ruleCommonLabels);\n\n    const tags = alertUniqueLabels.length\n      ? labelsToTags(arrayLabelsToObject(alertUniqueLabels))\n      : labelsToTags(currentAlert.labels);\n\n    return tags;\n  };\n\n  const InstanceRow = ({ index, style }: { index: number; style: CSSProperties }) => {\n    const alerts = useMemo(() => (selectedRule ? rulesWithInstances[selectedRule] : []), []);\n    const alert = alerts[index];\n    const isSelected = selectedInstances?.includes(alert);\n    const tags = useMemo(() => getAlertUniqueLabels(alerts, alert), [alerts, alert]);\n\n    const handleSelectInstances = () => {\n      if (isSelected && selectedInstances) {\n        setSelectedInstances(selectedInstances.filter((instance) => instance !== alert));\n        return;\n      }\n      setSelectedInstances([...(selectedInstances || []), alert]);\n    };\n\n    return (\n      <button\n        type=\"button\"\n        style={style}\n        className={cx(styles.rowButton, styles.instanceButton, {\n          [styles.rowOdd]: index % 2 === 1,\n          [styles.rowSelected]: isSelected,\n        })}\n        onClick={handleSelectInstances}\n      >\n        <div className={styles.rowButtonTitle} title={alert.labels['alertname']}>\n          <Tooltip placement=\"bottom\" content={<pre>{JSON.stringify(alert, null, 2)}</pre>} theme={'info'}>\n            <div>\n              {tags.map((tag, index) => (\n                <Tag key={index} name={tag} className={styles.tag} />\n              ))}\n            </div>\n          </Tooltip>\n        </div>\n      </button>\n    );\n  };\n\n  const handleConfirm = () => {\n    const instances: TestTemplateAlert[] =\n      selectedInstances?.map((instance: AlertmanagerAlert) => {\n        const alert: TestTemplateAlert = {\n          annotations: instance.annotations,\n          labels: instance.labels,\n          startsAt: instance.startsAt,\n          endsAt: instance.endsAt,\n        };\n        return alert;\n      }) || [];\n\n    onSelect(instances);\n    resetState();\n  };\n\n  const resetState = () => {\n    setSelectedRule(undefined);\n    setSelectedInstances(null);\n    setRuleFilter('');\n    handleSearchRules('');\n  };\n\n  const onDismiss = () => {\n    resetState();\n    onClose();\n  };\n\n  const handleSearchRules = (filter: string) => {\n    setRuleFilter(filter);\n  };\n\n  return (\n    <div>\n      <Modal\n        title=\"Select alert instances\"\n        className={styles.modal}\n        closeOnEscape\n        isOpen={isOpen}\n        onDismiss={onDismiss}\n        contentClassName={styles.modalContent}\n      >\n        <div className={styles.container}>\n          <FilterInput\n            value={ruleFilter}\n            onChange={handleSearchRules}\n            title=\"Search alert rule\"\n            placeholder=\"Search alert rule\"\n            autoFocus\n          />\n          <div>{(selectedRule && 'Select one or more instances from the list below') || ''}</div>\n\n          <div className={styles.column}>\n            {loading && <LoadingPlaceholder text=\"Loading rules...\" className={styles.loadingPlaceholder} />}\n\n            {!loading && (\n              <AutoSizer>\n                {({ height, width }) => (\n                  <FixedSizeList itemSize={50} height={height} width={width} itemCount={filteredRulesKeys.length}>\n                    {RuleRow}\n                  </FixedSizeList>\n                )}\n              </AutoSizer>\n            )}\n          </div>\n\n          <div className={styles.column}>\n            {!selectedRule && !loading && (\n              <div className={styles.selectedRulePlaceholder}>\n                <div>Select an alert rule to get a list of available instances</div>\n              </div>\n            )}\n            {loading && <LoadingPlaceholder text=\"Loading rule...\" className={styles.loadingPlaceholder} />}\n\n            {selectedRule && rulesWithInstances[selectedRule].length && !loading && (\n              <AutoSizer>\n                {({ width, height }) => (\n                  <FixedSizeList\n                    itemSize={32}\n                    height={height}\n                    width={width}\n                    itemCount={rulesWithInstances[selectedRule].length || 0}\n                  >\n                    {InstanceRow}\n                  </FixedSizeList>\n                )}\n              </AutoSizer>\n            )}\n          </div>\n        </div>\n        <Modal.ButtonRow>\n          <Button type=\"button\" variant=\"secondary\" onClick={onDismiss}>\n            Cancel\n          </Button>\n          <Button\n            type=\"button\"\n            variant=\"primary\"\n            disabled={!(selectedRule && selectedInstances)}\n            onClick={() => {\n              if (selectedRule && selectedInstances) {\n                handleConfirm();\n              }\n            }}\n          >\n            Add alert data to payload\n          </Button>\n        </Modal.ButtonRow>\n      </Modal>\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  const clearButton = clearButtonStyles(theme);\n\n  return {\n    container: css`\n      display: grid;\n      grid-template-columns: 1fr 1.5fr;\n      grid-template-rows: min-content auto;\n      gap: ${theme.spacing(2)};\n      flex: 1;\n    `,\n\n    tag: css`\n      margin: 5px;\n    `,\n\n    column: css`\n      flex: 1 1 auto;\n    `,\n\n    alertLabels: css`\n      overflow-x: auto;\n      height: 32px;\n    `,\n    ruleTitle: css`\n      height: 22px;\n      font-weight: ${theme.typography.fontWeightBold};\n    `,\n    rowButton: css`\n      ${clearButton};\n      padding: ${theme.spacing(0.5)};\n      overflow: hidden;\n      text-overflow: ellipsis;\n      text-align: left;\n      white-space: nowrap;\n      cursor: pointer;\n      border: 2px solid transparent;\n\n      &:disabled {\n        cursor: not-allowed;\n        color: ${theme.colors.text.disabled};\n      }\n    `,\n    rowButtonTitle: css`\n      overflow-x: auto;\n    `,\n    rowSelected: css`\n      border-color: ${theme.colors.primary.border};\n    `,\n    rowOdd: css`\n      background-color: ${theme.colors.background.secondary};\n    `,\n    instanceButton: css`\n      display: flex;\n      gap: ${theme.spacing(1)};\n      justify-content: space-between;\n      align-items: center;\n    `,\n    loadingPlaceholder: css`\n      height: 100%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    `,\n    selectedRulePlaceholder: css`\n      width: 100%;\n      height: 100%;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      text-align: center;\n      font-weight: ${theme.typography.fontWeightBold};\n    `,\n    modal: css`\n      height: 100%;\n    `,\n    modalContent: css`\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n    `,\n    modalAlert: css`\n      flex-grow: 0;\n    `,\n    warnIcon: css`\n      fill: ${theme.colors.warning.main};\n    `,\n    labels: css`\n      justify-content: flex-start;\n    `,\n    alertFolder: css`\n      height: 20px;\n      font-size: ${theme.typography.bodySmall.fontSize};\n      color: ${theme.colors.text.secondary};\n      display: flex;\n      flex-direction: row;\n      justify-content: flex-start;\n      column-gap: ${theme.spacing(1)};\n      align-items: center;\n    `,\n  };\n};\n","export interface TemplateDataItem {\n  name: string;\n  type: 'string' | '[]Alert' | 'KeyValue' | 'time.Time';\n  notes: string;\n}\n\ninterface TemplateFunctionItem {\n  name: string;\n  args?: '[]string';\n  returns: 'KeyValue' | '[]string';\n  notes?: string;\n}\n\nexport const GlobalTemplateData: TemplateDataItem[] = [\n  {\n    name: 'Receiver',\n    type: 'string',\n    notes: 'Name of the contact point that the notification is being sent to.',\n  },\n  {\n    name: 'Status',\n    type: 'string',\n    notes: 'firing if at least one alert is firing, otherwise resolved',\n  },\n  {\n    name: 'Alerts',\n    type: '[]Alert',\n    notes: 'List of alert objects that are included in this notification.',\n  },\n  {\n    name: 'Alerts.Firing',\n    type: '[]Alert',\n    notes: 'List of firing alerts',\n  },\n  {\n    name: 'Alerts.Resolved',\n    type: '[]Alert',\n    notes: 'List of resolved alerts',\n  },\n  {\n    name: 'GroupLabels',\n    type: 'KeyValue',\n    notes: 'Labels these alerts were grouped by.',\n  },\n  {\n    name: 'CommonLabels',\n    type: 'KeyValue',\n    notes: 'Labels common to all the alerts included in this notification.',\n  },\n  {\n    name: 'CommonAnnotations',\n    type: 'KeyValue',\n    notes: 'Annotations common to all the alerts included in this notification.',\n  },\n  {\n    name: 'ExternalURL',\n    type: 'string',\n    notes: 'Back link to the Grafana that sent the notification.',\n  },\n];\n\nexport const AlertTemplatePreviewData: TemplateDataItem[] = [\n  {\n    name: 'Labels',\n    type: 'KeyValue',\n    notes: 'Set of labels attached to the alert.',\n  },\n  {\n    name: 'Annotations',\n    type: 'KeyValue',\n    notes: 'Set of annotations attached to the alert.',\n  },\n  {\n    name: 'StartsAt',\n    type: 'time.Time',\n    notes: 'Time the alert started firing.',\n  },\n  {\n    name: 'EndsAt',\n    type: 'time.Time',\n    notes: 'Time the alert ends firing.',\n  },\n];\n\nexport const AlertTemplateData: TemplateDataItem[] = [\n  {\n    name: 'Status',\n    type: 'string',\n    notes: 'firing or resolved.',\n  },\n  {\n    name: 'Labels',\n    type: 'KeyValue',\n    notes: 'Set of labels attached to the alert.',\n  },\n  {\n    name: 'Annotations',\n    type: 'KeyValue',\n    notes: 'Set of annotations attached to the alert.',\n  },\n  {\n    name: 'Values',\n    type: 'KeyValue',\n    notes:\n      'The values of all instant queries, reduce and math expressions, and classic conditions for the alert. It does not contain time series data.',\n  },\n  {\n    name: 'StartsAt',\n    type: 'time.Time',\n    notes: 'Time the alert started firing.',\n  },\n  {\n    name: 'EndsAt',\n    type: 'time.Time',\n    notes:\n      'Only set if the end time of an alert is known. Otherwise set to a configurable timeout period from the time since the last alert was received.',\n  },\n  {\n    name: 'GeneratorURL',\n    type: 'string',\n    notes: 'A back link to Grafana or external Alertmanager.',\n  },\n  {\n    name: 'SilenceURL',\n    type: 'string',\n    notes: 'Link to Grafana silence for with labels for this alert pre-filled. Only for Grafana managed alerts.',\n  },\n  {\n    name: 'DashboardURL',\n    type: 'string',\n    notes: 'Link to Grafana dashboard, if alert rule belongs to one. Only for Grafana managed alerts.',\n  },\n  {\n    name: 'PanelURL',\n    type: 'string',\n    notes: 'Link to Grafana dashboard panel, if alert rule belongs to one. Only for Grafana managed alerts.',\n  },\n  {\n    name: 'Fingerprint',\n    type: 'string',\n    notes: 'Fingerprint that can be used to identify the alert.',\n  },\n  {\n    name: 'ValueString',\n    type: 'string',\n    notes: 'String that contains the labels and value of each reduced expression in the alert.',\n  },\n];\n\nexport const KeyValueTemplateFunctions: TemplateFunctionItem[] = [\n  {\n    name: 'SortedPairs',\n    returns: 'KeyValue',\n    notes: 'Returns sorted list of key & value string pairs',\n  },\n  {\n    name: 'Remove',\n    args: '[]string',\n    returns: 'KeyValue',\n    notes: 'Returns a copy of the Key/Value map without the given keys.',\n  },\n  {\n    name: 'Names',\n    returns: '[]string',\n    notes: 'List of label names',\n  },\n  {\n    name: 'Values',\n    returns: '[]string',\n    notes: 'List of label values',\n  },\n];\n\nexport const KeyValueCodeSnippet = `{\n  \"summary\": \"alert summary\",\n  \"description\": \"alert description\"\n}\n`;\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { HoverCard } from '../HoverCard';\n\nimport {\n  AlertTemplateData,\n  GlobalTemplateData,\n  KeyValueCodeSnippet,\n  KeyValueTemplateFunctions,\n  TemplateDataItem,\n} from './TemplateData';\n\nexport function TemplateDataDocs() {\n  const styles = useStyles2(getTemplateDataDocsStyles);\n\n  const AlertTemplateDataTable = (\n    <TemplateDataTable\n      caption={\n        <h4 className={styles.header}>\n          Alert template data <span>Available only when in the context of an Alert (e.g. inside .Alerts loop)</span>\n        </h4>\n      }\n      dataItems={AlertTemplateData}\n    />\n  );\n\n  return (\n    <Stack gap={2} flexGrow={1}>\n      <TemplateDataTable\n        caption={<h4 className={styles.header}>Template Data</h4>}\n        dataItems={GlobalTemplateData}\n        typeRenderer={(type) =>\n          type === '[]Alert' ? (\n            <HoverCard content={AlertTemplateDataTable}>\n              <div className={styles.interactiveType}>{type}</div>\n            </HoverCard>\n          ) : type === 'KeyValue' ? (\n            <HoverCard content={<KeyValueTemplateDataTable />}>\n              <div className={styles.interactiveType}>{type}</div>\n            </HoverCard>\n          ) : (\n            type\n          )\n        }\n      />\n    </Stack>\n  );\n}\n\nconst getTemplateDataDocsStyles = (theme: GrafanaTheme2) => ({\n  header: css`\n    color: ${theme.colors.text.primary};\n\n    span {\n      color: ${theme.colors.text.secondary};\n      font-size: ${theme.typography.bodySmall.fontSize};\n    }\n  `,\n  interactiveType: css`\n    color: ${theme.colors.text.link};\n  `,\n});\n\ninterface TemplateDataTableProps {\n  dataItems: TemplateDataItem[];\n  caption: JSX.Element | string;\n  typeRenderer?: (type: TemplateDataItem['type']) => React.ReactNode;\n}\n\nexport function TemplateDataTable({ dataItems, caption, typeRenderer }: TemplateDataTableProps) {\n  const styles = useStyles2(getTemplateDataTableStyles);\n\n  return (\n    <table className={styles.table}>\n      <caption>{caption}</caption>\n      <thead>\n        <tr>\n          <th>Name</th>\n          <th>Type</th>\n          <th>Notes</th>\n        </tr>\n      </thead>\n      <tbody>\n        {dataItems.map(({ name, type, notes }, index) => (\n          <tr key={index}>\n            <td>{name}</td>\n            <td>{typeRenderer ? typeRenderer(type) : type}</td>\n            <td>{notes}</td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n}\n\nfunction KeyValueTemplateDataTable() {\n  const tableStyles = useStyles2(getTemplateDataTableStyles);\n\n  return (\n    <div>\n      KeyValue is a set of key/value string pairs that represent labels and annotations.\n      <pre>\n        <code>{KeyValueCodeSnippet}</code>\n      </pre>\n      <table className={tableStyles.table}>\n        <caption>Key-value methods</caption>\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Arguments</th>\n            <th>Returns</th>\n            <th>Notes</th>\n          </tr>\n        </thead>\n        <tbody>\n          {KeyValueTemplateFunctions.map(({ name, args, returns, notes }) => (\n            <tr key={name}>\n              <td>{name}</td>\n              <td>{args}</td>\n              <td>{returns}</td>\n              <td>{notes}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n\nconst getTemplateDataTableStyles = (theme: GrafanaTheme2) => ({\n  table: css`\n    border-collapse: collapse;\n    width: 100%;\n\n    caption {\n      caption-side: top;\n    }\n\n    td,\n    th {\n      padding: ${theme.spacing(1, 1)};\n    }\n\n    thead {\n      font-weight: ${theme.typography.fontWeightBold};\n    }\n\n    tbody tr:nth-child(2n + 1) {\n      background-color: ${theme.colors.background.secondary};\n    }\n\n    tbody td:nth-child(1) {\n      font-weight: ${theme.typography.fontWeightBold};\n    }\n\n    tbody td:nth-child(2) {\n      font-style: italic;\n    }\n  `,\n});\n","import { css } from '@emotion/css';\nimport { addDays, subDays } from 'date-fns';\nimport React, { useState } from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { Button, Card, Modal, RadioButtonGroup, useStyles2 } from '@grafana/ui';\nimport { TestTemplateAlert } from 'app/plugins/datasource/alertmanager/types';\n\nimport { KeyValueField } from '../../../api/templateApi';\nimport AnnotationsField from '../../rule-editor/AnnotationsField';\nimport LabelsField from '../../rule-editor/LabelsField';\n\ninterface Props {\n  isOpen: boolean;\n  onDismiss: () => void;\n  onAccept: (alerts: TestTemplateAlert[]) => void;\n}\n\ninterface FormFields {\n  annotations: KeyValueField[];\n  labels: KeyValueField[];\n  status: 'firing' | 'resolved';\n}\n\nconst defaultValues: FormFields = {\n  annotations: [{ key: '', value: '' }],\n  labels: [{ key: '', value: '' }],\n  status: 'firing',\n};\n\nexport const GenerateAlertDataModal = ({ isOpen, onDismiss, onAccept }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const [alerts, setAlerts] = useState<TestTemplateAlert[]>([]);\n\n  const formMethods = useForm<FormFields>({ defaultValues, mode: 'onBlur' });\n  const annotations = formMethods.watch('annotations');\n  const labels = formMethods.watch('labels');\n  const [status, setStatus] = useState<'firing' | 'resolved'>('firing');\n\n  const onAdd = () => {\n    const alert: TestTemplateAlert = {\n      annotations: annotations\n        .filter(({ key, value }) => !!key && !!value)\n        .reduce((acc, { key, value }) => {\n          return { ...acc, [key]: value };\n        }, {}),\n      labels: labels\n        .filter(({ key, value }) => !!key && !!value)\n        .reduce((acc, { key, value }) => {\n          return { ...acc, [key]: value };\n        }, {}),\n      startsAt: '2023-04-01T00:00:00Z',\n      endsAt: status === 'firing' ? addDays(new Date(), 1).toISOString() : subDays(new Date(), 1).toISOString(),\n    };\n    setAlerts((alerts) => [...alerts, alert]);\n    formMethods.reset();\n  };\n\n  const onSubmit = () => {\n    onAccept(alerts);\n    setAlerts([]);\n    formMethods.reset();\n    setStatus('firing');\n  };\n\n  const labelsOrAnnotationsAdded = () => {\n    const someLabels = labels.some((lb) => lb.key !== '' && lb.value !== '');\n    const someAnnotations = annotations.some((ann) => ann.key !== '' && ann.value !== '');\n    return someLabels || someAnnotations;\n  };\n\n  type AlertOption = {\n    label: string;\n    value: 'firing' | 'resolved';\n  };\n  const alertOptions: AlertOption[] = [\n    {\n      label: 'Firing',\n      value: 'firing',\n    },\n    { label: 'Resolved', value: 'resolved' },\n  ];\n\n  return (\n    <Modal onDismiss={onDismiss} isOpen={isOpen} title={'Add custom alerts'}>\n      <FormProvider {...formMethods}>\n        <form\n          onSubmit={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            formMethods.reset();\n            setStatus('firing');\n          }}\n        >\n          <>\n            <Card>\n              <Stack direction=\"column\" gap={1}>\n                <div className={styles.section}>\n                  <AnnotationsField />\n                </div>\n                <div className={styles.section}>\n                  <LabelsField />\n                </div>\n                <div className={styles.flexWrapper}>\n                  <RadioButtonGroup value={status} options={alertOptions} onChange={(value) => setStatus(value)} />\n                  <Button\n                    onClick={onAdd}\n                    className={styles.onAddButton}\n                    icon=\"plus-circle\"\n                    type=\"button\"\n                    variant=\"secondary\"\n                    disabled={!labelsOrAnnotationsAdded()}\n                  >\n                    Add alert data\n                  </Button>\n                </div>\n              </Stack>\n            </Card>\n          </>\n          <div className={styles.onSubmitWrapper}></div>\n          {alerts.length > 0 && (\n            <Stack direction=\"column\" gap={1}>\n              <h5> Review alert data to add to the payload:</h5>\n              <pre className={styles.result} data-testid=\"payloadJSON\">\n                {JSON.stringify(alerts, null, 2)}\n              </pre>\n            </Stack>\n          )}\n          <div className={styles.onSubmitWrapper}>\n            <Modal.ButtonRow>\n              <Button onClick={onSubmit} disabled={alerts.length === 0} className={styles.onSubmitButton}>\n                Add alert data to payload\n              </Button>\n            </Modal.ButtonRow>\n          </div>\n        </form>\n      </FormProvider>\n    </Modal>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  section: css`\n    margin-bottom: ${theme.spacing(2)};\n  `,\n  onAddButton: css`\n    flex: none;\n    width: fit-content;\n    padding-right: ${theme.spacing(1)};\n    margin-left: auto;\n  `,\n  flexWrapper: css`\n    display: flex;\n    flex-direction: row,\n    justify-content: space-between;\n  `,\n  onSubmitWrapper: css`\n    display: flex;\n    flex-direction: row;\n    align-items: baseline;\n    justify-content: flex-end;\n  `,\n  onSubmitButton: css`\n    margin-left: ${theme.spacing(2)};\n  `,\n  result: css`\n    width: 570px;\n    height: 363px;\n  `,\n});\n","import { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Badge, Button, CodeEditor, Icon, Tooltip, useStyles2 } from '@grafana/ui';\nimport { TestTemplateAlert } from 'app/plugins/datasource/alertmanager/types';\n\nimport { AlertInstanceModalSelector } from './AlertInstanceModalSelector';\nimport { AlertTemplatePreviewData } from './TemplateData';\nimport { TemplateDataTable } from './TemplateDataDocs';\nimport { GenerateAlertDataModal } from './form/GenerateAlertDataModal';\n\nexport const RESET_TO_DEFAULT = 'Reset to default';\n\nexport function PayloadEditor({\n  payload,\n  setPayload,\n  defaultPayload,\n  setPayloadFormatError,\n  payloadFormatError,\n  onPayloadError,\n}: {\n  payload: string;\n  defaultPayload: string;\n  setPayload: React.Dispatch<React.SetStateAction<string>>;\n  setPayloadFormatError: (value: React.SetStateAction<string | null>) => void;\n  payloadFormatError: string | null;\n  onPayloadError: () => void;\n}) {\n  const styles = useStyles2(getStyles);\n  const onReset = () => {\n    setPayload(defaultPayload);\n  };\n\n  const [isEditingAlertData, setIsEditingAlertData] = useState(false);\n\n  const onCloseEditAlertModal = () => {\n    setIsEditingAlertData(false);\n  };\n\n  const errorInPayloadJson = payloadFormatError !== null;\n\n  const validatePayload = () => {\n    try {\n      const payloadObj = JSON.parse(payload);\n      JSON.stringify([...payloadObj]); // check if it's iterable, in order to be able to add more data\n      setPayloadFormatError(null);\n    } catch (e) {\n      setPayloadFormatError(e instanceof Error ? e.message : 'Invalid JSON.');\n      onPayloadError();\n      throw e;\n    }\n  };\n\n  const onOpenEditAlertModal = () => {\n    try {\n      validatePayload();\n      setIsEditingAlertData(true);\n    } catch (e) {}\n  };\n\n  const onOpenAlertSelectorModal = () => {\n    try {\n      validatePayload();\n      setIsAlertSelectorOpen(true);\n    } catch (e) {}\n  };\n\n  const onAddAlertList = (alerts: TestTemplateAlert[]) => {\n    onCloseEditAlertModal();\n    setIsAlertSelectorOpen(false);\n    setPayload((payload) => {\n      const payloadObj = JSON.parse(payload);\n      return JSON.stringify([...payloadObj, ...alerts], undefined, 2);\n    });\n  };\n\n  const [isAlertSelectorOpen, setIsAlertSelectorOpen] = useState(false);\n\n  return (\n    <div className={styles.wrapper}>\n      <div className={styles.editor}>\n        <div className={styles.title}>\n          Payload data\n          <Tooltip placement=\"top\" content={<AlertTemplateDataTable />} theme=\"info\">\n            <Icon name=\"info-circle\" className={styles.tooltip} size=\"xl\" />\n          </Tooltip>\n        </div>\n        <AutoSizer disableHeight>\n          {({ width }) => (\n            <div className={styles.editorWrapper}>\n              <CodeEditor\n                width={width}\n                height={362}\n                language={'json'}\n                showLineNumbers={true}\n                showMiniMap={false}\n                value={payload}\n                readOnly={false}\n                onBlur={setPayload}\n              />\n            </div>\n          )}\n        </AutoSizer>\n\n        <div className={styles.buttonsWrapper}>\n          <Button\n            type=\"button\"\n            variant=\"secondary\"\n            className={styles.button}\n            icon=\"bell\"\n            disabled={errorInPayloadJson}\n            onClick={onOpenAlertSelectorModal}\n          >\n            Select alert instances\n          </Button>\n\n          <Button\n            onClick={onOpenEditAlertModal}\n            className={styles.button}\n            icon=\"plus-circle\"\n            type=\"button\"\n            variant=\"secondary\"\n            disabled={errorInPayloadJson}\n          >\n            Add custom alerts\n          </Button>\n          <Button onClick={onReset} className={styles.button} icon=\"arrow-up\" type=\"button\" variant=\"destructive\">\n            {RESET_TO_DEFAULT}\n          </Button>\n\n          {payloadFormatError !== null && (\n            <Badge\n              color=\"orange\"\n              icon=\"exclamation-triangle\"\n              text={'JSON Error'}\n              tooltip={'Fix errors in payload, and click Refresh preview button'}\n            />\n          )}\n        </div>\n      </div>\n      <GenerateAlertDataModal isOpen={isEditingAlertData} onDismiss={onCloseEditAlertModal} onAccept={onAddAlertList} />\n\n      <AlertInstanceModalSelector\n        onSelect={onAddAlertList}\n        isOpen={isAlertSelectorOpen}\n        onClose={() => setIsAlertSelectorOpen(false)}\n      />\n    </div>\n  );\n}\nconst AlertTemplateDataTable = () => {\n  const styles = useStyles2(getStyles);\n  return (\n    <TemplateDataTable\n      caption={\n        <h4 className={styles.templateDataDocsHeader}>\n          Alert template data <span>This is the list of alert data fields used in the preview.</span>\n        </h4>\n      }\n      dataItems={AlertTemplatePreviewData}\n    />\n  );\n};\nconst getStyles = (theme: GrafanaTheme2) => ({\n  jsonEditor: css`\n    width: 100%;\n    height: 100%;\n  `,\n  buttonsWrapper: css`\n    margin-top: ${theme.spacing(1)};\n    display: flex;\n    flex-wrap: wrap;\n  `,\n  button: css`\n    flex: none;\n    width: fit-content;\n    padding-right: ${theme.spacing(1)};\n    margin-right: ${theme.spacing(1)};\n    margin-bottom: ${theme.spacing(1)};\n  `,\n  title: css`\n    font-weight: ${theme.typography.fontWeightBold};\n    heigth: 41px;\n    padding-top: 10px;\n    padding-left: ${theme.spacing(2)};\n    margin-top: 19px;\n  `,\n  wrapper: css`\n    flex: 1;\n    min-width: 450px;\n  `,\n  tooltip: css`\n    padding-left: ${theme.spacing(1)};\n  `,\n  editorWrapper: css`\n    width: min-content;\n    padding-top: 7px;\n  `,\n  editor: css`\n    display: flex;\n    flex-direction: column;\n    margin-top: ${theme.spacing(-1)};\n  `,\n  templateDataDocsHeader: css`\n    color: ${theme.colors.text.primary};\n\n    span {\n      color: ${theme.colors.text.secondary};\n      font-size: ${theme.typography.bodySmall.fontSize};\n    }\n  `,\n});\n","import type { Monaco } from '@grafana/ui';\n\nimport { AlertmanagerTemplateFunction } from './language';\nimport { SuggestionDefinition } from './suggestionDefinition';\n\nexport function getAlertManagerSuggestions(monaco: Monaco): SuggestionDefinition[] {\n  const kind = monaco.languages.CompletionItemKind.Function;\n  return [\n    {\n      label: AlertmanagerTemplateFunction.toUpper,\n      detail: 'function(s string)',\n      kind,\n    },\n    {\n      label: AlertmanagerTemplateFunction.toLower,\n      detail: 'function(s string)',\n      kind,\n    },\n    {\n      label: AlertmanagerTemplateFunction.title,\n      documentation: 'Capitalizes the first letter of each word',\n      detail: 'function(s string)',\n      kind,\n    },\n    {\n      label: AlertmanagerTemplateFunction.join,\n      documentation: { value: 'Joins an array of strings using the separator provided.' },\n      detail: 'function(separator string, s []string)',\n      kind,\n    },\n    {\n      label: AlertmanagerTemplateFunction.match,\n      detail: 'function',\n      kind,\n    },\n    {\n      label: AlertmanagerTemplateFunction.safeHtml,\n      detail: 'function(pattern, repl, text)',\n      kind,\n    },\n    {\n      label: AlertmanagerTemplateFunction.reReplaceAll,\n      detail: 'function(pattern, repl, text)',\n      kind,\n    },\n    {\n      label: AlertmanagerTemplateFunction.stringSlice,\n      detail: 'function(s ...string)',\n      kind,\n    },\n  ];\n}\n","export const alertsLoopSnippet = `\n{{ range .Alerts }}\n  Status: {{ .Status }}\n  Starts at: {{ .StartsAt }}\n{{ end }}\n`;\n\nexport const alertDetailsSnippet = `\n[{{.Status}}] {{ .Labels.alertname }}\n\nLabels:\n{{ range .Labels.SortedPairs }}\n  {{ .Name }}: {{ .Value }}\n{{ end }}\n\n{{ if gt (len .Annotations) 0 }}\nAnnotations:\n{{ range .Annotations.SortedPairs }}\n  {{ .Name }}: {{ .Value }}\n{{ end }}\n{{ end }}\n\n{{ if gt (len .SilenceURL ) 0 }}\n  Silence alert: {{ .SilenceURL }}\n{{ end }}\n{{ if gt (len .DashboardURL ) 0 }}\n  Go to dashboard: {{ .DashboardURL }}\n{{ end }}\n`;\n\nexport const groupLabelsLoopSnippet = getKeyValueTemplate('GroupLabels');\nexport const commonLabelsLoopSnippet = getKeyValueTemplate('CommonLabels');\nexport const commonAnnotationsLoopSnippet = getKeyValueTemplate('CommonAnnotations');\nexport const labelsLoopSnippet = getKeyValueTemplate('Labels');\nexport const annotationsLoopSnippet = getKeyValueTemplate('Annotations');\n\nfunction getKeyValueTemplate(arrayName: string) {\n  return `\n{{ range .${arrayName} }}\n  {{ .Name }} = {{ .Value }}\n{{ end }}`;\n}\n","import type { Monaco } from '@grafana/ui';\n\nimport {\n  alertDetailsSnippet,\n  alertsLoopSnippet,\n  annotationsLoopSnippet,\n  commonAnnotationsLoopSnippet,\n  commonLabelsLoopSnippet,\n  groupLabelsLoopSnippet,\n  labelsLoopSnippet,\n} from './snippets';\nimport { SuggestionDefinition } from './suggestionDefinition';\n\n// Suggestions available at the top level of a template\nexport function getGlobalSuggestions(monaco: Monaco): SuggestionDefinition[] {\n  const kind = monaco.languages.CompletionItemKind.Field;\n\n  return [\n    {\n      label: 'Alerts',\n      kind,\n      detail: 'Alert[]',\n      documentation: { value: 'An Array containing all alerts' },\n    },\n    { label: 'Receiver', kind, detail: 'string' },\n    { label: 'Status', kind, detail: 'string' },\n    { label: 'GroupLabels', kind, detail: '[]KeyValue' },\n    { label: 'CommonLabels', kind, detail: '[]KeyValue' },\n    { label: 'CommonAnnotations', kind, detail: '[]KeyValue' },\n    { label: 'ExternalURL', kind, detail: 'string' },\n  ];\n}\n\n// Suggestions that are valid only in the scope of an alert (e.g. in the .Alerts loop)\nexport function getAlertSuggestions(monaco: Monaco): SuggestionDefinition[] {\n  const kind = monaco.languages.CompletionItemKind.Field;\n\n  return [\n    {\n      label: { label: 'Status', detail: '(Alert)', description: 'string' },\n      kind,\n      detail: 'string',\n      documentation: { value: 'Status of the alert. It can be `firing` or `resolved`' },\n    },\n    {\n      label: { label: 'Labels', detail: '(Alert)' },\n      kind,\n      detail: '[]KeyValue',\n      documentation: { value: 'A set of labels attached to the alert.' },\n    },\n    {\n      label: { label: 'Annotations', detail: '(Alert)' },\n      kind,\n      detail: '[]KeyValue',\n      documentation: 'A set of annotations attached to the alert.',\n    },\n    {\n      label: { label: 'StartsAt', detail: '(Alert)' },\n      kind,\n      detail: 'time.Time',\n      documentation: 'Time the alert started firing.',\n    },\n    {\n      label: { label: 'EndsAt', detail: '(Alert)' },\n      kind,\n      detail: 'time.Time',\n      documentation:\n        'Only set if the end time of an alert is known. Otherwise set to a configurable timeout period from the time since the last alert was received.',\n    },\n    {\n      label: { label: 'GeneratorURL', detail: '(Alert)' },\n      kind,\n      detail: 'string',\n      documentation: 'Back link to Grafana or external Alertmanager.',\n    },\n    {\n      label: { label: 'SilenceURL', detail: '(Alert)' },\n      kind,\n      detail: 'string',\n      documentation:\n        'Link to Grafana silence for with labels for this alert pre-filled. Only for Grafana managed alerts.',\n    },\n    {\n      label: { label: 'DashboardURL', detail: '(Alert)' },\n      kind,\n      detail: 'string',\n      documentation: 'Link to Grafana dashboard, if alert rule belongs to one. Only for Grafana managed alerts.',\n    },\n    {\n      label: { label: 'PanelURL', detail: '(Alert)' },\n      kind,\n      detail: 'string',\n      documentation: 'Link to Grafana dashboard panel, if alert rule belongs to one. Only for Grafana managed alerts.',\n    },\n    {\n      label: { label: 'Fingerprint', detail: '(Alert)' },\n      kind,\n      detail: 'string',\n      documentation: 'Fingerprint that can be used to identify the alert.',\n    },\n    {\n      label: { label: 'ValueString', detail: '(Alert)' },\n      kind,\n      detail: 'string',\n      documentation: 'String that contains labels and values of each reduced expression in the alert.',\n    },\n  ];\n}\n\n// Suggestions for .Alerts\nexport function getAlertsSuggestions(monaco: Monaco): SuggestionDefinition[] {\n  const kind = monaco.languages.CompletionItemKind.Field;\n\n  return [\n    { label: 'Firing', kind, detail: 'Alert[]' },\n    { label: 'Resolved', kind, detail: 'Alert[]' },\n  ];\n}\n\n// Suggestions for the KeyValue types\nexport function getKeyValueSuggestions(monaco: Monaco): SuggestionDefinition[] {\n  const kind = monaco.languages.CompletionItemKind.Field;\n\n  return [\n    { label: 'SortedPairs', kind, detail: '[]KeyValue' },\n    { label: 'Names', kind, detail: '[]string' },\n    { label: 'Values', kind, detail: '[]string' },\n    {\n      label: 'Remove',\n      detail: 'KeyValue[] function(keys []string)',\n      kind: monaco.languages.CompletionItemKind.Method,\n    },\n  ];\n}\n\nexport const snippets = {\n  alerts: {\n    label: 'alertsloop',\n    description: 'Renders a loop through alerts',\n    snippet: alertsLoopSnippet,\n  },\n  alertDetails: {\n    label: 'alertdetails',\n    description: 'Renders all information available about the alert',\n    snippet: alertDetailsSnippet,\n  },\n  groupLabels: {\n    label: 'grouplabelsloop',\n    description: 'Renders a loop through group labels',\n    snippet: groupLabelsLoopSnippet,\n  },\n  commonLabels: {\n    label: 'commonlabelsloop',\n    description: 'Renders a loop through common labels',\n    snippet: commonLabelsLoopSnippet,\n  },\n  commonAnnotations: {\n    label: 'commonannotationsloop',\n    description: 'Renders a loop through common annotations',\n    snippet: commonAnnotationsLoopSnippet,\n  },\n  labels: {\n    label: 'labelsloop',\n    description: 'Renders a loop through labels',\n    snippet: labelsLoopSnippet,\n  },\n  annotations: {\n    label: 'annotationsloop',\n    description: 'Renders a loop through annotations',\n    snippet: annotationsLoopSnippet,\n  },\n};\n\n// Snippets\nexport function getSnippetsSuggestions(monaco: Monaco): SuggestionDefinition[] {\n  const snippetKind = monaco.languages.CompletionItemKind.Snippet;\n  const snippetInsertRule = monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet;\n\n  const { alerts, alertDetails, groupLabels, commonLabels, commonAnnotations, labels, annotations } = snippets;\n\n  return [\n    {\n      label: alerts.label,\n      documentation: alerts.description,\n      kind: snippetKind,\n      insertText: alerts.snippet,\n      insertTextRules: snippetInsertRule,\n    },\n    {\n      label: {\n        label: alertDetails.label,\n        detail: '(Alert)',\n      },\n      documentation: alertDetails.description,\n      kind: snippetKind,\n      insertText: alertDetails.snippet,\n      insertTextRules: snippetInsertRule,\n    },\n    {\n      label: groupLabels.label,\n      documentation: groupLabels.description,\n      kind: snippetKind,\n      insertText: groupLabels.snippet,\n      insertTextRules: snippetInsertRule,\n    },\n    {\n      label: commonLabels.label,\n      documentation: commonLabels.description,\n      kind: snippetKind,\n      insertText: commonLabels.snippet,\n      insertTextRules: snippetInsertRule,\n    },\n    {\n      label: commonAnnotations.label,\n      documentation: commonAnnotations.description,\n      kind: snippetKind,\n      insertText: commonAnnotations.snippet,\n      insertTextRules: snippetInsertRule,\n    },\n    {\n      label: { label: labels.label, detail: '(Alert)' },\n      documentation: labels.description,\n      kind: snippetKind,\n      insertText: labels.snippet,\n      insertTextRules: snippetInsertRule,\n    },\n    {\n      label: { label: annotations.label, detail: '(Alert)' },\n      documentation: annotations.description,\n      kind: snippetKind,\n      insertText: annotations.snippet,\n      insertTextRules: snippetInsertRule,\n    },\n  ];\n}\n","import { concat } from 'lodash';\nimport type { languages, editor, Position, IRange, IDisposable } from 'monaco-editor/esm/vs/editor/editor.api';\n\nimport type { Monaco } from '@grafana/ui';\n\nimport { getAlertManagerSuggestions } from './alertManagerSuggestions';\nimport { SuggestionDefinition } from './suggestionDefinition';\nimport {\n  getAlertsSuggestions,\n  getAlertSuggestions,\n  getGlobalSuggestions,\n  getKeyValueSuggestions,\n  getSnippetsSuggestions,\n} from './templateDataSuggestions';\n\nexport function registerGoTemplateAutocomplete(monaco: Monaco): IDisposable {\n  const goTemplateAutocompleteProvider: languages.CompletionItemProvider = {\n    triggerCharacters: ['.'],\n    provideCompletionItems(model, position, context): languages.ProviderResult<languages.CompletionList> {\n      const word = model.getWordUntilPosition(position);\n      const range = {\n        startLineNumber: position.lineNumber,\n        endLineNumber: position.lineNumber,\n        startColumn: word.startColumn,\n        endColumn: word.endColumn,\n      };\n\n      const completionProvider = new CompletionProvider(monaco, range);\n\n      const insideExpression = isInsideGoExpression(model, position);\n      if (!insideExpression) {\n        return completionProvider.getSnippetsSuggestions();\n      }\n\n      if (context.triggerKind === monaco.languages.CompletionTriggerKind.Invoke && !context.triggerCharacter) {\n        return completionProvider.getFunctionsSuggestions();\n      }\n\n      const wordBeforeDot = model.getWordUntilPosition({\n        lineNumber: position.lineNumber,\n        column: position.column - 1,\n      });\n\n      return completionProvider.getTemplateDataSuggestions(wordBeforeDot.word);\n    },\n  };\n\n  return monaco.languages.registerCompletionItemProvider('go-template', goTemplateAutocompleteProvider);\n}\n\nfunction isInsideGoExpression(model: editor.ITextModel, position: Position) {\n  const searchRange = {\n    startLineNumber: position.lineNumber,\n    endLineNumber: position.lineNumber,\n    startColumn: model.getLineMinColumn(position.lineNumber),\n    endColumn: model.getLineMaxColumn(position.lineNumber),\n  };\n\n  const goSyntaxRegex = '\\\\{\\\\{[a-zA-Z0-9._() \"]+\\\\}\\\\}';\n  const matches = model.findMatches(goSyntaxRegex, searchRange, true, false, null, true);\n\n  return matches.some((match) => match.range.containsPosition(position));\n}\n\nexport class CompletionProvider {\n  constructor(private readonly monaco: Monaco, private readonly range: IRange) {}\n\n  getSnippetsSuggestions = (): languages.ProviderResult<languages.CompletionList> => {\n    return this.getCompletionsFromDefinitions(getSnippetsSuggestions(this.monaco));\n  };\n\n  getFunctionsSuggestions = (): languages.ProviderResult<languages.CompletionList> => {\n    return this.getCompletionsFromDefinitions(getAlertManagerSuggestions(this.monaco));\n  };\n\n  getTemplateDataSuggestions = (wordContext: string): languages.ProviderResult<languages.CompletionList> => {\n    switch (wordContext) {\n      case '':\n        return this.getCompletionsFromDefinitions(getGlobalSuggestions(this.monaco), getAlertSuggestions(this.monaco));\n      case 'Alerts':\n        return this.getCompletionsFromDefinitions(getAlertsSuggestions(this.monaco));\n      case 'GroupLabels':\n      case 'CommonLabels':\n      case 'CommonAnnotations':\n      case 'Labels':\n      case 'Annotations':\n        return this.getCompletionsFromDefinitions(getKeyValueSuggestions(this.monaco));\n      default:\n        return { suggestions: [] };\n    }\n  };\n\n  private getCompletionsFromDefinitions = (...args: SuggestionDefinition[][]): languages.CompletionList => {\n    const allDefinitions = concat(...args);\n\n    return {\n      suggestions: allDefinitions.map((definition) => buildAutocompleteSuggestion(definition, this.range)),\n    };\n  };\n}\n\nfunction buildAutocompleteSuggestion(\n  { label, detail, documentation, kind, insertText }: SuggestionDefinition,\n  range: IRange\n): languages.CompletionItem {\n  const insertFallback = typeof label === 'string' ? label : label.label;\n  const labelObject = typeof label === 'string' ? { label: label, description: detail } : { ...label };\n\n  labelObject.description ??= detail;\n\n  return {\n    label: labelObject,\n    kind: kind,\n    insertText: insertText ?? insertFallback,\n    range,\n    documentation: documentation,\n    detail: detail,\n  };\n}\n","import { LanguageDefinition } from './register';\n\nexport const GO_TEMPLATE_LANGUAGE_ID = 'go-template';\n\nconst goTemplateLanguageDefinition: LanguageDefinition = {\n  id: GO_TEMPLATE_LANGUAGE_ID,\n  extensions: [],\n  aliases: [],\n  mimetypes: [],\n  loader: () => import('./language'),\n};\nexport default goTemplateLanguageDefinition;\n","import type * as monacoType from 'monaco-editor/esm/vs/editor/editor.api';\n\nimport { Monaco } from '@grafana/ui';\n\nexport type LanguageDefinition = {\n  id: string;\n  extensions: string[];\n  aliases: string[];\n  mimetypes: string[];\n  loader: () => Promise<{\n    language: monacoType.languages.IMonarchLanguage;\n    conf: monacoType.languages.LanguageConfiguration;\n  }>;\n};\n\nexport const registerLanguage = (\n  monaco: Monaco,\n  language: LanguageDefinition\n  // completionItemProvider: Completeable\n) => {\n  const { id, loader } = language;\n\n  const languages = monaco.languages.getLanguages();\n  if (languages.find((l) => l.id === id)) {\n    return;\n  }\n\n  monaco.languages.register({ id });\n  loader().then((monarch) => {\n    monaco.languages.setMonarchTokensProvider(id, monarch.language);\n    monaco.languages.setLanguageConfiguration(id, monarch.conf);\n    // monaco.languages.registerCompletionItemProvider(id, completionItemProvider.getCompletionProvider(monaco, language));\n  });\n};\n","/**\n * This file contains the template editor we'll be using for alertmanager templates.\n *\n * It includes auto-complete for template data and syntax highlighting\n */\nimport { editor, IDisposable } from 'monaco-editor';\nimport React, { useEffect, useRef } from 'react';\n\nimport { CodeEditor } from '@grafana/ui';\nimport { CodeEditorProps } from '@grafana/ui/src/components/Monaco/types';\n\nimport { registerGoTemplateAutocomplete } from './editor/autocomplete';\nimport goTemplateLanguageDefinition, { GO_TEMPLATE_LANGUAGE_ID } from './editor/definition';\nimport { registerLanguage } from './editor/register';\n\ntype TemplateEditorProps = Omit<CodeEditorProps, 'language' | 'theme'> & {\n  autoHeight?: boolean;\n};\n\nconst TemplateEditor = (props: TemplateEditorProps) => {\n  const shouldAutoHeight = Boolean(props.autoHeight);\n  const disposeSuggestions = useRef<IDisposable | null>(null);\n\n  const onEditorDidMount = (editor: editor.IStandaloneCodeEditor) => {\n    if (shouldAutoHeight) {\n      const contentHeight = editor.getContentHeight();\n\n      try {\n        // we're passing NaN in to the width because the type definition wants a number (NaN is a number, go figure)\n        // but the width could be defined as a string \"auto\", passing NaN seems to just ignore our width update here\n        editor.layout({ height: contentHeight, width: NaN });\n      } catch (err) {}\n    }\n  };\n\n  useEffect(() => {\n    return () => {\n      disposeSuggestions.current?.dispose();\n    };\n  }, []);\n\n  return (\n    <CodeEditor\n      showLineNumbers={true}\n      showMiniMap={false}\n      {...props}\n      onEditorDidMount={onEditorDidMount}\n      onBeforeEditorMount={(monaco) => {\n        registerLanguage(monaco, goTemplateLanguageDefinition);\n        disposeSuggestions.current = registerGoTemplateAutocomplete(monaco);\n      }}\n      language={GO_TEMPLATE_LANGUAGE_ID}\n    />\n  );\n};\n\nexport { TemplateEditor };\n","import { css } from '@emotion/css';\nimport { subDays } from 'date-fns';\nimport { Location } from 'history';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { FormProvider, useForm, useFormContext, Validate } from 'react-hook-form';\nimport { useLocation } from 'react-router-dom';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport {\n  Alert,\n  Button,\n  CollapsableSection,\n  Field,\n  FieldSet,\n  Input,\n  LinkButton,\n  Spinner,\n  Tab,\n  TabsBar,\n  useStyles2,\n} from '@grafana/ui';\nimport { useCleanup } from 'app/core/hooks/useCleanup';\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\nimport { useDispatch } from 'app/types';\n\nimport {\n  AlertField,\n  TemplatePreviewErrors,\n  TemplatePreviewResponse,\n  TemplatePreviewResult,\n  usePreviewTemplateMutation,\n} from '../../api/templateApi';\nimport { useUnifiedAlertingSelector } from '../../hooks/useUnifiedAlertingSelector';\nimport { updateAlertManagerConfigAction } from '../../state/actions';\nimport { GRAFANA_RULES_SOURCE_NAME } from '../../utils/datasource';\nimport { makeAMLink } from '../../utils/misc';\nimport { initialAsyncRequestState } from '../../utils/redux';\nimport { ensureDefine } from '../../utils/templates';\nimport { ProvisionedResource, ProvisioningAlert } from '../Provisioning';\n\nimport { PayloadEditor } from './PayloadEditor';\nimport { TemplateDataDocs } from './TemplateDataDocs';\nimport { TemplateEditor } from './TemplateEditor';\nimport { snippets } from './editor/templateDataSuggestions';\n\nexport interface TemplateFormValues {\n  name: string;\n  content: string;\n}\n\nexport const defaults: TemplateFormValues = Object.freeze({\n  name: '',\n  content: '',\n});\n\ninterface Props {\n  existing?: TemplateFormValues;\n  config: AlertManagerCortexConfig;\n  alertManagerSourceName: string;\n  provenance?: string;\n}\nexport const isDuplicating = (location: Location) => location.pathname.endsWith('/duplicate');\n\nconst DEFAULT_PAYLOAD = `[\n  {\n    \"annotations\": {\n      \"summary\": \"Instance instance1 has been down for more than 5 minutes\"\n    },\n    \"labels\": {\n      \"instance\": \"instance1\"\n    },\n    \"startsAt\": \"${subDays(new Date(), 1).toISOString()}\"\n  }]\n`;\n\nexport const TemplateForm = ({ existing, alertManagerSourceName, config, provenance }: Props) => {\n  const styles = useStyles2(getStyles);\n  const dispatch = useDispatch();\n\n  useCleanup((state) => (state.unifiedAlerting.saveAMConfig = initialAsyncRequestState));\n\n  const { loading, error } = useUnifiedAlertingSelector((state) => state.saveAMConfig);\n\n  const location = useLocation();\n  const isduplicating = isDuplicating(location);\n\n  const [payload, setPayload] = useState(DEFAULT_PAYLOAD);\n  const [payloadFormatError, setPayloadFormatError] = useState<string | null>(null);\n\n  const [view, setView] = useState<'content' | 'preview'>('content');\n\n  const onPayloadError = () => setView('preview');\n\n  const submit = (values: TemplateFormValues) => {\n    // wrap content in \"define\" if it's not already wrapped, in case user did not do it/\n    // it's not obvious that this is needed for template to work\n    const content = ensureDefine(values.name, values.content);\n\n    // add new template to template map\n    const template_files = {\n      ...config.template_files,\n      [values.name]: content,\n    };\n\n    // delete existing one (if name changed, otherwise it was overwritten in previous step)\n    if (existing && existing.name !== values.name) {\n      delete template_files[existing.name];\n    }\n\n    // make sure name for the template is configured on the alertmanager config object\n    const templates = [\n      ...(config.alertmanager_config.templates ?? []).filter((name) => name !== existing?.name),\n      values.name,\n    ];\n\n    const newConfig: AlertManagerCortexConfig = {\n      template_files,\n      alertmanager_config: {\n        ...config.alertmanager_config,\n        templates,\n      },\n    };\n    dispatch(\n      updateAlertManagerConfigAction({\n        alertManagerSourceName,\n        newConfig,\n        oldConfig: config,\n        successMessage: 'Template saved.',\n        redirectPath: '/alerting/notifications',\n      })\n    );\n  };\n\n  const formApi = useForm<TemplateFormValues>({\n    mode: 'onSubmit',\n    defaultValues: existing ?? defaults,\n  });\n  const {\n    handleSubmit,\n    register,\n    formState: { errors },\n    getValues,\n    setValue,\n    watch,\n  } = formApi;\n\n  const validateNameIsUnique: Validate<string> = (name: string) => {\n    return !config.template_files[name] || existing?.name === name\n      ? true\n      : 'Another template with this name already exists.';\n  };\n  const isGrafanaAlertManager = alertManagerSourceName === GRAFANA_RULES_SOURCE_NAME;\n\n  return (\n    <FormProvider {...formApi}>\n      <form onSubmit={handleSubmit(submit)}>\n        <h4>{existing && !isduplicating ? 'Edit notification template' : 'Create notification template'}</h4>\n        {error && (\n          <Alert severity=\"error\" title=\"Error saving template\">\n            {error.message || (error as any)?.data?.message || String(error)}\n          </Alert>\n        )}\n        {provenance && <ProvisioningAlert resource={ProvisionedResource.Template} />}\n        <FieldSet disabled={Boolean(provenance)}>\n          <Field label=\"Template name\" error={errors?.name?.message} invalid={!!errors.name?.message} required>\n            <Input\n              {...register('name', {\n                required: { value: true, message: 'Required.' },\n                validate: { nameIsUnique: validateNameIsUnique },\n              })}\n              placeholder=\"Give your template a name\"\n              width={42}\n              autoFocus={true}\n            />\n          </Field>\n          <TemplatingGuideline />\n          <div className={styles.editorsWrapper}>\n            <div className={styles.contentContainer}>\n              <TabsBar>\n                <Tab label=\"Content\" active={view === 'content'} onChangeTab={() => setView('content')} />\n                {isGrafanaAlertManager && (\n                  <Tab label=\"Preview\" active={view === 'preview'} onChangeTab={() => setView('preview')} />\n                )}\n              </TabsBar>\n              <div className={styles.contentContainerEditor}>\n                <AutoSizer>\n                  {({ width }) => (\n                    <>\n                      {view === 'content' ? (\n                        <div>\n                          <Field error={errors?.content?.message} invalid={!!errors.content?.message} required>\n                            <div className={styles.editWrapper}>\n                              <TemplateEditor\n                                value={getValues('content')}\n                                width={width}\n                                height={363}\n                                onBlur={(value) => setValue('content', value)}\n                              />\n                            </div>\n                          </Field>\n                          <div className={styles.buttons}>\n                            {loading && (\n                              <Button disabled={true} icon=\"fa fa-spinner\" variant=\"primary\">\n                                Saving...\n                              </Button>\n                            )}\n                            {!loading && (\n                              <Button type=\"submit\" variant=\"primary\">\n                                Save template\n                              </Button>\n                            )}\n                            <LinkButton\n                              disabled={loading}\n                              href={makeAMLink('alerting/notifications', alertManagerSourceName)}\n                              variant=\"secondary\"\n                              type=\"button\"\n                            >\n                              Cancel\n                            </LinkButton>\n                          </div>\n                        </div>\n                      ) : (\n                        <TemplatePreview\n                          width={width}\n                          payload={payload}\n                          templateName={watch('name')}\n                          setPayloadFormatError={setPayloadFormatError}\n                          payloadFormatError={payloadFormatError}\n                        />\n                      )}\n                    </>\n                  )}\n                </AutoSizer>\n              </div>\n            </div>\n            {isGrafanaAlertManager && (\n              <PayloadEditor\n                payload={payload}\n                setPayload={setPayload}\n                defaultPayload={DEFAULT_PAYLOAD}\n                setPayloadFormatError={setPayloadFormatError}\n                payloadFormatError={payloadFormatError}\n                onPayloadError={onPayloadError}\n              />\n            )}\n          </div>\n        </FieldSet>\n        <CollapsableSection label=\"Data cheat sheet\" isOpen={false} className={styles.collapsableSection}>\n          <TemplateDataDocs />\n        </CollapsableSection>\n      </form>\n    </FormProvider>\n  );\n};\n\nfunction TemplatingGuideline() {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <Alert title=\"Templating guideline\" severity=\"info\">\n      <Stack direction=\"row\">\n        <div>\n          Grafana uses Go templating language to create notification messages.\n          <br />\n          To find out more about templating please visit our documentation.\n        </div>\n        <div>\n          <LinkButton\n            href=\"https://grafana.com/docs/grafana/latest/alerting/manage-notifications/template-notifications/\"\n            target=\"_blank\"\n            icon=\"external-link-alt\"\n            variant=\"secondary\"\n          >\n            Templating documentation\n          </LinkButton>\n        </div>\n      </Stack>\n\n      <div className={styles.snippets}>\n        To make templating easier, we provide a few snippets in the content editor to help you speed up your workflow.\n        <div className={styles.code}>\n          {Object.values(snippets)\n            .map((s) => s.label)\n            .join(', ')}\n        </div>\n      </div>\n    </Alert>\n  );\n}\n\nfunction getResultsToRender(results: TemplatePreviewResult[]) {\n  const filteredResults = results.filter((result) => result.text.trim().length > 0);\n\n  const moreThanOne = filteredResults.length > 1;\n\n  const preview = (result: TemplatePreviewResult) => {\n    const previewForLabel = `Preview for ${result.name}:`;\n    const separatorStart = '='.repeat(previewForLabel.length).concat('>');\n    const separatorEnd = '<'.concat('='.repeat(previewForLabel.length));\n    if (moreThanOne) {\n      return `${previewForLabel}\\n${separatorStart}${result.text}${separatorEnd}\\n`;\n    } else {\n      return `${separatorStart}${result.text}${separatorEnd}\\n`;\n    }\n  };\n\n  return filteredResults\n    .map((result: TemplatePreviewResult) => {\n      return preview(result);\n    })\n    .join(`\\n`);\n}\n\nfunction getErrorsToRender(results: TemplatePreviewErrors[]) {\n  return results\n    .map((result: TemplatePreviewErrors) => {\n      if (result.name) {\n        return `ERROR in ${result.name}:\\n`.concat(`${result.kind}\\n${result.message}\\n`);\n      } else {\n        return `ERROR:\\n${result.kind}\\n${result.message}\\n`;\n      }\n    })\n    .join(`\\n`);\n}\n\nexport const PREVIEW_NOT_AVAILABLE = 'Preview request failed. Check if the payload data has the correct structure.';\n\nfunction getPreviewTorender(\n  isPreviewError: boolean,\n  payloadFormatError: string | null,\n  data: TemplatePreviewResponse | undefined\n) {\n  // ERRORS IN JSON OR IN REQUEST (endpoint not available, for example)\n  const previewErrorRequest = isPreviewError ? PREVIEW_NOT_AVAILABLE : undefined;\n  const somethingWasWrong: boolean = isPreviewError || Boolean(payloadFormatError);\n  const errorToRender = payloadFormatError || previewErrorRequest;\n\n  //PREVIEW : RESULTS AND ERRORS\n  const previewResponseResults = data?.results;\n  const previewResponseErrors = data?.errors;\n\n  const previewResultsToRender = previewResponseResults ? getResultsToRender(previewResponseResults) : '';\n  const previewErrorsToRender = previewResponseErrors ? getErrorsToRender(previewResponseErrors) : '';\n\n  if (somethingWasWrong) {\n    return errorToRender;\n  } else {\n    return `${previewResultsToRender}\\n${previewErrorsToRender}`;\n  }\n}\n\nexport function TemplatePreview({\n  payload,\n  templateName,\n  payloadFormatError,\n  setPayloadFormatError,\n  width,\n}: {\n  payload: string;\n  templateName: string;\n  payloadFormatError: string | null;\n  setPayloadFormatError: (value: React.SetStateAction<string | null>) => void;\n  width: number;\n}) {\n  const styles = useStyles2(getStyles);\n\n  const { watch } = useFormContext<TemplateFormValues>();\n\n  const templateContent = watch('content');\n\n  const [trigger, { data, isError: isPreviewError, isLoading }] = usePreviewTemplateMutation();\n\n  const previewToRender = getPreviewTorender(isPreviewError, payloadFormatError, data);\n\n  const onPreview = useCallback(() => {\n    try {\n      const alertList: AlertField[] = JSON.parse(payload);\n      JSON.stringify([...alertList]); // check if it's iterable, in order to be able to add more data\n      trigger({ template: templateContent, alerts: alertList, name: templateName });\n      setPayloadFormatError(null);\n    } catch (e) {\n      setPayloadFormatError(e instanceof Error ? e.message : 'Invalid JSON.');\n    }\n  }, [templateContent, templateName, payload, setPayloadFormatError, trigger]);\n\n  useEffect(() => onPreview(), [onPreview]);\n\n  return (\n    <div style={{ width: `${width}px` }} className={styles.preview.wrapper}>\n      {isLoading && (\n        <>\n          <Spinner inline={true} /> Loading preview...\n        </>\n      )}\n      <pre className={styles.preview.result} data-testid=\"payloadJSON\">\n        {previewToRender}\n      </pre>\n      <Button onClick={onPreview} className={styles.preview.button} icon=\"arrow-up\" type=\"button\" variant=\"secondary\">\n        Refresh preview\n      </Button>\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  contentContainer: css`\n    flex: 1;\n    margin-bottom: ${theme.spacing(6)};\n  `,\n  contentContainerEditor: css`\n      flex:1;\n      display: flex;\n      padding-top: 10px;\n      gap: ${theme.spacing(2)};\n      flex-direction: row;\n      align-items: flex-start;\n      flex-wrap: wrap;\n      ${theme.breakpoints.up('xxl')} {\n        flex - wrap: nowrap;\n    }\n      min-width: 450px;\n      height: 363px;\n      `,\n  snippets: css`\n    margin-top: ${theme.spacing(2)};\n    font-size: ${theme.typography.bodySmall.fontSize};\n  `,\n  code: css`\n    color: ${theme.colors.text.secondary};\n    font-weight: ${theme.typography.fontWeightBold};\n  `,\n  buttons: css`\n    display: flex;\n    & > * + * {\n      margin-left: ${theme.spacing(1)};\n    }\n    margin-top: -7px;\n  `,\n  textarea: css`\n    max-width: 758px;\n  `,\n  editWrapper: css`\n      display: flex;\n      width: 100%\n      heigth:100%;\n      position: relative;\n      `,\n  toggle: css`\n      color: theme.colors.text.secondary,\n      marginRight: ${theme.spacing(1)}`,\n  preview: {\n    wrapper: css`\n      display: flex;\n      width: 100%\n      heigth:100%;\n      position: relative;\n      flex-direction: column;\n      `,\n    result: css`\n      width: 100%;\n      height: 363px;\n    `,\n    button: css`\n      flex: none;\n      width: fit-content;\n      margin-top: -6px;\n    `,\n  },\n  collapsableSection: css`\n    width: fit-content;\n  `,\n  editorsWrapper: css`\n    display: flex;\n    flex: 1;\n    flex-wrap: wrap;\n    gap: ${theme.spacing(1)};\n  `,\n});\n","import React from 'react';\n\nimport { Alert } from '@grafana/ui';\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\n\nimport { generateCopiedName } from '../../utils/duplicate';\nimport { updateDefinesWithUniqueValue } from '../../utils/templates';\n\nimport { TemplateForm } from './TemplateForm';\n\ninterface Props {\n  templateName: string;\n  config: AlertManagerCortexConfig;\n  alertManagerSourceName: string;\n}\n\nexport const DuplicateTemplateView = ({ config, templateName, alertManagerSourceName }: Props) => {\n  const template = config.template_files?.[templateName];\n\n  if (!template) {\n    return (\n      <Alert severity=\"error\" title=\"Template not found\">\n        Sorry, this template does not seem to exists.\n      </Alert>\n    );\n  }\n\n  const duplicatedName = generateCopiedName(templateName, Object.keys(config.template_files));\n\n  return (\n    <TemplateForm\n      alertManagerSourceName={alertManagerSourceName}\n      config={config}\n      existing={{ name: duplicatedName, content: updateDefinesWithUniqueValue(template) }}\n    />\n  );\n};\n","import { CloudNotifierType, NotificationChannelOption, NotifierDTO } from 'app/types';\n\nfunction option(\n  propertyName: string,\n  label: string,\n  description: string,\n  rest: Partial<NotificationChannelOption> = {}\n): NotificationChannelOption {\n  return {\n    propertyName,\n    label,\n    description,\n    element: 'input',\n    inputType: '',\n    required: false,\n    secure: false,\n    placeholder: '',\n    validationRule: '',\n    showWhen: { field: '', is: '' },\n    dependsOn: '',\n    ...rest,\n  };\n}\n\nconst basicAuthOption: NotificationChannelOption = option(\n  'basic_auth',\n  'Basic auth',\n  'Sets the `Authorization` header with the configured username and password. Password and password_file are mutually exclusive.',\n  {\n    element: 'subform',\n    subformOptions: [\n      option('username', 'Username', ''),\n      option('password', 'Password', ''),\n      option('password_file', 'Password file', ''),\n    ],\n  }\n);\n\nconst tlsConfigOption: NotificationChannelOption = option('tls_config', 'TLS config', 'Configures the TLS settings.', {\n  element: 'subform',\n  subformOptions: [\n    option('ca_file', 'CA file', 'CA certificate to validate the server certificate with.'),\n    option('cert_file', 'Cert file', 'Certificate for client cert authentication to the server.'),\n    option('key_file', 'Key file', 'Key file for client cert authentication to the server.'),\n    option('server_name', 'Server name', 'ServerName extension to indicate the name of the server.'),\n    option('insecure_skip_verify', 'Skip verify', 'Disable validation of the server certificate.', {\n      element: 'checkbox',\n    }),\n  ],\n});\n\nconst httpConfigOption: NotificationChannelOption = option(\n  'http_config',\n  'HTTP Config',\n  'Note that `basic_auth`, `bearer_token` and `bearer_token_file` options are mutually exclusive.',\n  {\n    element: 'subform',\n    subformOptions: [\n      option('bearer_token', 'Bearer token', 'Sets the `Authorization` header with the configured bearer token.'),\n      option(\n        'bearer_token_file',\n        'Bearer token file',\n        'Sets the `Authorization` header with the bearer token read from the configured file.'\n      ),\n      option('proxy_url', 'Proxy URL', 'Optional proxy URL.'),\n      basicAuthOption,\n      tlsConfigOption,\n    ],\n  }\n);\n\nexport const cloudNotifierTypes: Array<NotifierDTO<CloudNotifierType>> = [\n  {\n    name: 'Email',\n    description: 'Send notification over SMTP',\n    type: 'email',\n    info: '',\n    heading: 'Email settings',\n    options: [\n      option(\n        'to',\n        'To',\n        'The email address to send notifications to. You can enter multiple addresses using a \",\" separator',\n        { required: true }\n      ),\n      option('from', 'From', 'The sender address.'),\n      option('smarthost', 'SMTP host', 'The SMTP host through which emails are sent.'),\n      option('hello', 'Hello', 'The hostname to identify to the SMTP server.'),\n      option('auth_username', 'Username', 'SMTP authentication information'),\n      option('auth_password', 'Password', 'SMTP authentication information'),\n      option('auth_secret', 'Secret', 'SMTP authentication information'),\n      option('auth_identity', 'Identity', 'SMTP authentication information'),\n      option('require_tls', 'Require TLS', 'The SMTP TLS requirement', { element: 'checkbox' }),\n      option('html', 'Email HTML body', 'The HTML body of the email notification.', {\n        placeholder: '{{ template \"email.default.html\" . }}',\n        element: 'textarea',\n      }),\n      option('text', 'Email text body', 'The text body of the email notification.', { element: 'textarea' }),\n      option(\n        'headers',\n        'Headers',\n        'Further headers email header key/value pairs. Overrides any headers previously set by the notification implementation.',\n        { element: 'key_value_map' }\n      ),\n      tlsConfigOption,\n    ],\n  },\n  {\n    name: 'PagerDuty',\n    description: 'Send notifications to PagerDuty',\n    type: 'pagerduty',\n    info: '',\n    heading: 'PagerDuty settings',\n    options: [\n      option(\n        'routing_key',\n        'Routing key',\n        'The PagerDuty integration key (when using PagerDuty integration type `Events API v2`)'\n      ),\n      option(\n        'service_key',\n        'Service key',\n        'The PagerDuty integration key (when using PagerDuty integration type `Prometheus`).'\n      ),\n      option('url', 'URL', 'The URL to send API requests to'),\n      option('client', 'Client', 'The client identification of the Alertmanager.', {\n        placeholder: '{{ template \"pagerduty.default.client\" . }}',\n      }),\n      option('client_url', 'Client URL', 'A backlink to the sender of the notification.', {\n        placeholder: '{{ template \"pagerduty.default.clientURL\" . }}',\n      }),\n      option('description', 'Description', 'A description of the incident.', {\n        placeholder: '{{ template \"pagerduty.default.description\" .}}',\n      }),\n      option('severity', 'Severity', 'Severity of the incident.', { placeholder: 'error' }),\n      option(\n        'details',\n        'Details',\n        'A set of arbitrary key/value pairs that provide further detail about the incident.',\n        {\n          element: 'key_value_map',\n        }\n      ),\n      option('images', 'Images', 'Images to attach to the incident.', {\n        element: 'subform_array',\n        subformOptions: [\n          option('href', 'URL', '', { required: true }),\n          option('source', 'Source', '', { required: true }),\n          option('alt', 'Alt', '', { required: true }),\n        ],\n      }),\n      option('links', 'Links', 'Links to attach to the incident.', {\n        element: 'subform_array',\n        subformOptions: [option('href', 'URL', '', { required: true }), option('text', 'Text', '', { required: true })],\n      }),\n      httpConfigOption,\n    ],\n  },\n  {\n    name: 'Pushover',\n    description: 'Send notifications to Pushover',\n    type: 'pushover',\n    info: '',\n    heading: 'Pushover settings',\n    options: [\n      option('user_key', 'User key', 'The recipient users user key.', { required: true }),\n      option('token', 'Token', 'Your registered applications API token, see https://pushover.net/app', {\n        required: true,\n      }),\n      option('title', 'Title', 'Notification title.', {\n        placeholder: '{{ template \"pushover.default.title\" . }}',\n      }),\n      option('message', 'Message', 'Notification message.', {\n        placeholder: '{{ template \"pushover.default.message\" . }}',\n      }),\n      option('url', 'URL', 'A supplementary URL shown alongside the message.', {\n        placeholder: '{{ template \"pushover.default.url\" . }}',\n      }),\n      option('priority', 'Priority', 'Priority, see https://pushover.net/api#priority', {\n        placeholder: '{{ if eq .Status \"firing\" }}2{{ else }}0{{ end }}',\n      }),\n      option(\n        'retry',\n        'Retry',\n        'How often the Pushover servers will send the same notification to the user. Must be at least 30 seconds.',\n        {\n          placeholder: '1m',\n        }\n      ),\n      option(\n        'expire',\n        'Expire',\n        'How long your notification will continue to be retried for, unless the user acknowledges the notification.',\n        {\n          placeholder: '1h',\n        }\n      ),\n      httpConfigOption,\n    ],\n  },\n  {\n    name: 'Slack',\n    description: 'Send notifications to Slack',\n    type: 'slack',\n    info: '',\n    heading: 'Slack settings',\n    options: [\n      option('api_url', 'Webhook URL', 'The Slack webhook URL.'),\n      option('channel', 'Channel', 'The #channel or @user to send notifications to.', { required: true }),\n      option('icon_emoji', 'Emoji icon', ''),\n      option('icon_url', 'Icon URL', ''),\n      option('link_names', 'Names link', '', { element: 'checkbox' }),\n      option('username', 'Username', '', { placeholder: '{{ template \"slack.default.username\" . }}' }),\n      option('callback_id', 'Callback ID', '', { placeholder: '{{ template \"slack.default.callbackid\" . }}' }),\n      option('color', 'Color', '', { placeholder: '{{ if eq .Status \"firing\" }}danger{{ else }}good{{ end }}' }),\n      option('fallback', 'Fallback', '', { placeholder: '{{ template \"slack.default.fallback\" . }}' }),\n      option('footer', 'Footer', '', { placeholder: '{{ template \"slack.default.footer\" . }}' }),\n      option('mrkdwn_in', 'Mrkdwn fields', 'An array of field names that should be formatted by mrkdwn syntax.', {\n        element: 'string_array',\n      }),\n      option('pretext', 'Pre-text', '', { placeholder: '{{ template \"slack.default.pretext\" . }}' }),\n      option('short_fields', 'Short fields', '', { element: 'checkbox' }),\n      option('text', 'Message body', '', { element: 'textarea', placeholder: '{{ template \"slack.default.text\" . }}' }),\n      option('title', 'Title', '', { placeholder: '{{ template \"slack.default.title\" . }}' }),\n      option('title_link', 'Title link', '', { placeholder: '{{ template \"slack.default.titlelink\" . }}' }),\n      option('image_url', 'Image URL', ''),\n      option('thumb_url', 'Thumbnail URL', ''),\n      option('actions', 'Actions', '', {\n        element: 'subform_array',\n        subformOptions: [\n          option('text', 'Text', '', { required: true }),\n          option('type', 'Type', '', { required: true }),\n          option('url', 'URL', 'Either url or name and value are mandatory.'),\n          option('name', 'Name', ''),\n          option('value', 'Value', ''),\n          option('confirm', 'Confirm', '', {\n            element: 'subform',\n            subformOptions: [\n              option('text', 'Text', '', { required: true }),\n              option('dismiss_text', 'Dismiss text', ''),\n              option('ok_text', 'OK text', ''),\n              option('title', 'Title', ''),\n            ],\n          }),\n          option('style', 'Style', ''),\n        ],\n      }),\n      option('fields', 'Fields', '', {\n        element: 'subform_array',\n        subformOptions: [\n          option('title', 'Title', '', { required: true }),\n          option('value', 'Value', '', { required: true }),\n          option('short', 'Short', '', { element: 'checkbox' }),\n        ],\n      }),\n      httpConfigOption,\n    ],\n  },\n  {\n    name: 'OpsGenie',\n    description: 'Send notifications to OpsGenie',\n    type: 'opsgenie',\n    info: '',\n    heading: 'OpsGenie settings',\n    options: [\n      option('api_key', 'API key', 'The API key to use when talking to the OpsGenie API.'),\n      option('api_url', 'API URL', 'The host to send OpsGenie API requests to.'),\n      option('message', 'Message', 'Alert text limited to 130 characters.'),\n      option('description', 'Description', 'A description of the incident.', {\n        placeholder: '{{ template \"opsgenie.default.description\" . }}',\n      }),\n      option('source', 'Source', 'A backlink to the sender of the notification.', {\n        placeholder: '{{ template \"opsgenie.default.source\" . }}',\n      }),\n      option(\n        'details',\n        'Details',\n        'A set of arbitrary key/value pairs that provide further detail about the incident.',\n        {\n          element: 'key_value_map',\n        }\n      ),\n      option('tags', 'Tags', 'Comma separated list of tags attached to the notifications.'),\n      option('note', 'Note', 'Additional alert note.'),\n      option('priority', 'Priority', 'Priority level of alert. Possible values are P1, P2, P3, P4, and P5.'),\n      option('responders', 'Responders', 'List of responders responsible for notifications.', {\n        element: 'subform_array',\n        subformOptions: [\n          option('type', 'Type', '\"team\", \"user\", \"escalation\" or schedule\".', { required: true }),\n          option('id', 'ID', 'Exactly one of these fields should be defined.'),\n          option('name', 'Name', 'Exactly one of these fields should be defined.'),\n          option('username', 'Username', 'Exactly one of these fields should be defined.'),\n        ],\n      }),\n      httpConfigOption,\n    ],\n  },\n  {\n    name: 'VictorOps',\n    description: 'Send notifications to VictorOps',\n    type: 'victorops',\n    info: '',\n    heading: 'VictorOps settings',\n    options: [\n      option('api_key', 'API key', 'The API key to use when talking to the VictorOps API.'),\n      option('api_url', 'API URL', 'The VictorOps API URL.'),\n      option('routing_key', 'Routing key', 'A key used to map the alert to a team.', { required: true }),\n      option('message_type', 'Message type', 'Describes the behavior of the alert (CRITICAL, WARNING, INFO).'),\n      option('entity_display_name', 'Entity display name', 'Contains summary of the alerted problem.', {\n        placeholder: '{{ template \"victorops.default.entity_display_name\" . }}',\n      }),\n      option('state_message', 'State message', 'Contains long explanation of the alerted problem.', {\n        placeholder: '{{ template \"victorops.default.state_message\" . }}',\n      }),\n      option('monitoring_tool', 'Monitoring tool', 'The monitoring tool the state message is from.', {\n        placeholder: '{{ template \"victorops.default.monitoring_tool\" . }}',\n      }),\n      httpConfigOption,\n    ],\n  },\n  {\n    name: 'Webhook',\n    description: 'Send notifications to a webhook',\n    type: 'webhook',\n    info: '',\n    heading: 'Webhook settings',\n    options: [\n      option('url', 'URL', 'The endpoint to send HTTP POST requests to.', { required: true }),\n      option(\n        'max_alerts',\n        'Max alerts',\n        'The maximum number of alerts to include in a single webhook message. Alerts above this threshold are truncated. When leaving this at its default value of 0, all alerts are included.',\n        { placeholder: '0', validationRule: '(^\\\\d+$|^$)' }\n      ),\n      httpConfigOption,\n    ],\n  },\n  {\n    name: 'Discord',\n    description: 'Sends notifications to Discord',\n    type: 'discord',\n    info: '',\n    heading: 'Discord settings',\n    options: [\n      option('title', 'Title', 'Templated title of the message', {\n        placeholder: '{{ template \"discord.default.title\" . }}',\n      }),\n      option(\n        'message',\n        'Message Content',\n        'Mention a group using @ or a user using <@ID> when notifying in a channel',\n        { placeholder: '{{ template \"discord.default.message\" . }}' }\n      ),\n      option('webhook_url', 'Webhook URL', '', { placeholder: 'Discord webhook URL', required: true }),\n      httpConfigOption,\n    ],\n  },\n  {\n    name: 'Cisco Webex Teams',\n    description: 'Sends notifications to Cisco Webex Teams',\n    type: 'webex',\n    info: '',\n    heading: 'Cisco Webex Teams settings',\n    options: [\n      option('api_url', 'API URL', 'The Webex Teams API URL', {\n        placeholder: 'https://webexapis.com/v1/messages',\n      }),\n      option('room_id', 'Room ID', 'ID of the Webex Teams room where to send the messages', {\n        required: true,\n      }),\n      option('message', 'Message', 'Message template', {\n        placeholder: '{{ template \"webex.default.message\" .}}',\n      }),\n      {\n        ...httpConfigOption,\n        required: true,\n      },\n    ],\n  },\n  {\n    name: 'Telegram',\n    description: 'Sends notifications to Telegram',\n    type: 'telegram',\n    info: '',\n    heading: 'Telegram settings',\n    options: [\n      option('api_url', 'API URL', 'The Telegram API URL', {\n        placeholder: 'https://api.telegram.org',\n      }),\n      option('bot_token', 'Bot token', 'Telegram bot token', {\n        required: true,\n      }),\n      option('chat_id', 'Chat ID', 'ID of the chat where to send the messages', {\n        required: true,\n        setValueAs: (value) => (typeof value === 'string' ? parseInt(value, 10) : 0),\n      }),\n      option('message', 'Message', 'Message template', {\n        placeholder: '{{ template \"webex.default.message\" .}}',\n      }),\n      option('disable_notifications', 'Disable notifications', 'Disable telegram notifications', {\n        element: 'checkbox',\n      }),\n      option('parse_mode', 'Parse mode', 'Parse mode for telegram message', {\n        element: 'select',\n        defaultValue: { label: 'MarkdownV2', value: 'MarkdownV2' },\n        selectOptions: [\n          { label: 'MarkdownV2', value: 'MarkdownV2' },\n          { label: 'Markdown', value: 'Markdown' },\n          { label: 'HTML', value: 'HTML' },\n          { label: 'plain text', value: '' },\n        ],\n      }),\n      httpConfigOption,\n    ],\n  },\n  {\n    name: 'Amazon SNS',\n    description: 'Sends notifications to Amazon SNS',\n    type: 'sns',\n    info: '',\n    heading: 'Amazon SNS settings',\n    options: [\n      option('api_url', 'API URL', 'The Amazon SNS API URL'),\n      option(\n        'sigv4',\n        'SigV4 authentication',\n        \"Configures AWS's Signature Verification 4 signing process to sign requests\",\n        {\n          element: 'subform',\n          subformOptions: [\n            option(\n              'region',\n              'Region',\n              'The AWS region. If blank, the region from the default credentials chain is used'\n            ),\n            option(\n              'access_key',\n              'Access key',\n              'The AWS API access_key. If blank the environment variable \"AWS_ACCESS_KEY_ID\" is used'\n            ),\n            option(\n              'secret_key',\n              'Secret key',\n              'The AWS API secret_key. If blank the environment variable \"AWS_ACCESS_SECRET_ID\" is used'\n            ),\n            option('profile', 'Profile', 'Named AWS profile used to authenticate'),\n            option('role_arn', 'Rule ARN', 'AWS Role ARN, an alternative to using AWS API keys'),\n          ],\n        }\n      ),\n      option(\n        'topic_arn',\n        'SNS topic ARN',\n        \"If you don't specify this value, you must specify a value for the phone_number or target_arn. If you are using a FIFO SNS topic you should set a message group interval longer than 5 minutes to prevent messages with the same group key being deduplicated by the SNS default deduplication window\"\n      ),\n      option(\n        'phone_number',\n        'Phone number',\n        \"Phone number if message is delivered via SMS in E.164 format. If you don't specify this value, you must specify a value for the topic_arn or target_arn\"\n      ),\n      option(\n        'target_arn',\n        'Target ARN',\n        \"The  mobile platform endpoint ARN if message is delivered via mobile notifications. If you don't specify this value, you must specify a value for the topic_arn or phone_number\"\n      ),\n\n      option('subject', 'Subject', 'Subject line when the message is delivered to email endpoints', {\n        placeholder: '{{ template \"sns.default.subject\" .}}',\n      }),\n      option('message', 'Message', 'The message content of the SNS notification', {\n        placeholder: '{{ template \"sns.default.message\" .}}',\n      }),\n      option('attributes', 'Attributes', 'SNS message attributes', {\n        element: 'key_value_map',\n      }),\n      httpConfigOption,\n    ],\n  },\n  {\n    name: 'WeChat',\n    description: 'Sends notifications to WeChat',\n    type: 'wechat',\n    info: '',\n    heading: 'WeChat settings',\n    options: [\n      option('api_url', 'API URL', 'The WeChat API URL'),\n      option('api_secret', 'API Secret', 'The API key to use when talking to the WeChat API'),\n      option('corp_id', 'Corp ID', 'The corp id for authentication'),\n      option('message', 'Message', 'API request data as defined by the WeChat API', {\n        placeholder: '{{ template \"wechat.default.message\" . }}',\n      }),\n      option('message_type', 'Message type', 'Type of the message type', {\n        element: 'select',\n        defaultValue: { label: 'Text', value: 'text' },\n        selectOptions: [\n          { label: 'Text', value: 'text' },\n          { label: 'Markdown', value: 'markdown' },\n        ],\n      }),\n      option('agent_id', 'Agent ID', '', {\n        placeholder: '{{ template \"wechat.default.agent_id\" . }}',\n      }),\n      option('to_user', 'to user', '', {\n        placeholder: '{{ template \"wechat.default.to_user\" . }}',\n      }),\n      option('to_party', 'to party', '', {\n        placeholder: '{{ template \"wechat.default.to_party\" . }}',\n      }),\n      option('to_tag', 'to tag', '', {\n        placeholder: '{{ template \"wechat.default.to_tag\" . }}',\n      }),\n    ],\n  },\n];\n\nexport const globalConfigOptions: NotificationChannelOption[] = [\n  // email\n  option('smtp_from', 'SMTP from', 'The default SMTP From header field.'),\n  option(\n    'smtp_smarthost',\n    'SMTP smarthost',\n    'The default SMTP smarthost used for sending emails, including port number. Port number usually is 25, or 587 for SMTP over TLS (sometimes referred to as STARTTLS). Example: smtp.example.org:587'\n  ),\n  option('smtp_hello', 'SMTP hello', 'The default hostname to identify to the SMTP server.', {\n    placeholder: 'localhost',\n  }),\n  option(\n    'smtp_auth_username',\n    'SMTP auth username',\n    \"SMTP Auth using CRAM-MD5, LOGIN and PLAIN. If empty, Alertmanager doesn't authenticate to the SMTP server.\"\n  ),\n  option('smtp_auth_password', 'SMTP auth password', 'SMTP Auth using LOGIN and PLAIN.'),\n  option('smtp_auth_identity', 'SMTP auth identity', 'SMTP Auth using PLAIN.'),\n  option('smtp_auth_secret', 'SMTP auth secret', 'SMTP Auth using CRAM-MD5.'),\n  option(\n    'smtp_require_tls',\n    'SMTP require TLS',\n    'The default SMTP TLS requirement. Note that Go does not support unencrypted connections to remote SMTP endpoints.',\n    {\n      element: 'checkbox',\n    }\n  ),\n\n  // slack\n  option('slack_api_url', 'Slack API URL', ''),\n  option('victorops_api_key', 'VictorOps API key', ''),\n  option('victorops_api_url', 'VictorOps API URL', '', {\n    placeholder: 'https://alert.victorops.com/integrations/generic/20131114/alert/',\n  }),\n  option('pagerduty_url', 'PagerDuty URL', 'https://events.pagerduty.com/v2/enqueue'),\n  option('opsgenie_api_key', 'OpsGenie API key', ''),\n  option('opsgenie_api_url', 'OpsGenie API URL', '', { placeholder: 'https://api.opsgenie.com/' }),\n  option('wechat_api_url', 'WeChat API URL', '', { placeholder: 'https://qyapi.weixin.qq.com/cgi-bin/' }),\n  option('wechat_api_secret', 'WeChat API secret', ''),\n  option('wechat_api_corp_id', 'WeChat API corp id', ''),\n  option('webex_api_url', 'Cisco Webex Teams API URL', ''),\n  option('telegram_api_url', 'The Telegram API URL', ''),\n  httpConfigOption,\n  option(\n    'resolve_timeout',\n    'Resolve timeout',\n    'ResolveTimeout is the default value used by alertmanager if the alert does not include EndsAt, after this time passes it can declare the alert as resolved if it has not been updated. This has no impact on alerts from Prometheus, as they always include EndsAt.',\n    {\n      placeholder: '5m',\n    }\n  ),\n];\n","import { isArray } from 'lodash';\n\nimport {\n  AlertManagerCortexConfig,\n  GrafanaManagedReceiverConfig,\n  Receiver,\n  Route,\n} from 'app/plugins/datasource/alertmanager/types';\nimport { CloudNotifierType, NotifierDTO, NotifierType } from 'app/types';\n\nimport {\n  CloudChannelConfig,\n  CloudChannelMap,\n  CloudChannelValues,\n  GrafanaChannelMap,\n  GrafanaChannelValues,\n  ReceiverFormValues,\n} from '../types/receiver-form';\n\nexport function grafanaReceiverToFormValues(\n  receiver: Receiver,\n  notifiers: NotifierDTO[]\n): [ReceiverFormValues<GrafanaChannelValues>, GrafanaChannelMap] {\n  const channelMap: GrafanaChannelMap = {};\n  // giving each form receiver item a unique id so we can use it to map back to \"original\" items\n  // as well as to use as `key` prop.\n  // @TODO use uid once backend is fixed to provide it. then we can get rid of the GrafanaChannelMap\n  let idCounter = 1;\n  const values = {\n    name: receiver.name,\n    items:\n      receiver.grafana_managed_receiver_configs?.map((channel) => {\n        const id = String(idCounter++);\n        channelMap[id] = channel;\n        const notifier = notifiers.find(({ type }) => type === channel.type);\n        return grafanaChannelConfigToFormChannelValues(id, channel, notifier);\n      }) ?? [],\n  };\n  return [values, channelMap];\n}\n\nexport function cloudReceiverToFormValues(\n  receiver: Receiver,\n  notifiers: NotifierDTO[]\n): [ReceiverFormValues<CloudChannelValues>, CloudChannelMap] {\n  const channelMap: CloudChannelMap = {};\n  // giving each form receiver item a unique id so we can use it to map back to \"original\" items\n  let idCounter = 1;\n  const items: CloudChannelValues[] = Object.entries(receiver)\n    // filter out only config items that are relevant to cloud\n    .filter(([type]) => type.endsWith('_configs') && type !== 'grafana_managed_receiver_configs')\n    // map property names to cloud notifier types by removing the `_config` suffix\n    .map(([type, configs]): [CloudNotifierType, CloudChannelConfig[]] => [\n      type.replace('_configs', '') as CloudNotifierType,\n      configs as CloudChannelConfig[],\n    ])\n    // convert channel configs to form values\n    .map(([type, configs]) =>\n      configs.map((config) => {\n        const id = String(idCounter++);\n        channelMap[id] = { type, config };\n        const notifier = notifiers.find((notifier) => notifier.type === type);\n        if (!notifier) {\n          throw new Error(`unknown cloud notifier: ${type}`);\n        }\n        return cloudChannelConfigToFormChannelValues(id, type, config);\n      })\n    )\n    .flat();\n  const values = {\n    name: receiver.name,\n    items,\n  };\n  return [values, channelMap];\n}\n\nexport function formValuesToGrafanaReceiver(\n  values: ReceiverFormValues<GrafanaChannelValues>,\n  channelMap: GrafanaChannelMap,\n  defaultChannelValues: GrafanaChannelValues\n): Receiver {\n  return {\n    name: values.name,\n    grafana_managed_receiver_configs: (values.items ?? []).map((channelValues) => {\n      const existing: GrafanaManagedReceiverConfig | undefined = channelMap[channelValues.__id];\n      return formChannelValuesToGrafanaChannelConfig(channelValues, defaultChannelValues, values.name, existing);\n    }),\n  };\n}\n\nexport function formValuesToCloudReceiver(\n  values: ReceiverFormValues<CloudChannelValues>,\n  defaults: CloudChannelValues\n): Receiver {\n  const recv: Receiver = {\n    name: values.name,\n  };\n  values.items.forEach(({ __id, type, settings, sendResolved }) => {\n    const channel = omitEmptyValues({\n      ...settings,\n      send_resolved: sendResolved ?? defaults.sendResolved,\n    });\n\n    const configsKey = `${type}_configs`;\n    if (!recv[configsKey]) {\n      recv[configsKey] = [channel];\n    } else {\n      (recv[configsKey] as unknown[]).push(channel);\n    }\n  });\n  return recv;\n}\n\n// will add new receiver, or replace exisitng one\nexport function updateConfigWithReceiver(\n  config: AlertManagerCortexConfig,\n  receiver: Receiver,\n  replaceReceiverName?: string\n): AlertManagerCortexConfig {\n  const oldReceivers = config.alertmanager_config.receivers ?? [];\n\n  // sanity check that name is not duplicated\n  if (receiver.name !== replaceReceiverName && !!oldReceivers.find(({ name }) => name === receiver.name)) {\n    throw new Error(`Duplicate receiver name ${receiver.name}`);\n  }\n\n  // sanity check that existing receiver exists\n  if (replaceReceiverName && !oldReceivers.find(({ name }) => name === replaceReceiverName)) {\n    throw new Error(`Expected receiver ${replaceReceiverName} to exist, but did not find it in the config`);\n  }\n\n  const updated: AlertManagerCortexConfig = {\n    ...config,\n    alertmanager_config: {\n      // @todo rename receiver on routes as necessary\n      ...config.alertmanager_config,\n      receivers: replaceReceiverName\n        ? oldReceivers.map((existingReceiver) =>\n            existingReceiver.name === replaceReceiverName ? receiver : existingReceiver\n          )\n        : [...oldReceivers, receiver],\n    },\n  };\n\n  // if receiver was renamed, rename it in routes as well\n  if (updated.alertmanager_config.route && replaceReceiverName && receiver.name !== replaceReceiverName) {\n    updated.alertmanager_config.route = renameReceiverInRoute(\n      updated.alertmanager_config.route,\n      replaceReceiverName,\n      receiver.name\n    );\n  }\n\n  return updated;\n}\n\nfunction renameReceiverInRoute(route: Route, oldName: string, newName: string) {\n  const updated: Route = {\n    ...route,\n  };\n  if (updated.receiver === oldName) {\n    updated.receiver = newName;\n  }\n  if (updated.routes) {\n    updated.routes = updated.routes.map((route) => renameReceiverInRoute(route, oldName, newName));\n  }\n  return updated;\n}\n\nfunction cloudChannelConfigToFormChannelValues(\n  id: string,\n  type: CloudNotifierType,\n  channel: CloudChannelConfig\n): CloudChannelValues {\n  return {\n    __id: id,\n    type,\n    settings: {\n      ...channel,\n    },\n    secureFields: {},\n    secureSettings: {},\n    sendResolved: channel.send_resolved,\n  };\n}\n\nfunction grafanaChannelConfigToFormChannelValues(\n  id: string,\n  channel: GrafanaManagedReceiverConfig,\n  notifier?: NotifierDTO\n): GrafanaChannelValues {\n  const values: GrafanaChannelValues = {\n    __id: id,\n    type: channel.type as NotifierType,\n    provenance: channel.provenance,\n    secureSettings: {},\n    settings: { ...channel.settings },\n    secureFields: { ...channel.secureFields },\n    disableResolveMessage: channel.disableResolveMessage,\n  };\n\n  // work around https://github.com/grafana/alerting-squad/issues/100\n  notifier?.options.forEach((option) => {\n    if (option.secure && values.settings[option.propertyName]) {\n      delete values.settings[option.propertyName];\n      values.secureFields[option.propertyName] = true;\n    }\n  });\n\n  return values;\n}\n\nexport function formChannelValuesToGrafanaChannelConfig(\n  values: GrafanaChannelValues,\n  defaults: GrafanaChannelValues,\n  name: string,\n  existing?: GrafanaManagedReceiverConfig\n): GrafanaManagedReceiverConfig {\n  const channel: GrafanaManagedReceiverConfig = {\n    settings: omitEmptyValues({\n      ...(existing && existing.type === values.type ? existing.settings ?? {} : {}),\n      ...(values.settings ?? {}),\n    }),\n    secureSettings: values.secureSettings ?? {},\n    type: values.type,\n    name,\n    disableResolveMessage:\n      values.disableResolveMessage ?? existing?.disableResolveMessage ?? defaults.disableResolveMessage,\n  };\n  if (existing) {\n    channel.uid = existing.uid;\n  }\n  return channel;\n}\n\n// will remove properties that have empty ('', null, undefined) object properties.\n// traverses nested objects and arrays as well. in place, mutates the object.\n// this is needed because form will submit empty string for not filled in fields,\n// but for cloud alertmanager receiver config to use global default value the property must be omitted entirely\n// this isn't a perfect solution though. No way for user to intentionally provide an empty string. Will need rethinking later\nexport function omitEmptyValues<T>(obj: T): T {\n  if (isArray(obj)) {\n    obj.forEach(omitEmptyValues);\n  } else if (typeof obj === 'object' && obj !== null) {\n    Object.entries(obj).forEach(([key, value]) => {\n      if (value === '' || value === null || value === undefined) {\n        delete (obj as any)[key];\n      } else {\n        omitEmptyValues(value);\n      }\n    });\n  }\n  return obj;\n}\n","import React from 'react';\nimport { useFormContext } from 'react-hook-form';\n\nimport { Checkbox, Field } from '@grafana/ui';\n\nimport { CommonSettingsComponentProps } from '../../../types/receiver-form';\n\nexport const CloudCommonChannelSettings = ({\n  pathPrefix,\n  className,\n  readOnly = false,\n}: CommonSettingsComponentProps) => {\n  const { register } = useFormContext();\n  return (\n    <div className={className}>\n      <Field disabled={readOnly}>\n        <Checkbox\n          {...register(`${pathPrefix}sendResolved`)}\n          label=\"Send resolved\"\n          disabled={readOnly}\n          description=\"Whether or not to notify about resolved alerts.\"\n        />\n      </Field>\n    </div>\n  );\n};\n","import { set } from 'lodash';\nimport { useCallback } from 'react';\nimport { UseFormReturn } from 'react-hook-form';\n\ninterface Options<R> {\n  name: string;\n  formAPI: UseFormReturn<any>;\n  defaults?: R[];\n\n  // if true, sets `__deleted: true` but does not remove item from the array in values\n  softDelete?: boolean;\n}\n\nexport type ControlledField<R> = R & {\n  __deleted?: boolean;\n};\n\nconst EMPTY_ARRAY = [] as const;\n\n/*\n * react-hook-form's own useFieldArray is uncontrolled and super buggy.\n * this is a simple controlled version. It's dead simple and more robust at the cost of re-rendering the form\n * on every change to the sub forms in the array.\n * Warning: you'll have to take care of your own unique identiifer to use as `key` for the ReactNode array.\n * Using index will cause problems.\n */\nexport function useControlledFieldArray<R>(options: Options<R>) {\n  const { name, formAPI, defaults, softDelete } = options;\n  const { watch, getValues, reset, setValue } = formAPI;\n\n  const fields: Array<ControlledField<R>> = watch(name) ?? defaults ?? EMPTY_ARRAY;\n\n  const update = useCallback(\n    (updateFn: (fields: R[]) => R[]) => {\n      const values = JSON.parse(JSON.stringify(getValues()));\n      const newItems = updateFn(fields ?? []);\n      reset(set(values, name, newItems));\n    },\n    [getValues, name, reset, fields]\n  );\n\n  return {\n    fields,\n    append: useCallback((values: R) => update((fields) => [...fields, values]), [update]),\n    remove: useCallback(\n      (index: number) => {\n        if (softDelete) {\n          setValue(`${name}.${index}.__deleted`, true);\n        } else {\n          update((items) => {\n            const newItems = items.slice();\n            newItems.splice(index, 1);\n            return newItems;\n          });\n        }\n      },\n      [update, name, setValue, softDelete]\n    ),\n  };\n}\n","import { css } from '@emotion/css';\nimport React, { useEffect, useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Button, Input, useStyles2 } from '@grafana/ui';\n\nimport { ActionIcon } from '../../../rules/ActionIcon';\n\ninterface Props {\n  value?: Record<string, string>;\n  readOnly?: boolean;\n  onChange: (value: Record<string, string>) => void;\n}\n\nexport const KeyValueMapInput = ({ value, onChange, readOnly = false }: Props) => {\n  const styles = useStyles2(getStyles);\n  const [pairs, setPairs] = useState(recordToPairs(value));\n  useEffect(() => setPairs(recordToPairs(value)), [value]);\n\n  const emitChange = (pairs: Array<[string, string]>) => {\n    onChange(pairsToRecord(pairs));\n  };\n\n  const deleteItem = (index: number) => {\n    const newPairs = pairs.slice();\n    const removed = newPairs.splice(index, 1)[0];\n    setPairs(newPairs);\n    if (removed[0]) {\n      emitChange(newPairs);\n    }\n  };\n\n  const updatePair = (values: [string, string], index: number) => {\n    const old = pairs[index];\n    const newPairs = pairs.map((pair, i) => (i === index ? values : pair));\n    setPairs(newPairs);\n    if (values[0] || old[0]) {\n      emitChange(newPairs);\n    }\n  };\n\n  return (\n    <div>\n      {!!pairs.length && (\n        <table className={styles.table}>\n          <thead>\n            <tr>\n              <th>Name</th>\n              <th>Value</th>\n              {!readOnly && <th></th>}\n            </tr>\n          </thead>\n          <tbody>\n            {pairs.map(([key, value], index) => (\n              <tr key={index}>\n                <td>\n                  <Input\n                    readOnly={readOnly}\n                    value={key}\n                    onChange={(e) => updatePair([e.currentTarget.value, value], index)}\n                  />\n                </td>\n                <td>\n                  <Input\n                    readOnly={readOnly}\n                    value={value}\n                    onChange={(e) => updatePair([key, e.currentTarget.value], index)}\n                  />\n                </td>\n                {!readOnly && (\n                  <td>\n                    <ActionIcon icon=\"trash-alt\" tooltip=\"delete\" onClick={() => deleteItem(index)} />\n                  </td>\n                )}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      )}\n      {!readOnly && (\n        <Button\n          className={styles.addButton}\n          type=\"button\"\n          variant=\"secondary\"\n          icon=\"plus\"\n          size=\"sm\"\n          onClick={() => setPairs([...pairs, ['', '']])}\n        >\n          Add\n        </Button>\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  addButton: css`\n    margin-top: ${theme.spacing(1)};\n  `,\n  table: css`\n    tbody td {\n      padding: 0 ${theme.spacing(1)} ${theme.spacing(1)} 0;\n    }\n  `,\n});\n\nconst pairsToRecord = (pairs: Array<[string, string]>): Record<string, string> => {\n  const record: Record<string, string> = {};\n  for (const [key, value] of pairs) {\n    if (key) {\n      record[key] = value;\n    }\n  }\n  return record;\n};\n\nconst recordToPairs = (obj?: Record<string, string>): Array<[string, string]> => Object.entries(obj ?? {});\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Button, Input, useStyles2 } from '@grafana/ui';\n\nimport { ActionIcon } from '../../../rules/ActionIcon';\n\ninterface Props {\n  value?: string[];\n  readOnly?: boolean;\n  onChange: (value: string[]) => void;\n}\n\nexport const StringArrayInput = ({ value, onChange, readOnly = false }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const deleteItem = (index: number) => {\n    if (!value) {\n      return;\n    }\n    const newValue = value.slice();\n    newValue.splice(index, 1);\n    onChange(newValue);\n  };\n\n  const updateValue = (itemValue: string, index: number) => {\n    if (!value) {\n      return;\n    }\n    onChange(value.map((v, i) => (i === index ? itemValue : v)));\n  };\n\n  return (\n    <div>\n      {!!value?.length &&\n        value.map((v, index) => (\n          <div key={index} className={styles.row}>\n            <Input readOnly={readOnly} value={v} onChange={(e) => updateValue(e.currentTarget.value, index)} />\n            {!readOnly && (\n              <ActionIcon\n                className={styles.deleteIcon}\n                icon=\"trash-alt\"\n                tooltip=\"delete\"\n                onClick={() => deleteItem(index)}\n              />\n            )}\n          </div>\n        ))}\n      {!readOnly && (\n        <Button\n          className={styles.addButton}\n          type=\"button\"\n          variant=\"secondary\"\n          icon=\"plus\"\n          size=\"sm\"\n          onClick={() => onChange([...(value ?? []), ''])}\n        >\n          Add\n        </Button>\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  row: css`\n    display: flex;\n    flex-direction: row;\n    margin-bottom: ${theme.spacing(1)};\n    align-items: center;\n  `,\n  deleteIcon: css`\n    margin-left: ${theme.spacing(1)};\n  `,\n  addButton: css`\n    margin-top: ${theme.spacing(1)};\n  `,\n});\n","import { css, cx } from '@emotion/css';\nimport React, { useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { IconSize, useStyles2 } from '@grafana/ui';\n\nimport { CollapseToggle } from '../../CollapseToggle';\n\ninterface Props {\n  label: string;\n  description?: string;\n  className?: string;\n  size?: IconSize;\n}\n\nexport const CollapsibleSection = ({\n  label,\n  description,\n  children,\n  className,\n  size = 'xl',\n}: React.PropsWithChildren<Props>) => {\n  const styles = useStyles2(getStyles);\n  const [isCollapsed, setIsCollapsed] = useState(true);\n\n  const toggleCollapse = () => setIsCollapsed(!isCollapsed);\n\n  return (\n    <div className={cx(styles.wrapper, className)}>\n      <CollapseToggle\n        className={styles.toggle}\n        size={size}\n        onToggle={toggleCollapse}\n        isCollapsed={isCollapsed}\n        text={label}\n      />\n      {description && <p className={styles.description}>{description}</p>}\n      <div className={isCollapsed ? styles.hidden : styles.content}>{children}</div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css`\n    margin-top: ${theme.spacing(1)};\n    padding-bottom: ${theme.spacing(1)};\n  `,\n  toggle: css`\n    margin: ${theme.spacing(1, 0)};\n    padding: 0;\n  `,\n  hidden: css`\n    display: none;\n  `,\n  description: css`\n    color: ${theme.colors.text.secondary};\n    font-size: ${theme.typography.size.sm};\n    font-weight: ${theme.typography.fontWeightRegular};\n    margin: 0;\n  `,\n  content: css`\n    padding-left: ${theme.spacing(3)};\n  `,\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nexport const getReceiverFormFieldStyles = (theme: GrafanaTheme2) => ({\n  collapsibleSection: css`\n    margin: 0;\n    padding: 0;\n  `,\n  wrapper: css`\n    margin: ${theme.spacing(2, 0)};\n    padding: ${theme.spacing(1)};\n    border: solid 1px ${theme.colors.border.medium};\n    border-radius: ${theme.shape.borderRadius(1)};\n    position: relative;\n  `,\n  description: css`\n    color: ${theme.colors.text.secondary};\n    font-size: ${theme.typography.size.sm};\n    font-weight: ${theme.typography.fontWeightRegular};\n    margin: 0;\n  `,\n  deleteIcon: css`\n    position: absolute;\n    right: ${theme.spacing(1)};\n    top: ${theme.spacing(1)};\n  `,\n  addButton: css`\n    margin-top: ${theme.spacing(1)};\n  `,\n});\n","import React from 'react';\nimport { FieldError, DeepMap, useFormContext } from 'react-hook-form';\n\nimport { Button, useStyles2 } from '@grafana/ui';\nimport { useControlledFieldArray } from 'app/features/alerting/unified/hooks/useControlledFieldArray';\nimport { NotificationChannelOption } from 'app/types';\n\nimport { ActionIcon } from '../../../rules/ActionIcon';\nimport { CollapsibleSection } from '../CollapsibleSection';\n\nimport { OptionField } from './OptionField';\nimport { getReceiverFormFieldStyles } from './styles';\n\ninterface Props {\n  defaultValues?: any[];\n  option: NotificationChannelOption;\n  pathPrefix: string;\n  errors?: Array<DeepMap<any, FieldError>>;\n  readOnly?: boolean;\n}\n\nexport const SubformArrayField = ({ option, pathPrefix, errors, defaultValues, readOnly = false }: Props) => {\n  const styles = useStyles2(getReceiverFormFieldStyles);\n  const path = `${pathPrefix}${option.propertyName}`;\n  const formAPI = useFormContext();\n  const { fields, append, remove } = useControlledFieldArray({ name: path, formAPI, defaults: defaultValues });\n\n  return (\n    <div className={styles.wrapper}>\n      <CollapsibleSection\n        className={styles.collapsibleSection}\n        label={`${option.label} (${fields.length})`}\n        description={option.description}\n      >\n        {(fields ?? defaultValues ?? []).map((field, itemIndex) => {\n          return (\n            <div key={itemIndex} className={styles.wrapper}>\n              {!readOnly && (\n                <ActionIcon\n                  data-testid={`${path}.${itemIndex}.delete-button`}\n                  icon=\"trash-alt\"\n                  tooltip=\"delete\"\n                  onClick={() => remove(itemIndex)}\n                  className={styles.deleteIcon}\n                />\n              )}\n              {option.subformOptions?.map((option) => (\n                <OptionField\n                  readOnly={readOnly}\n                  defaultValue={field?.[option.propertyName]}\n                  key={option.propertyName}\n                  option={option}\n                  pathPrefix={`${path}.${itemIndex}.`}\n                  error={errors?.[itemIndex]?.[option.propertyName]}\n                />\n              ))}\n            </div>\n          );\n        })}\n        {!readOnly && (\n          <Button\n            data-testid={`${path}.add-button`}\n            className={styles.addButton}\n            type=\"button\"\n            variant=\"secondary\"\n            icon=\"plus\"\n            size=\"sm\"\n            onClick={() => append({ __id: String(Math.random()) })}\n          >\n            Add\n          </Button>\n        )}\n      </CollapsibleSection>\n    </div>\n  );\n};\n","import React, { useState } from 'react';\nimport { FieldError, DeepMap, useFormContext } from 'react-hook-form';\n\nimport { Button, useStyles2 } from '@grafana/ui';\nimport { NotificationChannelOption } from 'app/types';\n\nimport { ActionIcon } from '../../../rules/ActionIcon';\n\nimport { OptionField } from './OptionField';\nimport { getReceiverFormFieldStyles } from './styles';\n\ninterface Props {\n  defaultValue: any;\n  option: NotificationChannelOption;\n  pathPrefix: string;\n  errors?: DeepMap<any, FieldError>;\n  readOnly?: boolean;\n}\n\nexport const SubformField = ({ option, pathPrefix, errors, defaultValue, readOnly = false }: Props) => {\n  const styles = useStyles2(getReceiverFormFieldStyles);\n  const name = `${pathPrefix}${option.propertyName}`;\n  const { watch } = useFormContext();\n  const _watchValue = watch(name);\n  const value = _watchValue === undefined ? defaultValue : _watchValue;\n\n  const [show, setShow] = useState(!!value);\n\n  return (\n    <div className={styles.wrapper} data-testid={`${name}.container`}>\n      <h6>{option.label}</h6>\n      {option.description && <p className={styles.description}>{option.description}</p>}\n      {show && (\n        <>\n          {!readOnly && (\n            <ActionIcon\n              data-testid={`${name}.delete-button`}\n              icon=\"trash-alt\"\n              tooltip=\"delete\"\n              onClick={() => setShow(false)}\n              className={styles.deleteIcon}\n            />\n          )}\n          {(option.subformOptions ?? []).map((subOption) => {\n            return (\n              <OptionField\n                readOnly={readOnly}\n                defaultValue={defaultValue?.[subOption.propertyName]}\n                key={subOption.propertyName}\n                option={subOption}\n                pathPrefix={`${name}.`}\n                error={errors?.[subOption.propertyName]}\n              />\n            );\n          })}\n        </>\n      )}\n      {!show && !readOnly && (\n        <Button\n          className={styles.addButton}\n          type=\"button\"\n          variant=\"secondary\"\n          icon=\"plus\"\n          size=\"sm\"\n          onClick={() => setShow(true)}\n          data-testid={`${name}.add-button`}\n        >\n          Add\n        </Button>\n      )}\n    </div>\n  );\n};\n","import { css } from '@emotion/css';\nimport { isEmpty } from 'lodash';\nimport React, { FC, useEffect } from 'react';\nimport { useFormContext, FieldError, DeepMap } from 'react-hook-form';\n\nimport { Checkbox, Field, Input, InputControl, Select, TextArea } from '@grafana/ui';\nimport { NotificationChannelOption } from 'app/types';\n\nimport { KeyValueMapInput } from './KeyValueMapInput';\nimport { StringArrayInput } from './StringArrayInput';\nimport { SubformArrayField } from './SubformArrayField';\nimport { SubformField } from './SubformField';\n\ninterface Props {\n  defaultValue: any;\n  option: NotificationChannelOption;\n  invalid?: boolean;\n  pathPrefix: string;\n  pathSuffix?: string;\n  error?: FieldError | DeepMap<any, FieldError>;\n  readOnly?: boolean;\n}\n\nexport const OptionField: FC<Props> = ({\n  option,\n  invalid,\n  pathPrefix,\n  pathSuffix = '',\n  error,\n  defaultValue,\n  readOnly = false,\n}) => {\n  const optionPath = `${pathPrefix}${pathSuffix}`;\n\n  if (option.element === 'subform') {\n    return (\n      <SubformField\n        readOnly={readOnly}\n        defaultValue={defaultValue}\n        option={option}\n        errors={error as DeepMap<any, FieldError> | undefined}\n        pathPrefix={optionPath}\n      />\n    );\n  }\n  if (option.element === 'subform_array') {\n    return (\n      <SubformArrayField\n        readOnly={readOnly}\n        defaultValues={defaultValue}\n        option={option}\n        pathPrefix={optionPath}\n        errors={error as Array<DeepMap<any, FieldError>> | undefined}\n      />\n    );\n  }\n  return (\n    <Field\n      label={option.element !== 'checkbox' ? option.label : undefined}\n      description={option.description || undefined}\n      invalid={!!error}\n      error={error?.message}\n    >\n      <OptionInput\n        id={`${optionPath}${option.propertyName}`}\n        defaultValue={defaultValue}\n        option={option}\n        invalid={invalid}\n        pathPrefix={optionPath}\n        readOnly={readOnly}\n        pathIndex={pathPrefix}\n      />\n    </Field>\n  );\n};\n\nconst OptionInput: FC<Props & { id: string; pathIndex?: string }> = ({\n  option,\n  invalid,\n  id,\n  pathPrefix = '',\n  pathIndex = '',\n  readOnly = false,\n}) => {\n  const { control, register, unregister, getValues } = useFormContext();\n  const name = `${pathPrefix}${option.propertyName}`;\n\n  // workaround for https://github.com/react-hook-form/react-hook-form/issues/4993#issuecomment-829012506\n  useEffect(\n    () => () => {\n      unregister(name, { keepValue: false });\n    },\n    [unregister, name]\n  );\n  switch (option.element) {\n    case 'checkbox':\n      return (\n        <Checkbox\n          id={id}\n          readOnly={readOnly}\n          disabled={readOnly}\n          className={styles.checkbox}\n          {...register(name)}\n          label={option.label}\n          description={option.description}\n        />\n      );\n    case 'input':\n      return (\n        <Input\n          id={id}\n          readOnly={readOnly || determineReadOnly(option, getValues, pathIndex)}\n          invalid={invalid}\n          type={option.inputType}\n          {...register(name, {\n            required: determineRequired(option, getValues, pathIndex),\n            validate: (v) => (option.validationRule !== '' ? validateOption(v, option.validationRule) : true),\n            setValueAs: option.setValueAs,\n          })}\n          placeholder={option.placeholder}\n        />\n      );\n\n    case 'select':\n      return (\n        <InputControl\n          render={({ field: { onChange, ref, ...field } }) => (\n            <Select\n              disabled={readOnly}\n              {...field}\n              defaultValue={option.defaultValue}\n              options={option.selectOptions ?? undefined}\n              invalid={invalid}\n              onChange={(value) => onChange(value.value)}\n            />\n          )}\n          control={control}\n          name={name}\n        />\n      );\n\n    case 'textarea':\n      return (\n        <TextArea\n          id={id}\n          readOnly={readOnly}\n          invalid={invalid}\n          placeholder={option.placeholder}\n          {...register(name, {\n            required: option.required ? 'Required' : false,\n            validate: (v) => (option.validationRule !== '' ? validateOption(v, option.validationRule) : true),\n          })}\n        />\n      );\n    case 'string_array':\n      return (\n        <InputControl\n          render={({ field: { value, onChange } }) => (\n            <StringArrayInput readOnly={readOnly} value={value} onChange={onChange} />\n          )}\n          control={control}\n          name={name}\n        />\n      );\n    case 'key_value_map':\n      return (\n        <InputControl\n          render={({ field: { value, onChange } }) => (\n            <KeyValueMapInput readOnly={readOnly} value={value} onChange={onChange} />\n          )}\n          control={control}\n          name={name}\n        />\n      );\n\n    default:\n      console.error('Element not supported', option.element);\n      return null;\n  }\n};\n\nconst styles = {\n  checkbox: css`\n    height: auto; // native checkbox has fixed height which does not take into account description\n  `,\n};\n\nconst validateOption = (value: string, validationRule: string) => {\n  return RegExp(validationRule).test(value) ? true : 'Invalid format';\n};\n\nconst determineRequired = (option: NotificationChannelOption, getValues: any, pathIndex: string) => {\n  if (!option.dependsOn) {\n    return option.required ? 'Required' : false;\n  }\n  if (isEmpty(getValues(`${pathIndex}secureFields`))) {\n    const dependentOn = getValues(`${pathIndex}secureSettings.${option.dependsOn}`);\n    return !Boolean(dependentOn) && option.required ? 'Required' : false;\n  } else {\n    const dependentOn: boolean = getValues(`${pathIndex}secureFields.${option.dependsOn}`);\n    return !dependentOn && option.required ? 'Required' : false;\n  }\n};\n\nconst determineReadOnly = (option: NotificationChannelOption, getValues: any, pathIndex: string) => {\n  if (!option.dependsOn) {\n    return false;\n  }\n  if (isEmpty(getValues(`${pathIndex}secureFields`))) {\n    return getValues(`${pathIndex}secureSettings.${option.dependsOn}`);\n  } else {\n    return getValues(`${pathIndex}secureFields.${option.dependsOn}`);\n  }\n};\n","import React from 'react';\nimport { useFormContext, FieldError, FieldErrors, DeepMap } from 'react-hook-form';\n\nimport { Button, Field, Input } from '@grafana/ui';\nimport { NotificationChannelOption, NotificationChannelSecureFields } from 'app/types';\n\nimport { ChannelValues, ReceiverFormValues } from '../../../types/receiver-form';\n\nimport { OptionField } from './fields/OptionField';\n\nexport interface Props<R extends ChannelValues> {\n  defaultValues: R;\n  selectedChannelOptions: NotificationChannelOption[];\n  secureFields: NotificationChannelSecureFields;\n\n  onResetSecureField: (key: string) => void;\n  errors?: FieldErrors<R>;\n  pathPrefix?: string;\n  readOnly?: boolean;\n}\n\nexport function ChannelOptions<R extends ChannelValues>({\n  defaultValues,\n  selectedChannelOptions,\n  onResetSecureField,\n  secureFields,\n  errors,\n  pathPrefix = '',\n  readOnly = false,\n}: Props<R>): JSX.Element {\n  const { watch } = useFormContext<ReceiverFormValues<R>>();\n  const currentFormValues = watch(); // react hook form types ARE LYING!\n  return (\n    <>\n      {selectedChannelOptions.map((option: NotificationChannelOption, index: number) => {\n        const key = `${option.label}-${index}`;\n        // Some options can be dependent on other options, this determines what is selected in the dependency options\n        // I think this needs more thought.\n        // pathPrefix = items.index.\n        const paths = pathPrefix.split('.');\n        const selectedOptionValue =\n          paths.length >= 2 ? currentFormValues.items[Number(paths[1])].settings[option.showWhen.field] : undefined;\n\n        if (option.showWhen.field && selectedOptionValue !== option.showWhen.is) {\n          return null;\n        }\n\n        if (secureFields && secureFields[option.propertyName]) {\n          return (\n            <Field key={key} label={option.label} description={option.description || undefined}>\n              <Input\n                readOnly={true}\n                value=\"Configured\"\n                suffix={\n                  readOnly ? null : (\n                    <Button onClick={() => onResetSecureField(option.propertyName)} fill=\"text\" type=\"button\" size=\"sm\">\n                      Clear\n                    </Button>\n                  )\n                }\n              />\n            </Field>\n          );\n        }\n\n        const error: FieldError | DeepMap<any, FieldError> | undefined = (\n          (option.secure ? errors?.secureSettings : errors?.settings) as DeepMap<any, FieldError> | undefined\n        )?.[option.propertyName];\n\n        const defaultValue = defaultValues?.settings?.[option.propertyName];\n\n        return (\n          <OptionField\n            defaultValue={defaultValue}\n            readOnly={readOnly}\n            key={key}\n            error={error}\n            pathPrefix={pathPrefix}\n            pathSuffix={option.secure ? 'secureSettings.' : 'settings.'}\n            option={option}\n          />\n        );\n      })}\n    </>\n  );\n}\n","import { css } from '@emotion/css';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { useFormContext, FieldErrors, FieldValues } from 'react-hook-form';\n\nimport { GrafanaTheme2, SelectableValue } from '@grafana/data';\nimport { Alert, Button, Field, InputControl, Select, useStyles2 } from '@grafana/ui';\nimport { NotifierDTO } from 'app/types';\n\nimport { useUnifiedAlertingSelector } from '../../../hooks/useUnifiedAlertingSelector';\nimport { ChannelValues, CommonSettingsComponentType } from '../../../types/receiver-form';\n\nimport { ChannelOptions } from './ChannelOptions';\nimport { CollapsibleSection } from './CollapsibleSection';\n\ninterface Props<R extends FieldValues> {\n  defaultValues: R;\n  pathPrefix: string;\n  notifiers: NotifierDTO[];\n  onDuplicate: () => void;\n  onTest?: () => void;\n  commonSettingsComponent: CommonSettingsComponentType;\n\n  secureFields?: Record<string, boolean>;\n  errors?: FieldErrors<R>;\n  onDelete?: () => void;\n  isEditable?: boolean;\n  isTestable?: boolean;\n}\n\nexport function ChannelSubForm<R extends ChannelValues>({\n  defaultValues,\n  pathPrefix,\n  onDuplicate,\n  onDelete,\n  onTest,\n  notifiers,\n  errors,\n  secureFields,\n  commonSettingsComponent: CommonSettingsComponent,\n  isEditable = true,\n  isTestable,\n}: Props<R>): JSX.Element {\n  const styles = useStyles2(getStyles);\n  const name = (fieldName: string) => `${pathPrefix}${fieldName}`;\n  const { control, watch, register, trigger, formState, setValue } = useFormContext();\n  const selectedType = watch(name('type')) ?? defaultValues.type; // nope, setting \"default\" does not work at all.\n  const { loading: testingReceiver } = useUnifiedAlertingSelector((state) => state.testReceivers);\n\n  useEffect(() => {\n    register(`${pathPrefix}.__id`);\n    /* Need to manually register secureFields or else they'll\n     be lost when testing a contact point */\n    register(`${pathPrefix}.secureFields`);\n  }, [register, pathPrefix]);\n\n  const [_secureFields, setSecureFields] = useState(secureFields ?? {});\n\n  const onResetSecureField = (key: string) => {\n    if (_secureFields[key]) {\n      const updatedSecureFields = { ...secureFields };\n      delete updatedSecureFields[key];\n      setSecureFields(updatedSecureFields);\n      setValue(`${pathPrefix}.secureFields`, updatedSecureFields);\n    }\n  };\n\n  const typeOptions = useMemo(\n    (): SelectableValue[] =>\n      notifiers\n        .map(({ name, type }) => ({\n          label: name,\n          value: type,\n        }))\n        .sort((a, b) => a.label.localeCompare(b.label)),\n    [notifiers]\n  );\n\n  const handleTest = async () => {\n    await trigger();\n    const isValid = Object.keys(formState.errors).length === 0;\n\n    if (isValid && onTest) {\n      onTest();\n    }\n  };\n\n  const notifier = notifiers.find(({ type }) => type === selectedType);\n  // if there are mandatory options defined, optional options will be hidden by a collapse\n  // if there aren't mandatory options, all options will be shown without collapse\n  const mandatoryOptions = notifier?.options.filter((o) => o.required);\n  const optionalOptions = notifier?.options.filter((o) => !o.required);\n\n  const contactPointTypeInputId = `contact-point-type-${pathPrefix}`;\n\n  return (\n    <div className={styles.wrapper} data-testid=\"item-container\">\n      <div className={styles.topRow}>\n        <div>\n          <Field label=\"Integration\" htmlFor={contactPointTypeInputId} data-testid={`${pathPrefix}type`}>\n            <InputControl\n              name={name('type')}\n              defaultValue={defaultValues.type}\n              render={({ field: { ref, onChange, ...field } }) => (\n                <Select\n                  disabled={!isEditable}\n                  inputId={contactPointTypeInputId}\n                  {...field}\n                  width={37}\n                  options={typeOptions}\n                  onChange={(value) => onChange(value?.value)}\n                />\n              )}\n              control={control}\n              rules={{ required: true }}\n            />\n          </Field>\n        </div>\n        <div className={styles.buttons}>\n          {isTestable && onTest && (\n            <Button\n              disabled={testingReceiver}\n              size=\"xs\"\n              variant=\"secondary\"\n              type=\"button\"\n              onClick={() => handleTest()}\n              icon={testingReceiver ? 'fa fa-spinner' : 'message'}\n            >\n              Test\n            </Button>\n          )}\n          {isEditable && (\n            <>\n              <Button size=\"xs\" variant=\"secondary\" type=\"button\" onClick={() => onDuplicate()} icon=\"copy\">\n                Duplicate\n              </Button>\n              {onDelete && (\n                <Button\n                  data-testid={`${pathPrefix}delete-button`}\n                  size=\"xs\"\n                  variant=\"secondary\"\n                  type=\"button\"\n                  onClick={() => onDelete()}\n                  icon=\"trash-alt\"\n                >\n                  Delete\n                </Button>\n              )}\n            </>\n          )}\n        </div>\n      </div>\n      {notifier && (\n        <div className={styles.innerContent}>\n          <ChannelOptions<R>\n            defaultValues={defaultValues}\n            selectedChannelOptions={mandatoryOptions?.length ? mandatoryOptions! : optionalOptions!}\n            secureFields={_secureFields}\n            errors={errors}\n            onResetSecureField={onResetSecureField}\n            pathPrefix={pathPrefix}\n            readOnly={!isEditable}\n          />\n          {!!(mandatoryOptions?.length && optionalOptions?.length) && (\n            <CollapsibleSection label={`Optional ${notifier.name} settings`}>\n              {notifier.info !== '' && (\n                <Alert title=\"\" severity=\"info\">\n                  {notifier.info}\n                </Alert>\n              )}\n              <ChannelOptions<R>\n                defaultValues={defaultValues}\n                selectedChannelOptions={optionalOptions!}\n                secureFields={_secureFields}\n                onResetSecureField={onResetSecureField}\n                errors={errors}\n                pathPrefix={pathPrefix}\n                readOnly={!isEditable}\n              />\n            </CollapsibleSection>\n          )}\n          <CollapsibleSection label=\"Notification settings\">\n            <CommonSettingsComponent pathPrefix={pathPrefix} readOnly={!isEditable} />\n          </CollapsibleSection>\n        </div>\n      )}\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  buttons: css`\n    & > * + * {\n      margin-left: ${theme.spacing(1)};\n    }\n  `,\n  innerContent: css`\n    max-width: 536px;\n  `,\n  wrapper: css`\n    margin: ${theme.spacing(2, 0)};\n    padding: ${theme.spacing(1)};\n    border: solid 1px ${theme.colors.border.medium};\n    border-radius: ${theme.shape.borderRadius(1)};\n    max-width: ${theme.breakpoints.values.xl}${theme.breakpoints.unit};\n  `,\n  topRow: css`\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n  `,\n  channelSettingsHeader: css`\n    margin-top: ${theme.spacing(2)};\n  `,\n});\n","import React, { useEffect } from 'react';\nimport { useFormContext } from 'react-hook-form';\n\ninterface Props {\n  pathPrefix: string;\n}\n\n// we can't drop the deleted item from list entirely because\n// there will be a rece condition with register/unregister calls in react-hook-form\n// and fields will become randomly erroneously unregistered\nexport function DeletedSubForm({ pathPrefix }: Props): JSX.Element {\n  const { register } = useFormContext();\n\n  // required to be registered or react-hook-form will randomly drop the values when it feels like it\n  useEffect(() => {\n    register(`${pathPrefix}.__id`);\n    register(`${pathPrefix}.__deleted`);\n  }, [register, pathPrefix]);\n\n  return <></>;\n}\n","import { omit } from 'lodash';\n\nimport { ChannelValues, ReceiverFormValues } from '../../../types/receiver-form';\n\nexport interface DeprecatedAuthHTTPConfig {\n  bearer_token?: string;\n  bearer_token_file?: string;\n}\n\nexport interface HTTPAuthConfig {\n  authorization: {\n    type: string;\n    credentials?: string;\n    credentials_file?: string;\n  };\n}\n\n// convert the newer http_config to the older (deprecated) format\nexport function normalizeFormValues(\n  values?: ReceiverFormValues<ChannelValues>\n): ReceiverFormValues<ChannelValues> | undefined {\n  if (!values) {\n    return;\n  }\n\n  return {\n    ...values,\n    items: values.items.map((item) => ({\n      ...item,\n      settings: {\n        ...item.settings,\n        http_config: item.settings?.http_config ? normalizeHTTPConfig(item.settings?.http_config) : undefined,\n      },\n    })),\n  };\n}\n\nfunction normalizeHTTPConfig(config: HTTPAuthConfig | DeprecatedAuthHTTPConfig): DeprecatedAuthHTTPConfig {\n  if (isDeprecatedHTTPAuthConfig(config)) {\n    return config;\n  }\n\n  return {\n    ...omit(config, 'authorization'),\n    bearer_token: config.authorization.credentials,\n    bearer_token_file: config.authorization.credentials_file,\n  };\n}\n\nfunction isDeprecatedHTTPAuthConfig(\n  config: HTTPAuthConfig | DeprecatedAuthHTTPConfig\n): config is DeprecatedAuthHTTPConfig {\n  return ['bearer_token', 'bearer_token_file'].some((prop) => prop in config);\n}\n","import { css } from '@emotion/css';\nimport React, { useCallback } from 'react';\nimport { FieldErrors, FormProvider, useForm, Validate } from 'react-hook-form';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Alert, Button, Field, Input, LinkButton, useStyles2 } from '@grafana/ui';\nimport { useAppNotification } from 'app/core/copy/appNotification';\nimport { useCleanup } from 'app/core/hooks/useCleanup';\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\nimport { NotifierDTO } from 'app/types';\n\nimport { useControlledFieldArray } from '../../../hooks/useControlledFieldArray';\nimport { useUnifiedAlertingSelector } from '../../../hooks/useUnifiedAlertingSelector';\nimport { ChannelValues, CommonSettingsComponentType, ReceiverFormValues } from '../../../types/receiver-form';\nimport { makeAMLink } from '../../../utils/misc';\nimport { initialAsyncRequestState } from '../../../utils/redux';\n\nimport { ChannelSubForm } from './ChannelSubForm';\nimport { DeletedSubForm } from './fields/DeletedSubform';\nimport { normalizeFormValues } from './util';\n\ninterface Props<R extends ChannelValues> {\n  config: AlertManagerCortexConfig;\n  notifiers: NotifierDTO[];\n  defaultItem: R;\n  alertManagerSourceName: string;\n  onTestChannel?: (channel: R) => void;\n  onSubmit: (values: ReceiverFormValues<R>) => void;\n  takenReceiverNames: string[]; // will validate that user entered receiver name is not one of these\n  commonSettingsComponent: CommonSettingsComponentType;\n  initialValues?: ReceiverFormValues<R>;\n  isEditable: boolean;\n  isTestable?: boolean;\n}\n\nexport function ReceiverForm<R extends ChannelValues>({\n  config,\n  initialValues,\n  defaultItem,\n  notifiers,\n  alertManagerSourceName,\n  onSubmit,\n  onTestChannel,\n  takenReceiverNames,\n  commonSettingsComponent,\n  isEditable,\n  isTestable,\n}: Props<R>): JSX.Element {\n  const notifyApp = useAppNotification();\n  const styles = useStyles2(getStyles);\n\n  // normalize deprecated and new config values\n  const normalizedConfig = normalizeFormValues(initialValues);\n\n  const defaultValues = normalizedConfig ?? {\n    name: '',\n    items: [\n      {\n        ...defaultItem,\n        __id: String(Math.random()),\n      } as any,\n    ],\n  };\n\n  const formAPI = useForm<ReceiverFormValues<R>>({\n    // making a copy here beacuse react-hook-form will mutate these, and break if the object is frozen. for real.\n    defaultValues: JSON.parse(JSON.stringify(defaultValues)),\n  });\n\n  useCleanup((state) => (state.unifiedAlerting.saveAMConfig = initialAsyncRequestState));\n\n  const { loading } = useUnifiedAlertingSelector((state) => state.saveAMConfig);\n\n  const {\n    handleSubmit,\n    register,\n    formState: { errors },\n    getValues,\n  } = formAPI;\n\n  const { fields, append, remove } = useControlledFieldArray<R>({ name: 'items', formAPI, softDelete: true });\n\n  const validateNameIsAvailable: Validate<string> = useCallback(\n    (name: string) =>\n      takenReceiverNames.map((name) => name.trim().toLowerCase()).includes(name.trim().toLowerCase())\n        ? 'Another receiver with this name already exists.'\n        : true,\n    [takenReceiverNames]\n  );\n\n  const submitCallback = (values: ReceiverFormValues<R>) => {\n    onSubmit({\n      ...values,\n      items: values.items.filter((item) => !item.__deleted),\n    });\n  };\n\n  const onInvalid = () => {\n    notifyApp.error('There are errors in the form. Please correct them and try again!');\n  };\n\n  return (\n    <FormProvider {...formAPI}>\n      {!config.alertmanager_config.route && (\n        <Alert severity=\"warning\" title=\"Attention\">\n          Because there is no default policy configured yet, this contact point will automatically be set as default.\n        </Alert>\n      )}\n      <form onSubmit={handleSubmit(submitCallback, onInvalid)}>\n        <h4 className={styles.heading}>\n          {!isEditable ? 'Contact point' : initialValues ? 'Update contact point' : 'Create contact point'}\n        </h4>\n        <Field label=\"Name\" invalid={!!errors.name} error={errors.name && errors.name.message} required>\n          <Input\n            readOnly={!isEditable}\n            id=\"name\"\n            {...register('name', {\n              required: 'Name is required',\n              validate: { nameIsAvailable: validateNameIsAvailable },\n            })}\n            width={39}\n            placeholder=\"Name\"\n          />\n        </Field>\n        {fields.map((field, index) => {\n          const pathPrefix = `items.${index}.`;\n          if (field.__deleted) {\n            return <DeletedSubForm key={field.__id} pathPrefix={pathPrefix} />;\n          }\n          const initialItem = initialValues?.items.find(({ __id }) => __id === field.__id);\n          return (\n            <ChannelSubForm<R>\n              defaultValues={field}\n              key={field.__id}\n              onDuplicate={() => {\n                const currentValues: R = getValues().items[index];\n                append({ ...currentValues, __id: String(Math.random()) });\n              }}\n              onTest={\n                onTestChannel\n                  ? () => {\n                      const currentValues: R = getValues().items[index];\n                      onTestChannel(currentValues);\n                    }\n                  : undefined\n              }\n              onDelete={() => remove(index)}\n              pathPrefix={pathPrefix}\n              notifiers={notifiers}\n              secureFields={initialItem?.secureFields}\n              errors={errors?.items?.[index] as FieldErrors<R>}\n              commonSettingsComponent={commonSettingsComponent}\n              isEditable={isEditable}\n              isTestable={isTestable}\n            />\n          );\n        })}\n        <>\n          {isEditable && (\n            <Button\n              type=\"button\"\n              icon=\"plus\"\n              variant=\"secondary\"\n              onClick={() => append({ ...defaultItem, __id: String(Math.random()) } as R)}\n            >\n              Add contact point integration\n            </Button>\n          )}\n          <div className={styles.buttons}>\n            {isEditable && (\n              <>\n                {loading && (\n                  <Button disabled={true} icon=\"fa fa-spinner\" variant=\"primary\">\n                    Saving...\n                  </Button>\n                )}\n                {!loading && <Button type=\"submit\">Save contact point</Button>}\n              </>\n            )}\n            <LinkButton\n              disabled={loading}\n              variant=\"secondary\"\n              data-testid=\"cancel-button\"\n              href={makeAMLink('alerting/notifications', alertManagerSourceName)}\n            >\n              Cancel\n            </LinkButton>\n          </div>\n        </>\n      </form>\n    </FormProvider>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  heading: css`\n    margin: ${theme.spacing(4, 0)};\n  `,\n  buttons: css`\n    margin-top: ${theme.spacing(4)};\n\n    & > * + * {\n      margin-left: ${theme.spacing(1)};\n    }\n  `,\n});\n","import React, { useMemo } from 'react';\n\nimport { Alert } from '@grafana/ui';\nimport { AlertManagerCortexConfig, Receiver } from 'app/plugins/datasource/alertmanager/types';\nimport { useDispatch } from 'app/types';\n\nimport { updateAlertManagerConfigAction } from '../../../state/actions';\nimport { CloudChannelValues, ReceiverFormValues, CloudChannelMap } from '../../../types/receiver-form';\nimport { cloudNotifierTypes } from '../../../utils/cloud-alertmanager-notifier-types';\nimport { isVanillaPrometheusAlertManagerDataSource } from '../../../utils/datasource';\nimport {\n  cloudReceiverToFormValues,\n  formValuesToCloudReceiver,\n  updateConfigWithReceiver,\n} from '../../../utils/receiver-form';\n\nimport { CloudCommonChannelSettings } from './CloudCommonChannelSettings';\nimport { ReceiverForm } from './ReceiverForm';\n\ninterface Props {\n  alertManagerSourceName: string;\n  config: AlertManagerCortexConfig;\n  existing?: Receiver;\n}\n\nconst defaultChannelValues: CloudChannelValues = Object.freeze({\n  __id: '',\n  sendResolved: true,\n  secureSettings: {},\n  settings: {},\n  secureFields: {},\n  type: 'email',\n});\n\nexport const CloudReceiverForm = ({ existing, alertManagerSourceName, config }: Props) => {\n  const dispatch = useDispatch();\n  const isVanillaAM = isVanillaPrometheusAlertManagerDataSource(alertManagerSourceName);\n\n  // transform receiver DTO to form values\n  const [existingValue] = useMemo((): [ReceiverFormValues<CloudChannelValues> | undefined, CloudChannelMap] => {\n    if (!existing) {\n      return [undefined, {}];\n    }\n    return cloudReceiverToFormValues(existing, cloudNotifierTypes);\n  }, [existing]);\n\n  const onSubmit = (values: ReceiverFormValues<CloudChannelValues>) => {\n    const newReceiver = formValuesToCloudReceiver(values, defaultChannelValues);\n    dispatch(\n      updateAlertManagerConfigAction({\n        newConfig: updateConfigWithReceiver(config, newReceiver, existing?.name),\n        oldConfig: config,\n        alertManagerSourceName,\n        successMessage: existing ? 'Contact point updated.' : 'Contact point created.',\n        redirectPath: '/alerting/notifications',\n      })\n    );\n  };\n\n  const takenReceiverNames = useMemo(\n    () => config.alertmanager_config.receivers?.map(({ name }) => name).filter((name) => name !== existing?.name) ?? [],\n    [config, existing]\n  );\n\n  // this basically checks if we can manage the selected alert manager data source, either because it's a Grafana Managed one\n  // or a Mimir-based AlertManager\n  const isManageableAlertManagerDataSource = !isVanillaPrometheusAlertManagerDataSource(alertManagerSourceName);\n\n  return (\n    <>\n      {!isVanillaAM && (\n        <Alert title=\"Info\" severity=\"info\">\n          Note that empty string values will be replaced with global defaults where appropriate.\n        </Alert>\n      )}\n      <ReceiverForm<CloudChannelValues>\n        isEditable={isManageableAlertManagerDataSource}\n        isTestable={isManageableAlertManagerDataSource}\n        config={config}\n        onSubmit={onSubmit}\n        initialValues={existingValue}\n        notifiers={cloudNotifierTypes}\n        alertManagerSourceName={alertManagerSourceName}\n        defaultItem={defaultChannelValues}\n        takenReceiverNames={takenReceiverNames}\n        commonSettingsComponent={CloudCommonChannelSettings}\n      />\n    </>\n  );\n};\n","import React from 'react';\nimport { useFormContext } from 'react-hook-form';\n\nimport { Checkbox, Field } from '@grafana/ui';\n\nimport { CommonSettingsComponentProps } from '../../../types/receiver-form';\n\nexport const GrafanaCommonChannelSettings = ({\n  pathPrefix,\n  className,\n  readOnly = false,\n}: CommonSettingsComponentProps) => {\n  const { register } = useFormContext();\n  return (\n    <div className={className}>\n      <Field>\n        <Checkbox\n          {...register(`${pathPrefix}disableResolveMessage`)}\n          label=\"Disable resolved message\"\n          description=\"Disable the resolve message [OK] that is sent when alerting state returns to false\"\n          disabled={readOnly}\n        />\n      </Field>\n    </div>\n  );\n};\n","import { css } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { useForm, FormProvider } from 'react-hook-form';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Modal, Button, Label, useStyles2, RadioButtonGroup } from '@grafana/ui';\nimport { TestReceiversAlert } from 'app/plugins/datasource/alertmanager/types';\nimport { Annotations, Labels } from 'app/types/unified-alerting-dto';\n\nimport AnnotationsField from '../../rule-editor/AnnotationsField';\nimport LabelsField from '../../rule-editor/LabelsField';\n\ninterface Props {\n  isOpen: boolean;\n  onDismiss: () => void;\n  onTest: (alert?: TestReceiversAlert) => void;\n}\n\ntype AnnoField = {\n  key: string;\n  value: string;\n};\n\ninterface FormFields {\n  annotations: AnnoField[];\n  labels: AnnoField[];\n}\n\nenum NotificationType {\n  predefined = 'Predefined',\n  custom = 'Custom',\n}\n\nconst notificationOptions = Object.values(NotificationType).map((value) => ({ label: value, value: value }));\n\nconst defaultValues: FormFields = {\n  annotations: [{ key: '', value: '' }],\n  labels: [{ key: '', value: '' }],\n};\n\nexport const TestContactPointModal = ({ isOpen, onDismiss, onTest }: Props) => {\n  const [notificationType, setNotificationType] = useState<NotificationType>(NotificationType.predefined);\n  const styles = useStyles2(getStyles);\n  const formMethods = useForm<FormFields>({ defaultValues, mode: 'onBlur' });\n\n  const onSubmit = (data: FormFields) => {\n    if (notificationType === NotificationType.custom) {\n      const alert = {\n        annotations: data.annotations\n          .filter(({ key, value }) => !!key && !!value)\n          .reduce((acc, { key, value }) => {\n            return { ...acc, [key]: value };\n          }, {} as Annotations),\n        labels: data.labels\n          .filter(({ key, value }) => !!key && !!value)\n          .reduce((acc, { key, value }) => {\n            return { ...acc, [key]: value };\n          }, {} as Labels),\n      };\n      onTest(alert);\n    } else {\n      onTest();\n    }\n  };\n\n  return (\n    <Modal onDismiss={onDismiss} isOpen={isOpen} title={'Test contact point'}>\n      <div className={styles.section}>\n        <Label>Notification message</Label>\n        <RadioButtonGroup\n          options={notificationOptions}\n          value={notificationType}\n          onChange={(value) => setNotificationType(value)}\n        />\n      </div>\n\n      <FormProvider {...formMethods}>\n        <form onSubmit={formMethods.handleSubmit(onSubmit)}>\n          {notificationType === NotificationType.predefined && (\n            <div className={styles.section}>\n              You will send a test notification that uses a predefined alert. If you have defined a custom template or\n              message, for better results switch to <strong>custom</strong> notification message, from above.\n            </div>\n          )}\n          {notificationType === NotificationType.custom && (\n            <>\n              <div className={styles.section}>\n                You will send a test notification that uses the annotations defined below. This is a good option if you\n                use custom templates and messages.\n              </div>\n              <div className={styles.section}>\n                <AnnotationsField />\n              </div>\n              <div className={styles.section}>\n                <LabelsField />\n              </div>\n            </>\n          )}\n\n          <Modal.ButtonRow>\n            <Button type=\"submit\">Send test notification</Button>\n          </Modal.ButtonRow>\n        </form>\n      </FormProvider>\n    </Modal>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  flexRow: css`\n    display: flex;\n    flex-direction: row;\n    align-items: flex-start;\n    margin-bottom: ${theme.spacing(1)};\n  `,\n  section: css`\n    margin-bottom: ${theme.spacing(2)};\n  `,\n});\n","import React, { useEffect, useMemo, useState } from 'react';\n\nimport { LoadingPlaceholder } from '@grafana/ui';\nimport {\n  AlertManagerCortexConfig,\n  GrafanaManagedReceiverConfig,\n  Receiver,\n  TestReceiversAlert,\n} from 'app/plugins/datasource/alertmanager/types';\nimport { useDispatch } from 'app/types';\n\nimport { useUnifiedAlertingSelector } from '../../../hooks/useUnifiedAlertingSelector';\nimport {\n  fetchGrafanaNotifiersAction,\n  testReceiversAction,\n  updateAlertManagerConfigAction,\n} from '../../../state/actions';\nimport { GrafanaChannelValues, ReceiverFormValues } from '../../../types/receiver-form';\nimport { GRAFANA_RULES_SOURCE_NAME, isVanillaPrometheusAlertManagerDataSource } from '../../../utils/datasource';\nimport {\n  formChannelValuesToGrafanaChannelConfig,\n  formValuesToGrafanaReceiver,\n  grafanaReceiverToFormValues,\n  updateConfigWithReceiver,\n} from '../../../utils/receiver-form';\nimport { ProvisionedResource, ProvisioningAlert } from '../../Provisioning';\n\nimport { GrafanaCommonChannelSettings } from './GrafanaCommonChannelSettings';\nimport { ReceiverForm } from './ReceiverForm';\nimport { TestContactPointModal } from './TestContactPointModal';\n\ninterface Props {\n  alertManagerSourceName: string;\n  config: AlertManagerCortexConfig;\n  existing?: Receiver;\n}\n\nconst defaultChannelValues: GrafanaChannelValues = Object.freeze({\n  __id: '',\n  secureSettings: {},\n  settings: {},\n  secureFields: {},\n  disableResolveMessage: false,\n  type: 'email',\n});\n\nexport const GrafanaReceiverForm = ({ existing, alertManagerSourceName, config }: Props) => {\n  const grafanaNotifiers = useUnifiedAlertingSelector((state) => state.grafanaNotifiers);\n  const [testChannelValues, setTestChannelValues] = useState<GrafanaChannelValues>();\n\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (!(grafanaNotifiers.result || grafanaNotifiers.loading)) {\n      dispatch(fetchGrafanaNotifiersAction());\n    }\n  }, [grafanaNotifiers, dispatch]);\n\n  // transform receiver DTO to form values\n  const [existingValue, id2original] = useMemo((): [\n    ReceiverFormValues<GrafanaChannelValues> | undefined,\n    Record<string, GrafanaManagedReceiverConfig>\n  ] => {\n    if (!existing || !grafanaNotifiers.result) {\n      return [undefined, {}];\n    }\n    return grafanaReceiverToFormValues(existing, grafanaNotifiers.result!);\n  }, [existing, grafanaNotifiers.result]);\n\n  const onSubmit = (values: ReceiverFormValues<GrafanaChannelValues>) => {\n    const newReceiver = formValuesToGrafanaReceiver(values, id2original, defaultChannelValues);\n    dispatch(\n      updateAlertManagerConfigAction({\n        newConfig: updateConfigWithReceiver(config, newReceiver, existing?.name),\n        oldConfig: config,\n        alertManagerSourceName: GRAFANA_RULES_SOURCE_NAME,\n        successMessage: existing ? 'Contact point updated.' : 'Contact point created',\n        redirectPath: '/alerting/notifications',\n      })\n    );\n  };\n\n  const onTestChannel = (values: GrafanaChannelValues) => {\n    setTestChannelValues(values);\n  };\n\n  const testNotification = (alert?: TestReceiversAlert) => {\n    if (testChannelValues) {\n      const existing: GrafanaManagedReceiverConfig | undefined = id2original[testChannelValues.__id];\n      const chan = formChannelValuesToGrafanaChannelConfig(testChannelValues, defaultChannelValues, 'test', existing);\n\n      const payload = {\n        alertManagerSourceName,\n        receivers: [\n          {\n            name: 'test',\n            grafana_managed_receiver_configs: [chan],\n          },\n        ],\n        alert,\n      };\n\n      dispatch(testReceiversAction(payload));\n    }\n  };\n\n  const takenReceiverNames = useMemo(\n    () => config.alertmanager_config.receivers?.map(({ name }) => name).filter((name) => name !== existing?.name) ?? [],\n    [config, existing]\n  );\n\n  // if any receivers in the contact point have a \"provenance\", the entire contact point should be readOnly\n  const hasProvisionedItems = existing\n    ? (existing.grafana_managed_receiver_configs ?? []).some((item) => Boolean(item.provenance))\n    : false;\n\n  // this basically checks if we can manage the selected alert manager data source, either because it's a Grafana Managed one\n  // or a Mimir-based AlertManager\n  const isManageableAlertManagerDataSource = !isVanillaPrometheusAlertManagerDataSource(alertManagerSourceName);\n\n  const isEditable = isManageableAlertManagerDataSource && !hasProvisionedItems;\n  const isTestable = isManageableAlertManagerDataSource || hasProvisionedItems;\n\n  if (grafanaNotifiers.result) {\n    return (\n      <>\n        {hasProvisionedItems && <ProvisioningAlert resource={ProvisionedResource.ContactPoint} />}\n\n        <ReceiverForm<GrafanaChannelValues>\n          isEditable={isEditable}\n          isTestable={isTestable}\n          config={config}\n          onSubmit={onSubmit}\n          initialValues={existingValue}\n          onTestChannel={onTestChannel}\n          notifiers={grafanaNotifiers.result}\n          alertManagerSourceName={alertManagerSourceName}\n          defaultItem={defaultChannelValues}\n          takenReceiverNames={takenReceiverNames}\n          commonSettingsComponent={GrafanaCommonChannelSettings}\n        />\n        <TestContactPointModal\n          onDismiss={() => setTestChannelValues(undefined)}\n          isOpen={!!testChannelValues}\n          onTest={(alert) => testNotification(alert)}\n        />\n      </>\n    );\n  } else {\n    return <LoadingPlaceholder text=\"Loading notifiers...\" />;\n  }\n};\n","import React from 'react';\n\nimport { Alert } from '@grafana/ui';\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\n\nimport { GRAFANA_RULES_SOURCE_NAME } from '../../utils/datasource';\n\nimport { CloudReceiverForm } from './form/CloudReceiverForm';\nimport { GrafanaReceiverForm } from './form/GrafanaReceiverForm';\n\ninterface Props {\n  receiverName: string;\n  config: AlertManagerCortexConfig;\n  alertManagerSourceName: string;\n}\n\nexport const EditReceiverView = ({ config, receiverName, alertManagerSourceName }: Props) => {\n  const receiver = config.alertmanager_config.receivers?.find(({ name }) => name === receiverName);\n  if (!receiver) {\n    return (\n      <Alert severity=\"error\" title=\"Receiver not found\">\n        Sorry, this receiver does not seem to exist.\n      </Alert>\n    );\n  }\n\n  if (alertManagerSourceName === GRAFANA_RULES_SOURCE_NAME) {\n    return <GrafanaReceiverForm config={config} alertManagerSourceName={alertManagerSourceName} existing={receiver} />;\n  } else {\n    return <CloudReceiverForm config={config} alertManagerSourceName={alertManagerSourceName} existing={receiver} />;\n  }\n};\n","import React from 'react';\n\nimport { Alert } from '@grafana/ui';\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\n\nimport { TemplateForm } from './TemplateForm';\n\ninterface Props {\n  templateName: string;\n  config: AlertManagerCortexConfig;\n  alertManagerSourceName: string;\n}\n\nexport const EditTemplateView = ({ config, templateName, alertManagerSourceName }: Props) => {\n  const template = config.template_files?.[templateName];\n  const provenance = config.template_file_provenances?.[templateName];\n\n  if (!template) {\n    return (\n      <Alert severity=\"error\" title=\"Template not found\">\n        Sorry, this template does not seem to exists.\n      </Alert>\n    );\n  }\n  return (\n    <TemplateForm\n      alertManagerSourceName={alertManagerSourceName}\n      config={config}\n      existing={{ name: templateName, content: template }}\n      provenance={provenance}\n    />\n  );\n};\n","import React from 'react';\nimport { useForm, FormProvider } from 'react-hook-form';\n\nimport { Alert, Button, HorizontalGroup, LinkButton } from '@grafana/ui';\nimport { useCleanup } from 'app/core/hooks/useCleanup';\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\nimport { useDispatch } from 'app/types';\n\nimport { useUnifiedAlertingSelector } from '../../hooks/useUnifiedAlertingSelector';\nimport { updateAlertManagerConfigAction } from '../../state/actions';\nimport { globalConfigOptions } from '../../utils/cloud-alertmanager-notifier-types';\nimport { isVanillaPrometheusAlertManagerDataSource } from '../../utils/datasource';\nimport { makeAMLink } from '../../utils/misc';\nimport { omitEmptyValues } from '../../utils/receiver-form';\nimport { initialAsyncRequestState } from '../../utils/redux';\n\nimport { OptionField } from './form/fields/OptionField';\n\ninterface Props {\n  config: AlertManagerCortexConfig;\n  alertManagerSourceName: string;\n}\n\ntype FormValues = Record<string, unknown>;\n\nconst defaultValues: FormValues = {\n  smtp_require_tls: true,\n} as const;\n\nexport const GlobalConfigForm = ({ config, alertManagerSourceName }: Props) => {\n  const dispatch = useDispatch();\n\n  useCleanup((state) => (state.unifiedAlerting.saveAMConfig = initialAsyncRequestState));\n\n  const { loading, error } = useUnifiedAlertingSelector((state) => state.saveAMConfig);\n  const readOnly = isVanillaPrometheusAlertManagerDataSource(alertManagerSourceName);\n\n  const formAPI = useForm<FormValues>({\n    // making a copy here beacuse react-hook-form will mutate these, and break if the object is frozen. for real.\n    defaultValues: JSON.parse(\n      JSON.stringify({\n        ...defaultValues,\n        ...(config.alertmanager_config.global ?? {}),\n      })\n    ),\n  });\n\n  const {\n    handleSubmit,\n    formState: { errors },\n  } = formAPI;\n\n  const onSubmitCallback = (values: FormValues) => {\n    dispatch(\n      updateAlertManagerConfigAction({\n        newConfig: {\n          ...config,\n          alertmanager_config: {\n            ...config.alertmanager_config,\n            global: omitEmptyValues(values),\n          },\n        },\n        oldConfig: config,\n        alertManagerSourceName,\n        successMessage: 'Global config updated.',\n        redirectPath: makeAMLink('/alerting/notifications', alertManagerSourceName),\n      })\n    );\n  };\n\n  return (\n    <FormProvider {...formAPI}>\n      <form onSubmit={handleSubmit(onSubmitCallback)}>\n        {error && (\n          <Alert severity=\"error\" title=\"Error saving receiver\">\n            {error.message || String(error)}\n          </Alert>\n        )}\n        {globalConfigOptions.map((option) => (\n          <OptionField\n            readOnly={readOnly}\n            defaultValue={defaultValues[option.propertyName]}\n            key={option.propertyName}\n            option={option}\n            error={errors[option.propertyName]}\n            pathPrefix={''}\n          />\n        ))}\n        <div>\n          <HorizontalGroup>\n            {!readOnly && (\n              <>\n                {loading && (\n                  <Button disabled={true} icon=\"fa fa-spinner\" variant=\"primary\">\n                    Saving...\n                  </Button>\n                )}\n                {!loading && <Button type=\"submit\">Save global config</Button>}\n              </>\n            )}\n            <LinkButton\n              disabled={loading}\n              fill=\"outline\"\n              variant=\"secondary\"\n              href={makeAMLink('alerting/notifications', alertManagerSourceName)}\n            >\n              Cancel\n            </LinkButton>\n          </HorizontalGroup>\n        </div>\n      </form>\n    </FormProvider>\n  );\n};\n","import React from 'react';\n\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\n\nimport { GRAFANA_RULES_SOURCE_NAME } from '../../utils/datasource';\n\nimport { CloudReceiverForm } from './form/CloudReceiverForm';\nimport { GrafanaReceiverForm } from './form/GrafanaReceiverForm';\n\ninterface Props {\n  config: AlertManagerCortexConfig;\n  alertManagerSourceName: string;\n}\n\nexport const NewReceiverView = ({ alertManagerSourceName, config }: Props) => {\n  if (alertManagerSourceName === GRAFANA_RULES_SOURCE_NAME) {\n    return <GrafanaReceiverForm alertManagerSourceName={alertManagerSourceName} config={config} />;\n  } else {\n    return <CloudReceiverForm alertManagerSourceName={alertManagerSourceName} config={config} />;\n  }\n};\n","import React from 'react';\n\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\n\nimport { TemplateForm } from './TemplateForm';\n\ninterface Props {\n  config: AlertManagerCortexConfig;\n  alertManagerSourceName: string;\n}\n\nexport const NewTemplateView = ({ config, alertManagerSourceName }: Props) => {\n  return <TemplateForm config={config} alertManagerSourceName={alertManagerSourceName} />;\n};\n","export const receiverTypeNames: Record<string, string> = {\n  pagerduty: 'PagerDuty',\n  pushover: 'Pushover',\n  slack: 'Slack',\n  opsgenie: 'OpsGenie',\n  webhook: 'Webhook',\n  victorops: 'VictorOps',\n  wechat: 'WeChat',\n  discord: 'Discord',\n  webex: 'Cisco Webex Teams',\n  sns: 'Amazon SNS',\n  telegram: 'Telegram',\n};\n","import { capitalize } from 'lodash';\n\nimport { receiverTypeNames } from 'app/plugins/datasource/alertmanager/consts';\nimport { GrafanaManagedReceiverConfig, Receiver } from 'app/plugins/datasource/alertmanager/types';\nimport { NotifierDTO } from 'app/types';\n\n// extract notifier type name to count map, eg { Slack: 1, Email: 2 }\n\ntype NotifierTypeCounts = Record<string, number>; // name : count\n\nexport function extractNotifierTypeCounts(receiver: Receiver, grafanaNotifiers: NotifierDTO[]): NotifierTypeCounts {\n  if (receiver['grafana_managed_receiver_configs']) {\n    return getGrafanaNotifierTypeCounts(receiver.grafana_managed_receiver_configs ?? [], grafanaNotifiers);\n  }\n  return getCortexAlertManagerNotifierTypeCounts(receiver);\n}\n\nfunction getCortexAlertManagerNotifierTypeCounts(receiver: Receiver): NotifierTypeCounts {\n  return Object.entries(receiver)\n    .filter(([key]) => key !== 'grafana_managed_receiver_configs' && key.endsWith('_configs')) // filter out only properties that are alertmanager notifier\n    .filter(([_, value]) => Array.isArray(value) && !!value.length) // check that there are actually notifiers of this type configured\n    .reduce<NotifierTypeCounts>((acc, [key, value]) => {\n      const type = key.replace('_configs', ''); // remove the `_config` part from the key, making it intto a notifier name\n      const name = receiverTypeNames[type] ?? capitalize(type);\n      return {\n        ...acc,\n        [name]: (acc[name] ?? 0) + (Array.isArray(value) ? value.length : 1),\n      };\n    }, {});\n}\n\nfunction getGrafanaNotifierTypeCounts(\n  configs: GrafanaManagedReceiverConfig[],\n  grafanaNotifiers: NotifierDTO[]\n): NotifierTypeCounts {\n  return configs\n    .map((recv) => recv.type) // extract types from config\n    .map((type) => grafanaNotifiers.find((r) => r.type === type)?.name ?? capitalize(type)) // get readable name from notifier cofnig, or if not available, just capitalize\n    .reduce<NotifierTypeCounts>(\n      (acc, type) => ({\n        ...acc,\n        [type]: (acc[type] ?? 0) + 1,\n      }),\n      {}\n    );\n}\n","import { css, cx } from '@emotion/css';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { Button, useStyles2 } from '@grafana/ui';\n\ninterface Props {\n  title: string;\n  description: string;\n  addButtonLabel: string;\n  addButtonTo: string;\n  className?: string;\n  showButton?: boolean;\n}\n\nexport const ReceiversSection = ({\n  className,\n  title,\n  description,\n  addButtonLabel,\n  addButtonTo,\n  children,\n  showButton = true,\n}: React.PropsWithChildren<Props>) => {\n  const styles = useStyles2(getStyles);\n  return (\n    <Stack direction=\"column\" gap={2}>\n      <div className={cx(styles.heading, className)}>\n        <div>\n          <h4>{title}</h4>\n          <div className={styles.description}>{description}</div>\n        </div>\n        {showButton && (\n          <Link to={addButtonTo}>\n            <Button type=\"button\" icon=\"plus\">\n              {addButtonLabel}\n            </Button>\n          </Link>\n        )}\n      </div>\n      {children}\n    </Stack>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  heading: css`\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-end;\n  `,\n  description: css`\n    color: ${theme.colors.text.secondary};\n  `,\n});\n","import { Receiver } from '../../../../../../plugins/datasource/alertmanager/types';\nimport { SupportedPlugin } from '../../../types/pluginBridges';\n\nexport interface AmRouteReceiver {\n  label: string;\n  value: string;\n  grafanaAppReceiverType?: SupportedPlugin;\n}\n\nexport interface ReceiverWithTypes extends Receiver {\n  grafanaAppReceiverType?: SupportedPlugin;\n}\nexport const GRAFANA_APP_RECEIVERS_SOURCE_IMAGE: Record<SupportedPlugin, string> = {\n  [SupportedPlugin.OnCall]: 'public/img/alerting/oncall_logo.svg',\n\n  [SupportedPlugin.Incident]: '',\n  [SupportedPlugin.MachineLearning]: '',\n};\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { HorizontalGroup, useStyles2 } from '@grafana/ui';\n\nimport { SupportedPlugin } from '../../../types/pluginBridges';\n\nimport { GRAFANA_APP_RECEIVERS_SOURCE_IMAGE } from './types';\n\nexport const GrafanaAppBadge = ({ grafanaAppType }: { grafanaAppType: SupportedPlugin }) => {\n  const styles = useStyles2(getStyles);\n  return (\n    <div className={styles.wrapper}>\n      <HorizontalGroup align=\"center\" spacing=\"xs\">\n        <img src={GRAFANA_APP_RECEIVERS_SOURCE_IMAGE[grafanaAppType]} alt=\"\" height=\"12px\" />\n        <span>{grafanaAppType}</span>\n      </HorizontalGroup>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css`\n    text-align: left;\n    height: 22px;\n    display: inline-flex;\n    padding: 1px 4px;\n    border-radius: ${theme.shape.borderRadius()};\n    border: 1px solid rgba(245, 95, 62, 1);\n    color: rgba(245, 95, 62, 1);\n    font-weight: ${theme.typography.fontWeightRegular};\n  `,\n});\n","import pluralize from 'pluralize';\nimport React, { useMemo, useState } from 'react';\n\nimport { dateTime, dateTimeFormat } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { Badge, Button, ConfirmModal, Icon, Modal, useStyles2 } from '@grafana/ui';\nimport { contextSrv } from 'app/core/services/context_srv';\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\nimport { AccessControlAction, ContactPointsState, NotifiersState, ReceiversState, useDispatch } from 'app/types';\n\nimport { useGetContactPointsState } from '../../api/receiversApi';\nimport { Authorize } from '../../components/Authorize';\nimport { useUnifiedAlertingSelector } from '../../hooks/useUnifiedAlertingSelector';\nimport { deleteReceiverAction } from '../../state/actions';\nimport { getAlertTableStyles } from '../../styles/table';\nimport { SupportedPlugin } from '../../types/pluginBridges';\nimport { getNotificationsPermissions } from '../../utils/access-control';\nimport { isReceiverUsed } from '../../utils/alertmanager';\nimport { isVanillaPrometheusAlertManagerDataSource } from '../../utils/datasource';\nimport { makeAMLink } from '../../utils/misc';\nimport { extractNotifierTypeCounts } from '../../utils/receivers';\nimport { DynamicTable, DynamicTableColumnProps, DynamicTableItemProps } from '../DynamicTable';\nimport { ProvisioningBadge } from '../Provisioning';\nimport { ActionIcon } from '../rules/ActionIcon';\n\nimport { ReceiversSection } from './ReceiversSection';\nimport { GrafanaAppBadge } from './grafanaAppReceivers/GrafanaAppBadge';\nimport { useGetReceiversWithGrafanaAppTypes } from './grafanaAppReceivers/grafanaApp';\nimport { ReceiverWithTypes } from './grafanaAppReceivers/types';\n\ninterface UpdateActionProps extends ActionProps {\n  onClickDeleteReceiver: (receiverName: string) => void;\n}\n\nfunction UpdateActions({ permissions, alertManagerName, receiverName, onClickDeleteReceiver }: UpdateActionProps) {\n  return (\n    <>\n      <Authorize actions={[permissions.update]}>\n        <ActionIcon\n          aria-label=\"Edit\"\n          data-testid=\"edit\"\n          to={makeAMLink(\n            `/alerting/notifications/receivers/${encodeURIComponent(receiverName)}/edit`,\n            alertManagerName\n          )}\n          tooltip=\"Edit contact point\"\n          icon=\"pen\"\n        />\n      </Authorize>\n      <Authorize actions={[permissions.delete]}>\n        <ActionIcon\n          onClick={() => onClickDeleteReceiver(receiverName)}\n          tooltip=\"Delete contact point\"\n          icon=\"trash-alt\"\n        />\n      </Authorize>\n    </>\n  );\n}\ninterface ActionProps {\n  permissions: {\n    read: AccessControlAction;\n    create: AccessControlAction;\n    update: AccessControlAction;\n    delete: AccessControlAction;\n  };\n  alertManagerName: string;\n  receiverName: string;\n}\n\nfunction ViewAction({ permissions, alertManagerName, receiverName }: ActionProps) {\n  return (\n    <Authorize actions={[permissions.update]}>\n      <ActionIcon\n        data-testid=\"view\"\n        to={makeAMLink(`/alerting/notifications/receivers/${encodeURIComponent(receiverName)}/edit`, alertManagerName)}\n        tooltip=\"View contact point\"\n        icon=\"file-alt\"\n      />\n    </Authorize>\n  );\n}\ninterface ReceiverErrorProps {\n  errorCount: number;\n  errorDetail?: string;\n  showErrorCount: boolean;\n  tooltip?: string;\n}\n\nfunction ReceiverError({ errorCount, errorDetail, showErrorCount, tooltip }: ReceiverErrorProps) {\n  const text = showErrorCount ? `${errorCount} ${pluralize('error', errorCount)}` : 'Error';\n  const tooltipToRender = tooltip ?? errorDetail ?? 'Error';\n\n  return <Badge color=\"red\" icon=\"exclamation-circle\" text={text} tooltip={tooltipToRender} />;\n}\n\ninterface NotifierHealthProps {\n  errorsByNotifier: number;\n  errorDetail?: string;\n  lastNotify: string;\n}\n\nfunction NotifierHealth({ errorsByNotifier, errorDetail, lastNotify }: NotifierHealthProps) {\n  const hasErrors = errorsByNotifier > 0;\n  const noAttempts = isLastNotifyNullDate(lastNotify);\n\n  if (hasErrors) {\n    return <ReceiverError errorCount={errorsByNotifier} errorDetail={errorDetail} showErrorCount={false} />;\n  }\n\n  if (noAttempts) {\n    return <>No attempts</>;\n  }\n\n  return <Badge color=\"green\" text=\"OK\" />;\n}\n\ninterface ReceiverHealthProps {\n  errorsByReceiver: number;\n  someWithNoAttempt: boolean;\n}\n\nfunction ReceiverHealth({ errorsByReceiver, someWithNoAttempt }: ReceiverHealthProps) {\n  const hasErrors = errorsByReceiver > 0;\n\n  if (hasErrors) {\n    return (\n      <ReceiverError\n        errorCount={errorsByReceiver}\n        showErrorCount={true}\n        tooltip=\"Expand the contact point to see error details.\"\n      />\n    );\n  }\n\n  if (someWithNoAttempt) {\n    return <>No attempts</>;\n  }\n\n  return <Badge color=\"green\" text=\"OK\" />;\n}\n\nconst useContactPointsState = (alertManagerName: string) => {\n  const contactPointsState = useGetContactPointsState(alertManagerName);\n  const receivers: ReceiversState = contactPointsState?.receivers ?? {};\n  const errorStateAvailable = Object.keys(receivers).length > 0;\n  return { contactPointsState, errorStateAvailable };\n};\ninterface ReceiverItem {\n  name: string;\n  types: string[];\n  provisioned?: boolean;\n  grafanaAppReceiverType?: SupportedPlugin;\n}\n\ninterface NotifierStatus {\n  lastError?: null | string;\n  lastNotify: string;\n  lastNotifyDuration: string;\n  type: string;\n  sendResolved?: boolean;\n}\n\ntype RowTableColumnProps = DynamicTableColumnProps<ReceiverItem>;\ntype RowItemTableProps = DynamicTableItemProps<ReceiverItem>;\n\ntype NotifierTableColumnProps = DynamicTableColumnProps<NotifierStatus>;\ntype NotifierItemTableProps = DynamicTableItemProps<NotifierStatus>;\n\ninterface NotifiersTableProps {\n  notifiersState: NotifiersState;\n}\nconst isLastNotifyNullDate = (lastNotify: string) => lastNotify === '0001-01-01T00:00:00.000Z';\n\nfunction LastNotify({ lastNotifyDate }: { lastNotifyDate: string }) {\n  if (isLastNotifyNullDate(lastNotifyDate)) {\n    return <>{'-'}</>;\n  } else {\n    return (\n      <Stack alignItems=\"center\">\n        <div>{`${dateTime(lastNotifyDate).locale('en').fromNow(true)} ago`}</div>\n        <Icon name=\"clock-nine\" />\n        <div>{`${dateTimeFormat(lastNotifyDate, { format: 'YYYY-MM-DD HH:mm:ss' })}`}</div>\n      </Stack>\n    );\n  }\n}\n\nconst possibleNullDurations = ['', '0', '0ms', '0s', '0m', '0h', '0d', '0w', '0y'];\nconst durationIsNull = (duration: string) => possibleNullDurations.includes(duration);\n\nfunction NotifiersTable({ notifiersState }: NotifiersTableProps) {\n  function getNotifierColumns(): NotifierTableColumnProps[] {\n    return [\n      {\n        id: 'health',\n        label: 'Health',\n        renderCell: ({ data: { lastError, lastNotify } }) => {\n          return (\n            <NotifierHealth\n              errorsByNotifier={lastError ? 1 : 0}\n              errorDetail={lastError ?? undefined}\n              lastNotify={lastNotify}\n            />\n          );\n        },\n        size: 0.5,\n      },\n      {\n        id: 'name',\n        label: 'Name',\n        renderCell: ({ data: { type }, id }) => <>{`${type}[${id}]`}</>,\n        size: 1,\n      },\n      {\n        id: 'lastNotify',\n        label: 'Last delivery attempt',\n        renderCell: ({ data: { lastNotify } }) => <LastNotify lastNotifyDate={lastNotify} />,\n        size: 3,\n      },\n      {\n        id: 'lastNotifyDuration',\n        label: 'Last duration',\n        renderCell: ({ data: { lastNotify, lastNotifyDuration } }) => (\n          <>{isLastNotifyNullDate(lastNotify) && durationIsNull(lastNotifyDuration) ? '-' : lastNotifyDuration}</>\n        ),\n        size: 1,\n      },\n      {\n        id: 'sendResolved',\n        label: 'Send resolved',\n        renderCell: ({ data: { sendResolved } }) => <>{String(Boolean(sendResolved))}</>,\n        size: 1,\n      },\n    ];\n  }\n  const notifierRows: NotifierItemTableProps[] = Object.entries(notifiersState).flatMap((typeState) =>\n    typeState[1].map((notifierStatus, index) => {\n      return {\n        id: index,\n        data: {\n          type: typeState[0],\n          lastError: notifierStatus.lastNotifyAttemptError,\n          lastNotify: notifierStatus.lastNotifyAttempt,\n          lastNotifyDuration: notifierStatus.lastNotifyAttemptDuration,\n          sendResolved: notifierStatus.sendResolved,\n        },\n      };\n    })\n  );\n\n  return <DynamicTable items={notifierRows} cols={getNotifierColumns()} />;\n}\n\ninterface Props {\n  config: AlertManagerCortexConfig;\n  alertManagerName: string;\n}\n\nexport const ReceiversTable = ({ config, alertManagerName }: Props) => {\n  const dispatch = useDispatch();\n  const isVanillaAM = isVanillaPrometheusAlertManagerDataSource(alertManagerName);\n  const permissions = getNotificationsPermissions(alertManagerName);\n  const grafanaNotifiers = useUnifiedAlertingSelector((state) => state.grafanaNotifiers);\n\n  const { contactPointsState, errorStateAvailable } = useContactPointsState(alertManagerName);\n\n  // receiver name slated for deletion. If this is set, a confirmation modal is shown. If user approves, this receiver is deleted\n  const [receiverToDelete, setReceiverToDelete] = useState<string>();\n  const [showCannotDeleteReceiverModal, setShowCannotDeleteReceiverModal] = useState(false);\n\n  const onClickDeleteReceiver = (receiverName: string): void => {\n    if (isReceiverUsed(receiverName, config)) {\n      setShowCannotDeleteReceiverModal(true);\n    } else {\n      setReceiverToDelete(receiverName);\n    }\n  };\n\n  const deleteReceiver = () => {\n    if (receiverToDelete) {\n      dispatch(deleteReceiverAction(receiverToDelete, alertManagerName));\n    }\n    setReceiverToDelete(undefined);\n  };\n  const receivers = useGetReceiversWithGrafanaAppTypes(config.alertmanager_config.receivers ?? []);\n  const rows: RowItemTableProps[] = useMemo(() => {\n    return (\n      receivers?.map((receiver: ReceiverWithTypes) => ({\n        id: receiver.name,\n        data: {\n          name: receiver.name,\n          types: Object.entries(extractNotifierTypeCounts(receiver, grafanaNotifiers.result ?? [])).map(\n            ([type, count]) => {\n              if (count > 1) {\n                return `${type} (${count})`;\n              }\n              return type;\n            }\n          ),\n          grafanaAppReceiverType: receiver.grafanaAppReceiverType,\n          provisioned: receiver.grafana_managed_receiver_configs?.some((receiver) => receiver.provenance),\n        },\n      })) ?? []\n    );\n  }, [grafanaNotifiers.result, receivers]);\n\n  const columns = useGetColumns(\n    alertManagerName,\n    errorStateAvailable,\n    contactPointsState,\n    onClickDeleteReceiver,\n    permissions,\n    isVanillaAM\n  );\n\n  return (\n    <ReceiversSection\n      title=\"Contact points\"\n      description=\"Define where notifications are sent, for example, email or Slack.\"\n      showButton={!isVanillaAM && contextSrv.hasPermission(permissions.create)}\n      addButtonLabel={'Add contact point'}\n      addButtonTo={makeAMLink('/alerting/notifications/receivers/new', alertManagerName)}\n    >\n      <DynamicTable\n        items={rows}\n        cols={columns}\n        isExpandable={errorStateAvailable}\n        renderExpandedContent={\n          errorStateAvailable\n            ? ({ data: { name } }) => (\n                <NotifiersTable notifiersState={contactPointsState?.receivers[name]?.notifiers ?? {}} />\n              )\n            : undefined\n        }\n      />\n      {!!showCannotDeleteReceiverModal && (\n        <Modal\n          isOpen={true}\n          title=\"Cannot delete contact point\"\n          onDismiss={() => setShowCannotDeleteReceiverModal(false)}\n        >\n          <p>\n            Contact point cannot be deleted because it is used in more policies. Please update or delete these policies\n            first.\n          </p>\n          <Modal.ButtonRow>\n            <Button variant=\"secondary\" onClick={() => setShowCannotDeleteReceiverModal(false)} fill=\"outline\">\n              Close\n            </Button>\n          </Modal.ButtonRow>\n        </Modal>\n      )}\n      {!!receiverToDelete && (\n        <ConfirmModal\n          isOpen={true}\n          title=\"Delete contact point\"\n          body={`Are you sure you want to delete contact point \"${receiverToDelete}\"?`}\n          confirmText=\"Yes, delete\"\n          onConfirm={deleteReceiver}\n          onDismiss={() => setReceiverToDelete(undefined)}\n        />\n      )}\n    </ReceiversSection>\n  );\n};\nconst errorsByReceiver = (contactPointsState: ContactPointsState, receiverName: string) =>\n  contactPointsState?.receivers[receiverName]?.errorCount ?? 0;\n\nconst someNotifiersWithNoAttempt = (contactPointsState: ContactPointsState, receiverName: string) => {\n  const notifiers = Object.values(contactPointsState?.receivers[receiverName]?.notifiers ?? {});\n  const hasSomeWitNoAttempt =\n    notifiers.length === 0 || notifiers.flat().some((status) => isLastNotifyNullDate(status.lastNotifyAttempt));\n  return hasSomeWitNoAttempt;\n};\n\nfunction useGetColumns(\n  alertManagerName: string,\n  errorStateAvailable: boolean,\n  contactPointsState: ContactPointsState | undefined,\n  onClickDeleteReceiver: (receiverName: string) => void,\n  permissions: {\n    read: AccessControlAction;\n    create: AccessControlAction;\n    update: AccessControlAction;\n    delete: AccessControlAction;\n  },\n  isVanillaAM: boolean\n): RowTableColumnProps[] {\n  const tableStyles = useStyles2(getAlertTableStyles);\n  const baseColumns: RowTableColumnProps[] = [\n    {\n      id: 'name',\n      label: 'Contact point name',\n      renderCell: ({ data: { name, provisioned } }) => (\n        <Stack alignItems=\"center\">\n          <div>{name}</div>\n          {provisioned && <ProvisioningBadge />}\n        </Stack>\n      ),\n      size: 1,\n    },\n    {\n      id: 'type',\n      label: 'Type',\n      renderCell: ({ data: { types, grafanaAppReceiverType } }) => (\n        <>{grafanaAppReceiverType ? <GrafanaAppBadge grafanaAppType={grafanaAppReceiverType} /> : types.join(', ')}</>\n      ),\n      size: 1,\n    },\n  ];\n  const healthColumn: RowTableColumnProps = {\n    id: 'health',\n    label: 'Health',\n    renderCell: ({ data: { name } }) => {\n      return (\n        contactPointsState && (\n          <ReceiverHealth\n            errorsByReceiver={errorsByReceiver(contactPointsState, name)}\n            someWithNoAttempt={someNotifiersWithNoAttempt(contactPointsState, name)}\n          />\n        )\n      );\n    },\n    size: 1,\n  };\n\n  return [\n    ...baseColumns,\n    ...(errorStateAvailable ? [healthColumn] : []),\n    {\n      id: 'actions',\n      label: 'Actions',\n      renderCell: ({ data: { provisioned, name } }) => (\n        <Authorize actions={[permissions.update, permissions.delete]}>\n          <div className={tableStyles.actionsCell}>\n            {!isVanillaAM && !provisioned && (\n              <UpdateActions\n                permissions={permissions}\n                alertManagerName={alertManagerName}\n                receiverName={name}\n                onClickDeleteReceiver={onClickDeleteReceiver}\n              />\n            )}\n            {(isVanillaAM || provisioned) && (\n              <ViewAction permissions={permissions} alertManagerName={alertManagerName} receiverName={name} />\n            )}\n          </div>\n        </Authorize>\n      ),\n      size: '100px',\n    },\n  ];\n}\n","import React, { Fragment, useMemo, useState } from 'react';\n\nimport { ConfirmModal, useStyles2 } from '@grafana/ui';\nimport { contextSrv } from 'app/core/services/context_srv';\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\nimport { useDispatch } from 'app/types';\n\nimport { Authorize } from '../../components/Authorize';\nimport { deleteTemplateAction } from '../../state/actions';\nimport { getAlertTableStyles } from '../../styles/table';\nimport { getNotificationsPermissions } from '../../utils/access-control';\nimport { makeAMLink } from '../../utils/misc';\nimport { CollapseToggle } from '../CollapseToggle';\nimport { DetailsField } from '../DetailsField';\nimport { ProvisioningBadge } from '../Provisioning';\nimport { ActionIcon } from '../rules/ActionIcon';\n\nimport { ReceiversSection } from './ReceiversSection';\nimport { TemplateEditor } from './TemplateEditor';\n\ninterface Props {\n  config: AlertManagerCortexConfig;\n  alertManagerName: string;\n}\n\nexport const TemplatesTable = ({ config, alertManagerName }: Props) => {\n  const dispatch = useDispatch();\n  const [expandedTemplates, setExpandedTemplates] = useState<Record<string, boolean>>({});\n  const tableStyles = useStyles2(getAlertTableStyles);\n  const permissions = getNotificationsPermissions(alertManagerName);\n\n  const templateRows = useMemo(() => {\n    const templates = Object.entries(config.template_files);\n\n    return templates.map(([name, template]) => ({\n      name,\n      template,\n      provenance: (config.template_file_provenances ?? {})[name],\n    }));\n  }, [config]);\n  const [templateToDelete, setTemplateToDelete] = useState<string>();\n\n  const deleteTemplate = () => {\n    if (templateToDelete) {\n      dispatch(deleteTemplateAction(templateToDelete, alertManagerName));\n    }\n    setTemplateToDelete(undefined);\n  };\n\n  return (\n    <ReceiversSection\n      title=\"Notification templates\"\n      description=\"Create notification templates to customize your notifications.\"\n      addButtonLabel=\"Add template\"\n      addButtonTo={makeAMLink('/alerting/notifications/templates/new', alertManagerName)}\n      showButton={contextSrv.hasPermission(permissions.create)}\n    >\n      <table className={tableStyles.table} data-testid=\"templates-table\">\n        <colgroup>\n          <col className={tableStyles.colExpand} />\n          <col />\n          <col />\n        </colgroup>\n        <thead>\n          <tr>\n            <th></th>\n            <th>Template</th>\n            <Authorize actions={[permissions.update, permissions.delete]}>\n              <th>Actions</th>\n            </Authorize>\n          </tr>\n        </thead>\n        <tbody>\n          {!templateRows.length && (\n            <tr className={tableStyles.evenRow}>\n              <td colSpan={3}>No templates defined.</td>\n            </tr>\n          )}\n          {templateRows.map(({ name, template, provenance }, idx) => {\n            const isExpanded = !!expandedTemplates[name];\n            return (\n              <Fragment key={name}>\n                <tr key={name} className={idx % 2 === 0 ? tableStyles.evenRow : undefined}>\n                  <td>\n                    <CollapseToggle\n                      isCollapsed={!expandedTemplates[name]}\n                      onToggle={() => setExpandedTemplates({ ...expandedTemplates, [name]: !isExpanded })}\n                    />\n                  </td>\n                  <td>\n                    {name} {provenance && <ProvisioningBadge />}\n                  </td>\n                  <td className={tableStyles.actionsCell}>\n                    {provenance && (\n                      <ActionIcon\n                        to={makeAMLink(\n                          `/alerting/notifications/templates/${encodeURIComponent(name)}/edit`,\n                          alertManagerName\n                        )}\n                        tooltip=\"view template\"\n                        icon=\"file-alt\"\n                      />\n                    )}\n                    {!provenance && (\n                      <Authorize actions={[permissions.update]}>\n                        <ActionIcon\n                          to={makeAMLink(\n                            `/alerting/notifications/templates/${encodeURIComponent(name)}/edit`,\n                            alertManagerName\n                          )}\n                          tooltip=\"edit template\"\n                          icon=\"pen\"\n                        />\n                      </Authorize>\n                    )}\n                    {contextSrv.hasPermission(permissions.create) && (\n                      <ActionIcon\n                        to={makeAMLink(\n                          `/alerting/notifications/templates/${encodeURIComponent(name)}/duplicate`,\n                          alertManagerName\n                        )}\n                        tooltip=\"Copy template\"\n                        icon=\"copy\"\n                      />\n                    )}\n\n                    {!provenance && (\n                      <Authorize actions={[permissions.delete]}>\n                        <ActionIcon\n                          onClick={() => setTemplateToDelete(name)}\n                          tooltip=\"delete template\"\n                          icon=\"trash-alt\"\n                        />\n                      </Authorize>\n                    )}\n                  </td>\n                </tr>\n                {isExpanded && (\n                  <tr className={idx % 2 === 0 ? tableStyles.evenRow : undefined}>\n                    <td></td>\n                    <td colSpan={2}>\n                      <DetailsField label=\"Description\" horizontal={true}>\n                        <TemplateEditor\n                          width={'auto'}\n                          height={'auto'}\n                          autoHeight={true}\n                          value={template}\n                          showLineNumbers={false}\n                          monacoOptions={{\n                            readOnly: true,\n                            scrollBeyondLastLine: false,\n                          }}\n                        />\n                      </DetailsField>\n                    </td>\n                  </tr>\n                )}\n              </Fragment>\n            );\n          })}\n        </tbody>\n      </table>\n\n      {!!templateToDelete && (\n        <ConfirmModal\n          isOpen={true}\n          title=\"Delete template\"\n          body={`Are you sure you want to delete template \"${templateToDelete}\"?`}\n          confirmText=\"Yes, delete\"\n          onConfirm={deleteTemplate}\n          onDismiss={() => setTemplateToDelete(undefined)}\n        />\n      )}\n    </ReceiversSection>\n  );\n};\n","import React from 'react';\n\nimport { Stack } from '@grafana/experimental';\nimport { Alert, LinkButton } from '@grafana/ui';\nimport { AlertManagerCortexConfig } from 'app/plugins/datasource/alertmanager/types';\nimport { AccessControlAction } from 'app/types';\n\nimport { GRAFANA_RULES_SOURCE_NAME, isVanillaPrometheusAlertManagerDataSource } from '../../utils/datasource';\nimport { makeAMLink } from '../../utils/misc';\nimport { Authorize } from '../Authorize';\n\nimport { ReceiversTable } from './ReceiversTable';\nimport { TemplatesTable } from './TemplatesTable';\n\ninterface Props {\n  config: AlertManagerCortexConfig;\n  alertManagerName: string;\n}\n\nexport const ReceiversAndTemplatesView = ({ config, alertManagerName }: Props) => {\n  const isCloud = alertManagerName !== GRAFANA_RULES_SOURCE_NAME;\n  const isVanillaAM = isVanillaPrometheusAlertManagerDataSource(alertManagerName);\n\n  return (\n    <Stack direction=\"column\" gap={4}>\n      <ReceiversTable config={config} alertManagerName={alertManagerName} />\n      {!isVanillaAM && <TemplatesTable config={config} alertManagerName={alertManagerName} />}\n      {isCloud && (\n        <Authorize actions={[AccessControlAction.AlertingNotificationsExternalWrite]}>\n          <Alert severity=\"info\" title=\"Global config for contact points\">\n            <p>\n              For each external Alertmanager you can define global settings, like server addresses, usernames and\n              password, for all the supported contact points.\n            </p>\n            <LinkButton href={makeAMLink('alerting/notifications/global-config', alertManagerName)} variant=\"secondary\">\n              {isVanillaAM ? 'View global config' : 'Edit global config'}\n            </LinkButton>\n          </Alert>\n        </Authorize>\n      )}\n    </Stack>\n  );\n};\n","import { css } from '@emotion/css';\nimport pluralize from 'pluralize';\nimport React, { useEffect } from 'react';\nimport { Redirect, Route, RouteChildrenProps, Switch, useLocation, useParams } from 'react-router-dom';\n\nimport { GrafanaTheme2, NavModelItem } from '@grafana/data';\nimport { Stack } from '@grafana/experimental';\nimport { Alert, Icon, LoadingPlaceholder, useStyles2, withErrorBoundary } from '@grafana/ui';\nimport { useDispatch } from 'app/types';\n\nimport { ContactPointsState } from '../../../types';\n\nimport { useGetContactPointsState } from './api/receiversApi';\nimport { AlertManagerPicker } from './components/AlertManagerPicker';\nimport { AlertingPageWrapper } from './components/AlertingPageWrapper';\nimport { GrafanaAlertmanagerDeliveryWarning } from './components/GrafanaAlertmanagerDeliveryWarning';\nimport { NoAlertManagerWarning } from './components/NoAlertManagerWarning';\nimport { DuplicateTemplateView } from './components/receivers/DuplicateTemplateView';\nimport { EditReceiverView } from './components/receivers/EditReceiverView';\nimport { EditTemplateView } from './components/receivers/EditTemplateView';\nimport { GlobalConfigForm } from './components/receivers/GlobalConfigForm';\nimport { NewReceiverView } from './components/receivers/NewReceiverView';\nimport { NewTemplateView } from './components/receivers/NewTemplateView';\nimport { ReceiversAndTemplatesView } from './components/receivers/ReceiversAndTemplatesView';\nimport { isDuplicating } from './components/receivers/TemplateForm';\nimport { useAlertManagerSourceName } from './hooks/useAlertManagerSourceName';\nimport { useAlertManagersByPermission } from './hooks/useAlertManagerSources';\nimport { useUnifiedAlertingSelector } from './hooks/useUnifiedAlertingSelector';\nimport { fetchAlertManagerConfigAction, fetchGrafanaNotifiersAction } from './state/actions';\nimport { GRAFANA_RULES_SOURCE_NAME } from './utils/datasource';\nimport { initialAsyncRequestState } from './utils/redux';\n\nexport interface NotificationErrorProps {\n  errorCount: number;\n}\n\nfunction NotificationError({ errorCount }: NotificationErrorProps) {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.error} data-testid=\"receivers-notification-error\">\n      <Stack alignItems=\"flex-end\" direction=\"column\" gap={0}>\n        <Stack alignItems=\"center\" gap={1}>\n          <Icon name=\"exclamation-circle\" />\n          <div>{`${errorCount} ${pluralize('error', errorCount)} with contact points`}</div>\n        </Stack>\n        <div>{'Some alert notifications might not be delivered'}</div>\n      </Stack>\n    </div>\n  );\n}\n\ntype PageType = 'receivers' | 'templates' | 'global-config';\n\nconst Receivers = () => {\n  const alertManagers = useAlertManagersByPermission('notification');\n  const [alertManagerSourceName, setAlertManagerSourceName] = useAlertManagerSourceName(alertManagers);\n  const dispatch = useDispatch();\n  const styles = useStyles2(getStyles);\n\n  const { id, type } = useParams<{ id?: string; type?: PageType }>();\n  const location = useLocation();\n  const isRoot = location.pathname.endsWith('/alerting/notifications');\n  const isduplicatingTemplate = isDuplicating(location);\n  const configRequests = useUnifiedAlertingSelector((state) => state.amConfigs);\n\n  const {\n    result: config,\n    loading,\n    error,\n  } = (alertManagerSourceName && configRequests[alertManagerSourceName]) || initialAsyncRequestState;\n\n  const receiverTypes = useUnifiedAlertingSelector((state) => state.grafanaNotifiers);\n\n  const shouldLoadConfig = isRoot || !config;\n  const shouldRenderNotificationStatus = isRoot;\n\n  useEffect(() => {\n    if (alertManagerSourceName && shouldLoadConfig) {\n      dispatch(fetchAlertManagerConfigAction(alertManagerSourceName));\n    }\n  }, [alertManagerSourceName, dispatch, shouldLoadConfig]);\n\n  useEffect(() => {\n    if (\n      alertManagerSourceName === GRAFANA_RULES_SOURCE_NAME &&\n      !(receiverTypes.result || receiverTypes.loading || receiverTypes.error)\n    ) {\n      dispatch(fetchGrafanaNotifiersAction());\n    }\n  }, [alertManagerSourceName, dispatch, receiverTypes]);\n\n  const contactPointsState: ContactPointsState = useGetContactPointsState(alertManagerSourceName ?? '');\n  const integrationsErrorCount = contactPointsState?.errorCount ?? 0;\n\n  const disableAmSelect = !isRoot;\n  let pageNav = getPageNavigationModel(type, id ? decodeURIComponent(id) : undefined, isduplicatingTemplate);\n\n  if (!alertManagerSourceName) {\n    return isRoot ? (\n      <AlertingPageWrapper pageId=\"receivers\" pageNav={pageNav}>\n        <NoAlertManagerWarning availableAlertManagers={alertManagers} />\n      </AlertingPageWrapper>\n    ) : (\n      <Redirect to=\"/alerting/notifications\" />\n    );\n  }\n\n  return (\n    <AlertingPageWrapper pageId=\"receivers\" pageNav={pageNav}>\n      <div className={styles.headingContainer}>\n        <AlertManagerPicker\n          current={alertManagerSourceName}\n          disabled={disableAmSelect}\n          onChange={setAlertManagerSourceName}\n          dataSources={alertManagers}\n        />\n        {shouldRenderNotificationStatus && integrationsErrorCount > 0 && (\n          <NotificationError errorCount={integrationsErrorCount} />\n        )}\n      </div>\n      {error && !loading && (\n        <Alert severity=\"error\" title=\"Error loading Alertmanager config\">\n          {error.message || 'Unknown error.'}\n        </Alert>\n      )}\n      <GrafanaAlertmanagerDeliveryWarning currentAlertmanager={alertManagerSourceName} />\n      {loading && !config && <LoadingPlaceholder text=\"loading configuration...\" />}\n      {config && !error && (\n        <Switch>\n          <Route exact={true} path=\"/alerting/notifications\">\n            <ReceiversAndTemplatesView config={config} alertManagerName={alertManagerSourceName} />\n          </Route>\n          <Route exact={true} path=\"/alerting/notifications/templates/new\">\n            <NewTemplateView config={config} alertManagerSourceName={alertManagerSourceName} />\n          </Route>\n          <Route exact={true} path=\"/alerting/notifications/templates/:name/duplicate\">\n            {({ match }: RouteChildrenProps<{ name: string }>) =>\n              match?.params.name && (\n                <DuplicateTemplateView\n                  alertManagerSourceName={alertManagerSourceName}\n                  config={config}\n                  templateName={decodeURIComponent(match?.params.name)}\n                />\n              )\n            }\n          </Route>\n          <Route exact={true} path=\"/alerting/notifications/templates/:name/edit\">\n            {({ match }: RouteChildrenProps<{ name: string }>) =>\n              match?.params.name && (\n                <EditTemplateView\n                  alertManagerSourceName={alertManagerSourceName}\n                  config={config}\n                  templateName={decodeURIComponent(match?.params.name)}\n                />\n              )\n            }\n          </Route>\n          <Route exact={true} path=\"/alerting/notifications/receivers/new\">\n            <NewReceiverView config={config} alertManagerSourceName={alertManagerSourceName} />\n          </Route>\n          <Route exact={true} path=\"/alerting/notifications/receivers/:name/edit\">\n            {({ match }: RouteChildrenProps<{ name: string }>) =>\n              match?.params.name && (\n                <EditReceiverView\n                  alertManagerSourceName={alertManagerSourceName}\n                  config={config}\n                  receiverName={decodeURIComponent(match?.params.name)}\n                />\n              )\n            }\n          </Route>\n          <Route exact={true} path=\"/alerting/notifications/global-config\">\n            <GlobalConfigForm config={config} alertManagerSourceName={alertManagerSourceName} />\n          </Route>\n        </Switch>\n      )}\n    </AlertingPageWrapper>\n  );\n};\n\nfunction getPageNavigationModel(type: PageType | undefined, id: string | undefined, isDuplicatingTemplates: boolean) {\n  let pageNav: NavModelItem | undefined;\n  if (isDuplicatingTemplates) {\n    return {\n      text: `New template`,\n      subTitle: `Create a new template for your notifications`,\n    };\n  }\n  if (type === 'receivers' || type === 'templates') {\n    const objectText = type === 'receivers' ? 'contact point' : 'notification template';\n    if (id) {\n      pageNav = {\n        text: id,\n        subTitle: `Edit the settings for a specific ${objectText}`,\n      };\n    } else {\n      pageNav = {\n        text: `New ${objectText}`,\n        subTitle: `Create a new ${objectText} for your notifications`,\n      };\n    }\n  } else if (type === 'global-config') {\n    pageNav = {\n      text: 'Global config',\n      subTitle: 'Manage your global configuration',\n    };\n  }\n  return pageNav;\n}\n\nexport default withErrorBoundary(Receivers, { style: 'page' });\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  error: css`\n    color: ${theme.colors.error.text};\n  `,\n  headingContainer: css`\n    display: flex;\n    justify-content: space-between;\n  `,\n});\n","import { ContactPointsState } from 'app/types';\n\nimport { CONTACT_POINTS_STATE_INTERVAL_MS } from '../utils/constants';\n\nimport { alertingApi } from './alertingApi';\nimport { fetchContactPointsState } from './grafana';\n\nexport const receiversApi = alertingApi.injectEndpoints({\n  endpoints: (build) => ({\n    contactPointsState: build.query<ContactPointsState, { amSourceName: string }>({\n      queryFn: async ({ amSourceName }) => {\n        try {\n          const contactPointsState = await fetchContactPointsState(amSourceName);\n          return { data: contactPointsState };\n        } catch (error) {\n          return { error: error };\n        }\n      },\n    }),\n  }),\n});\n\nexport const useGetContactPointsState = (alertManagerSourceName: string) => {\n  const contactPointsStateEmpty: ContactPointsState = { receivers: {}, errorCount: 0 };\n  const { currentData: contactPointsState } = receiversApi.useContactPointsStateQuery(\n    { amSourceName: alertManagerSourceName ?? '' },\n    {\n      skip: !alertManagerSourceName,\n      pollingInterval: CONTACT_POINTS_STATE_INTERVAL_MS,\n    }\n  );\n  return contactPointsState ?? contactPointsStateEmpty;\n};\n","import React from 'react';\n\nimport { contextSrv } from 'app/core/services/context_srv';\nimport { AccessControlAction } from 'app/types';\n\ntype Props = {\n  actions: AccessControlAction[];\n  fallback?: boolean;\n};\n\nexport const Authorize = ({ actions, children, fallback = true }: React.PropsWithChildren<Props>) => {\n  if (actions.some((action) => contextSrv.hasAccess(action, fallback))) {\n    return <>{children}</>;\n  } else {\n    return null;\n  }\n};\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data/src';\nimport { Alert, useStyles2 } from '@grafana/ui/src';\n\nimport { AlertmanagerChoice } from '../../../../plugins/datasource/alertmanager/types';\nimport { alertmanagerApi } from '../api/alertmanagerApi';\nimport { GRAFANA_RULES_SOURCE_NAME } from '../utils/datasource';\n\ninterface GrafanaAlertmanagerDeliveryWarningProps {\n  currentAlertmanager: string;\n}\n\nexport function GrafanaAlertmanagerDeliveryWarning({ currentAlertmanager }: GrafanaAlertmanagerDeliveryWarningProps) {\n  const styles = useStyles2(getStyles);\n\n  const { useGetAlertmanagerChoiceStatusQuery } = alertmanagerApi;\n  const { currentData: amChoiceStatus } = useGetAlertmanagerChoiceStatusQuery();\n\n  const viewingInternalAM = currentAlertmanager === GRAFANA_RULES_SOURCE_NAME;\n\n  const interactsWithExternalAMs =\n    amChoiceStatus?.alertmanagersChoice &&\n    [AlertmanagerChoice.External, AlertmanagerChoice.All].includes(amChoiceStatus?.alertmanagersChoice);\n\n  if (!interactsWithExternalAMs || !viewingInternalAM) {\n    return null;\n  }\n\n  const hasActiveExternalAMs = amChoiceStatus.numExternalAlertmanagers > 0;\n\n  if (amChoiceStatus.alertmanagersChoice === AlertmanagerChoice.External) {\n    return (\n      <Alert title=\"Grafana alerts are not delivered to Grafana Alertmanager\">\n        Grafana is configured to send alerts to external Alertmanagers only. Changing Grafana Alertmanager configuration\n        will not affect delivery of your alerts.\n        <div className={styles.adminHint}>\n          To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your\n          Administrator.\n        </div>\n      </Alert>\n    );\n  }\n\n  if (amChoiceStatus.alertmanagersChoice === AlertmanagerChoice.All && hasActiveExternalAMs) {\n    return (\n      <Alert title=\"You have additional Alertmanagers to configure\" severity=\"warning\">\n        Ensure you make configuration changes in the correct Alertmanagers; both internal and external. Changing one\n        will not affect the others.\n        <div className={styles.adminHint}>\n          To change your Alertmanager setup, go to the Alerting Admin page. If you do not have access, contact your\n          Administrator.\n        </div>\n      </Alert>\n    );\n  }\n\n  return null;\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  adminHint: css`\n    font-size: ${theme.typography.bodySmall.fontSize};\n    font-weight: ${theme.typography.bodySmall.fontWeight};\n  `,\n});\n","import React from 'react';\n\nimport { Alert } from '@grafana/ui';\n\nimport { useAlertManagerSourceName } from '../hooks/useAlertManagerSourceName';\nimport { AlertManagerDataSource } from '../utils/datasource';\n\nimport { AlertManagerPicker } from './AlertManagerPicker';\n\ninterface Props {\n  availableAlertManagers: AlertManagerDataSource[];\n}\n\nconst NoAlertManagersAvailable = () => (\n  <Alert title=\"No Alertmanager found\" severity=\"warning\">\n    We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager.\n  </Alert>\n);\n\nconst OtherAlertManagersAvailable = () => (\n  <Alert title=\"Selected Alertmanager not found. Select a different Alertmanager.\" severity=\"warning\">\n    Selected Alertmanager no longer exists or you may not have permission to access it.\n  </Alert>\n);\n\nexport const NoAlertManagerWarning = ({ availableAlertManagers }: Props) => {\n  const [_, setAlertManagerSourceName] = useAlertManagerSourceName(availableAlertManagers);\n  const hasOtherAMs = availableAlertManagers.length > 0;\n\n  return (\n    <div>\n      {hasOtherAMs ? (\n        <>\n          <AlertManagerPicker onChange={setAlertManagerSourceName} dataSources={availableAlertManagers} />\n          <OtherAlertManagersAvailable />\n        </>\n      ) : (\n        <NoAlertManagersAvailable />\n      )}\n    </div>\n  );\n};\n","import React from 'react';\n\nimport { Alert, Badge } from '@grafana/ui';\n\nexport enum ProvisionedResource {\n  ContactPoint = 'contact point',\n  Template = 'template',\n  MuteTiming = 'mute timing',\n  AlertRule = 'alert rule',\n  RootNotificationPolicy = 'root notification policy',\n}\n\ninterface ProvisioningAlertProps {\n  resource: ProvisionedResource;\n}\n\nexport const ProvisioningAlert = ({ resource }: ProvisioningAlertProps) => {\n  return (\n    <Alert title={`This ${resource} cannot be edited through the UI`} severity=\"info\">\n      This {resource} has been provisioned, that means it was created by config. Please contact your server admin to\n      update this {resource}.\n    </Alert>\n  );\n};\n\nexport const ProvisioningBadge = () => {\n  return <Badge text={'Provisioned'} color={'purple'} />;\n};\n","import { lastValueFrom } from 'rxjs';\n\nimport { getBackendSrv } from '@grafana/runtime';\n\nimport { alertingApi } from './alertingApi';\nexport interface OnCallIntegration {\n  integration_url: string;\n}\nexport type OnCallIntegrationsResponse = OnCallIntegration[];\nexport type OnCallIntegrationsUrls = string[];\n\nexport const onCallApi = alertingApi.injectEndpoints({\n  endpoints: (build) => ({\n    getOnCallIntegrations: build.query<OnCallIntegrationsUrls, void>({\n      queryFn: async () => {\n        const integrations = await fetchOnCallIntegrations();\n        return { data: integrations };\n      },\n    }),\n  }),\n});\nexport async function fetchOnCallIntegrations(): Promise<OnCallIntegrationsUrls> {\n  try {\n    const response = await lastValueFrom(\n      getBackendSrv().fetch<OnCallIntegrationsResponse>({\n        url: '/api/plugin-proxy/grafana-oncall-app/api/internal/v1/alert_receive_channels/',\n        showErrorAlert: false,\n        showSuccessAlert: false,\n      })\n    );\n    return response.data.map((result) => result.integration_url);\n  } catch (error) {\n    return [];\n  }\n}\nexport const { useGetOnCallIntegrationsQuery } = onCallApi;\n","import { Receiver } from 'app/plugins/datasource/alertmanager/types';\n\nexport const isInOnCallIntegrations = (url: string, integrationsUrls: string[]) => {\n  return integrationsUrls.includes(url);\n};\n\nexport const isOnCallReceiver = (receiver: Receiver, integrationsUrls: string[]) => {\n  if (!receiver.grafana_managed_receiver_configs) {\n    return false;\n  }\n  // A receiver it's an onCall contact point if it includes only one integration, and this integration it's an onCall\n  // An integration it's an onCall type if it's included in the list of integrations returned by the onCall api endpoint\n  const onlyOneIntegration = receiver.grafana_managed_receiver_configs.length === 1;\n  const isOncall = isInOnCallIntegrations(\n    receiver.grafana_managed_receiver_configs[0]?.settings?.url ?? '',\n    integrationsUrls\n  );\n  return onlyOneIntegration && isOncall;\n};\n","import { Receiver } from 'app/plugins/datasource/alertmanager/types';\n\nimport { useGetOnCallIntegrationsQuery } from '../../../api/onCallApi';\nimport { usePluginBridge } from '../../../hooks/usePluginBridge';\nimport { SupportedPlugin } from '../../../types/pluginBridges';\n\nimport { isOnCallReceiver } from './onCall/onCall';\nimport { AmRouteReceiver, ReceiverWithTypes } from './types';\n\nexport const useGetGrafanaReceiverTypeChecker = () => {\n  const { installed: isOnCallEnabled } = usePluginBridge(SupportedPlugin.OnCall);\n  const { data } = useGetOnCallIntegrationsQuery(undefined, {\n    skip: !isOnCallEnabled,\n  });\n  const getGrafanaReceiverType = (receiver: Receiver): SupportedPlugin | undefined => {\n    //CHECK FOR ONCALL PLUGIN\n    const onCallIntegrations = data ?? [];\n    if (isOnCallEnabled && isOnCallReceiver(receiver, onCallIntegrations)) {\n      return SupportedPlugin.OnCall;\n    }\n    //WE WILL ADD IN HERE IF THERE ARE MORE TYPES TO CHECK\n    return undefined;\n  };\n  return getGrafanaReceiverType;\n};\n\nexport const useGetAmRouteReceiverWithGrafanaAppTypes = (receivers: Receiver[]) => {\n  const getGrafanaReceiverType = useGetGrafanaReceiverTypeChecker();\n  const receiverToSelectableContactPointValue = (receiver: Receiver): AmRouteReceiver => {\n    const amRouteReceiverValue: AmRouteReceiver = {\n      label: receiver.name,\n      value: receiver.name,\n      grafanaAppReceiverType: getGrafanaReceiverType(receiver),\n    };\n    return amRouteReceiverValue;\n  };\n\n  return receivers.map(receiverToSelectableContactPointValue);\n};\n\nexport const useGetReceiversWithGrafanaAppTypes = (receivers: Receiver[]): ReceiverWithTypes[] => {\n  const getGrafanaReceiverType = useGetGrafanaReceiverTypeChecker();\n  return receivers.map((receiver: Receiver) => {\n    return {\n      ...receiver,\n      grafanaAppReceiverType: getGrafanaReceiverType(receiver),\n    };\n  });\n};\n","import React from 'react';\n\nimport { IconName, Tooltip, LinkButton, Button } from '@grafana/ui';\nimport { PopoverContent, TooltipPlacement } from '@grafana/ui/src/components/Tooltip';\n\ninterface Props {\n  tooltip: PopoverContent;\n  icon: IconName;\n  className?: string;\n  tooltipPlacement?: TooltipPlacement;\n  to?: string;\n  target?: string;\n  onClick?: () => void;\n  'data-testid'?: string;\n}\n\nexport const ActionIcon = ({\n  tooltip,\n  icon,\n  to,\n  target,\n  onClick,\n  className,\n  tooltipPlacement = 'top',\n  ...rest\n}: Props) => {\n  const ariaLabel = typeof tooltip === 'string' ? tooltip : undefined;\n\n  return (\n    <Tooltip content={tooltip} placement={tooltipPlacement}>\n      {to ? (\n        <LinkButton\n          variant=\"secondary\"\n          fill=\"text\"\n          icon={icon}\n          href={to}\n          size=\"sm\"\n          target={target}\n          {...rest}\n          aria-label={ariaLabel}\n        />\n      ) : (\n        <Button\n          className={className}\n          variant=\"secondary\"\n          fill=\"text\"\n          size=\"sm\"\n          icon={icon}\n          type=\"button\"\n          onClick={onClick}\n          {...rest}\n          aria-label={ariaLabel}\n        />\n      )}\n    </Tooltip>\n  );\n};\n","import { isEqual, uniqBy } from 'lodash';\n\nimport { GrafanaAlertStateWithReason } from 'app/types/unified-alerting-dto';\n\nexport interface Line {\n  previous: GrafanaAlertStateWithReason;\n  current: GrafanaAlertStateWithReason;\n  values?: Record<string, number>;\n  labels?: Record<string, string>;\n}\n\nexport interface LogRecord {\n  timestamp: number;\n  line: Line;\n}\n\nexport type Label = [string, string];\n\n// omit \"common\" labels from \"labels\"\nexport function omitLabels(labels: Label[], common: Label[]): Label[] {\n  return labels.filter((label) => {\n    return !common.find((commonLabel) => JSON.stringify(commonLabel) === JSON.stringify(label));\n  });\n}\n\n// find all common labels by looking at which ones occur in every record, then create a unique array of items for those\nexport function extractCommonLabels(labels: Label[][]): Label[] {\n  const flatLabels = labels.flatMap((label) => label);\n\n  const commonLabels = uniqBy(\n    flatLabels.filter((label) => {\n      const count = flatLabels.filter((l) => isEqual(label, l)).length;\n      return count === Object.keys(labels).length;\n    }),\n    (label) => JSON.stringify(label)\n  );\n\n  return commonLabels;\n}\n","import { useCallback } from 'react';\n\nimport { useQueryParams } from 'app/core/hooks/useQueryParams';\nimport store from 'app/core/store';\n\nimport { ALERTMANAGER_NAME_LOCAL_STORAGE_KEY, ALERTMANAGER_NAME_QUERY_KEY } from '../utils/constants';\nimport { AlertManagerDataSource, GRAFANA_RULES_SOURCE_NAME } from '../utils/datasource';\n\nfunction useIsAlertManagerAvailable(availableAlertManagers: AlertManagerDataSource[]) {\n  return useCallback(\n    (alertManagerName: string) => {\n      const availableAlertManagersNames = availableAlertManagers.map((am) => am.name);\n      return availableAlertManagersNames.includes(alertManagerName);\n    },\n    [availableAlertManagers]\n  );\n}\n\n/* This will return am name either from query params or from local storage or a default (grafana).\n * Due to RBAC permissions Grafana Managed Alert manager or external alert managers may not be available\n * In the worst case neither GMA nor external alert manager is available\n */\nexport function useAlertManagerSourceName(\n  availableAlertManagers: AlertManagerDataSource[]\n): [string | undefined, (alertManagerSourceName: string) => void] {\n  const [queryParams, updateQueryParams] = useQueryParams();\n  const isAlertManagerAvailable = useIsAlertManagerAvailable(availableAlertManagers);\n\n  const update = useCallback(\n    (alertManagerSourceName: string) => {\n      if (!isAlertManagerAvailable(alertManagerSourceName)) {\n        return;\n      }\n      if (alertManagerSourceName === GRAFANA_RULES_SOURCE_NAME) {\n        store.delete(ALERTMANAGER_NAME_LOCAL_STORAGE_KEY);\n        updateQueryParams({ [ALERTMANAGER_NAME_QUERY_KEY]: null });\n      } else {\n        store.set(ALERTMANAGER_NAME_LOCAL_STORAGE_KEY, alertManagerSourceName);\n        updateQueryParams({ [ALERTMANAGER_NAME_QUERY_KEY]: alertManagerSourceName });\n      }\n    },\n    [updateQueryParams, isAlertManagerAvailable]\n  );\n\n  const querySource = queryParams[ALERTMANAGER_NAME_QUERY_KEY];\n\n  if (querySource && typeof querySource === 'string') {\n    if (isAlertManagerAvailable(querySource)) {\n      return [querySource, update];\n    } else {\n      // non existing alertmanager\n      return [undefined, update];\n    }\n  }\n\n  const storeSource = store.get(ALERTMANAGER_NAME_LOCAL_STORAGE_KEY);\n  if (storeSource && typeof storeSource === 'string' && isAlertManagerAvailable(storeSource)) {\n    update(storeSource);\n    return [storeSource, update];\n  }\n\n  if (isAlertManagerAvailable(GRAFANA_RULES_SOURCE_NAME)) {\n    return [GRAFANA_RULES_SOURCE_NAME, update];\n  }\n\n  return [undefined, update];\n}\n","import { useMemo } from 'react';\n\nimport { getAlertManagerDataSourcesByPermission } from '../utils/datasource';\n\nexport function useAlertManagersByPermission(accessType: 'instance' | 'notification') {\n  return useMemo(() => getAlertManagerDataSourcesByPermission(accessType), [accessType]);\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nexport const getAlertTableStyles = (theme: GrafanaTheme2) => ({\n  table: css`\n    width: 100%;\n    border-radius: ${theme.shape.borderRadius()};\n    border: solid 1px ${theme.colors.border.weak};\n    background-color: ${theme.colors.background.secondary};\n\n    th {\n      padding: ${theme.spacing(1)};\n    }\n\n    td {\n      padding: 0 ${theme.spacing(1)};\n    }\n\n    tr {\n      height: 38px;\n    }\n  `,\n  evenRow: css`\n    background-color: ${theme.colors.background.primary};\n  `,\n  colExpand: css`\n    width: 36px;\n  `,\n  actionsCell: css`\n    text-align: right;\n    width: 1%;\n    white-space: nowrap;\n\n    & > * + * {\n      margin-left: ${theme.spacing(0.5)};\n    }\n  `,\n});\n","export function generateCopiedName(originalName: string, exisitingNames: string[]) {\n  const nonDuplicateName = originalName.replace(/\\(copy( [0-9]+)?\\)$/, '').trim();\n\n  let newName = `${nonDuplicateName} (copy)`;\n\n  for (let i = 2; exisitingNames.includes(newName); i++) {\n    newName = `${nonDuplicateName} (copy ${i})`;\n  }\n\n  return newName;\n}\n"],"names":["navModel","notifications","setNotifications","getNotifications","state","fetchNotifications","res","deleteNotification","id","deleteNotificationConfirmed","notification","ensureDefine","templateName","templateContent","content","indentedContent","line","updateDefinesWithUniqueValue","getNewValue","match_","originalDefineName","subDays","dirtyDate","dirtyAmount","requiredArgs","amount","toInteger","addDays","previewTemplateUrl","templatesApi","alertingApi","build","template","alerts","name","usePreviewTemplateMutation","AlertInstanceModalSelector","onSelect","isOpen","onClose","styles","getStyles","selectedRule","setSelectedRule","selectedInstances","setSelectedInstances","useGetAlertmanagerAlertsQuery","alertmanagerApi","result","loading","error","ruleFilter","setRuleFilter","rulesWithInstances","rules","instance","handleRuleChange","rule","filteredRules","filteredRulesObject","filteredRulesKeys","RuleRow","index","style","ruleName","isSelected","Icon","getAlertUniqueLabels","allAlerts","currentAlert","labelsAsArray","alert","ruleCommonLabels","alertUniqueLabels","labels","InstanceRow","tags","handleSelectInstances","Tooltip","tag","Tag","handleConfirm","instances","resetState","handleSearchRules","onDismiss","filter","Modal","FilterInput","LoadingPlaceholder","height","width","Button","theme","clearButton","GlobalTemplateData","AlertTemplatePreviewData","AlertTemplateData","KeyValueTemplateFunctions","KeyValueCodeSnippet","TemplateDataDocs","getTemplateDataDocsStyles","AlertTemplateDataTable","TemplateDataTable","type","HoverCard","KeyValueTemplateDataTable","dataItems","caption","typeRenderer","getTemplateDataTableStyles","notes","tableStyles","args","returns","defaultValues","GenerateAlertDataModal","onAccept","setAlerts","formMethods","annotations","status","setStatus","onAdd","key","value","acc","onSubmit","labelsOrAnnotationsAdded","someLabels","lb","someAnnotations","ann","alertOptions","e","Card","AnnotationsField","LabelsField","RadioButtonGroup","RESET_TO_DEFAULT","PayloadEditor","payload","setPayload","defaultPayload","setPayloadFormatError","payloadFormatError","onPayloadError","onReset","isEditingAlertData","setIsEditingAlertData","onCloseEditAlertModal","errorInPayloadJson","validatePayload","payloadObj","onOpenEditAlertModal","onOpenAlertSelectorModal","setIsAlertSelectorOpen","onAddAlertList","isAlertSelectorOpen","CodeEditor","Badge","getAlertManagerSuggestions","monaco","kind","alertsLoopSnippet","alertDetailsSnippet","groupLabelsLoopSnippet","getKeyValueTemplate","commonLabelsLoopSnippet","commonAnnotationsLoopSnippet","labelsLoopSnippet","annotationsLoopSnippet","arrayName","getGlobalSuggestions","getAlertSuggestions","getAlertsSuggestions","getKeyValueSuggestions","snippets","getSnippetsSuggestions","snippetKind","snippetInsertRule","alertDetails","groupLabels","commonLabels","commonAnnotations","registerGoTemplateAutocomplete","goTemplateAutocompleteProvider","model","position","context","word","range","completionProvider","CompletionProvider","isInsideGoExpression","wordBeforeDot","searchRange","goSyntaxRegex","match","wordContext","definition","buildAutocompleteSuggestion","label","detail","documentation","insertText","insertFallback","labelObject","GO_TEMPLATE_LANGUAGE_ID","registerLanguage","language","loader","l","monarch","TemplateEditor","props","shouldAutoHeight","disposeSuggestions","onEditorDidMount","editor","contentHeight","defaults","isDuplicating","location","DEFAULT_PAYLOAD","TemplateForm","existing","alertManagerSourceName","config","provenance","dispatch","useCleanup","useUnifiedAlertingSelector","isduplicating","view","setView","submit","values","template_files","templates","newConfig","formApi","handleSubmit","register","errors","getValues","setValue","watch","validateNameIsUnique","isGrafanaAlertManager","Alert","Provisioning","FieldSet","Field","Input","TemplatingGuideline","TabsBar","Tab","TemplatePreview","CollapsableSection","s","getResultsToRender","results","filteredResults","moreThanOne","preview","previewForLabel","separatorStart","separatorEnd","getErrorsToRender","PREVIEW_NOT_AVAILABLE","getPreviewTorender","isPreviewError","data","previewErrorRequest","somethingWasWrong","errorToRender","previewResponseResults","previewResponseErrors","previewResultsToRender","previewErrorsToRender","trigger","isLoading","previewToRender","onPreview","alertList","Spinner","DuplicateTemplateView","duplicatedName","propertyName","description","rest","basicAuthOption","tlsConfigOption","httpConfigOption","cloudNotifierTypes","globalConfigOptions","grafanaReceiverToFormValues","receiver","notifiers","channelMap","idCounter","channel","notifier","grafanaChannelConfigToFormChannelValues","cloudReceiverToFormValues","items","configs","cloudChannelConfigToFormChannelValues","formValuesToGrafanaReceiver","defaultChannelValues","channelValues","formChannelValuesToGrafanaChannelConfig","formValuesToCloudReceiver","recv","__id","settings","sendResolved","omitEmptyValues","configsKey","updateConfigWithReceiver","replaceReceiverName","oldReceivers","updated","existingReceiver","renameReceiverInRoute","route","oldName","newName","option","obj","CloudCommonChannelSettings","pathPrefix","className","readOnly","Checkbox","EMPTY_ARRAY","useControlledFieldArray","options","formAPI","softDelete","reset","fields","update","updateFn","newItems","KeyValueMapInput","onChange","pairs","setPairs","recordToPairs","emitChange","pairsToRecord","deleteItem","newPairs","removed","updatePair","old","pair","i","ActionIcon","record","StringArrayInput","newValue","updateValue","itemValue","v","CollapsibleSection","children","size","isCollapsed","setIsCollapsed","toggleCollapse","CollapseToggle","getReceiverFormFieldStyles","SubformArrayField","path","append","remove","field","itemIndex","OptionField","SubformField","defaultValue","_watchValue","show","setShow","subOption","invalid","pathSuffix","optionPath","OptionInput","pathIndex","control","unregister","determineReadOnly","determineRequired","validateOption","InputControl","ref","Select","TextArea","validationRule","dependentOn","ChannelOptions","selectedChannelOptions","onResetSecureField","secureFields","currentFormValues","paths","selectedOptionValue","ChannelSubForm","onDuplicate","onDelete","onTest","CommonSettingsComponent","isEditable","isTestable","fieldName","formState","selectedType","testingReceiver","_secureFields","setSecureFields","updatedSecureFields","typeOptions","a","b","handleTest","mandatoryOptions","o","optionalOptions","contactPointTypeInputId","DeletedSubForm","normalizeFormValues","item","normalizeHTTPConfig","isDeprecatedHTTPAuthConfig","prop","ReceiverForm","initialValues","defaultItem","onTestChannel","takenReceiverNames","commonSettingsComponent","notifyApp","validateNameIsAvailable","submitCallback","onInvalid","initialItem","currentValues","CloudReceiverForm","isVanillaAM","existingValue","newReceiver","isManageableAlertManagerDataSource","GrafanaCommonChannelSettings","NotificationType","notificationOptions","TestContactPointModal","notificationType","setNotificationType","Label","GrafanaReceiverForm","grafanaNotifiers","testChannelValues","setTestChannelValues","id2original","testNotification","chan","hasProvisionedItems","EditReceiverView","receiverName","EditTemplateView","GlobalConfigForm","onSubmitCallback","NewReceiverView","NewTemplateView","receiverTypeNames","extractNotifierTypeCounts","getGrafanaNotifierTypeCounts","getCortexAlertManagerNotifierTypeCounts","_","r","ReceiversSection","title","addButtonLabel","addButtonTo","showButton","GRAFANA_APP_RECEIVERS_SOURCE_IMAGE","GrafanaAppBadge","grafanaAppType","UpdateActions","permissions","alertManagerName","onClickDeleteReceiver","Authorize","ViewAction","ReceiverError","errorCount","errorDetail","showErrorCount","tooltip","text","tooltipToRender","NotifierHealth","errorsByNotifier","lastNotify","hasErrors","noAttempts","isLastNotifyNullDate","ReceiverHealth","errorsByReceiver","someWithNoAttempt","useContactPointsState","contactPointsState","receivers","errorStateAvailable","LastNotify","lastNotifyDate","possibleNullDurations","durationIsNull","duration","NotifiersTable","notifiersState","getNotifierColumns","lastError","lastNotifyDuration","notifierRows","typeState","notifierStatus","DynamicTable","ReceiversTable","receiverToDelete","setReceiverToDelete","showCannotDeleteReceiverModal","setShowCannotDeleteReceiverModal","deleteReceiver","rows","count","columns","useGetColumns","ConfirmModal","someNotifiersWithNoAttempt","baseColumns","provisioned","types","grafanaAppReceiverType","healthColumn","TemplatesTable","expandedTemplates","setExpandedTemplates","templateRows","templateToDelete","setTemplateToDelete","deleteTemplate","idx","isExpanded","DetailsField","ReceiversAndTemplatesView","isCloud","NotificationError","Receivers","alertManagers","setAlertManagerSourceName","useAlertManagerSourceName","isRoot","isduplicatingTemplate","configRequests","receiverTypes","shouldLoadConfig","shouldRenderNotificationStatus","integrationsErrorCount","disableAmSelect","pageNav","getPageNavigationModel","AlertingPageWrapper","AlertManagerPicker","GrafanaAlertmanagerDeliveryWarning","NoAlertManagerWarning","isDuplicatingTemplates","objectText","receiversApi","amSourceName","useGetContactPointsState","contactPointsStateEmpty","actions","fallback","action","currentAlertmanager","useGetAlertmanagerChoiceStatusQuery","amChoiceStatus","viewingInternalAM","hasActiveExternalAMs","NoAlertManagersAvailable","OtherAlertManagersAvailable","availableAlertManagers","hasOtherAMs","ProvisionedResource","ProvisioningAlert","resource","ProvisioningBadge","onCallApi","fetchOnCallIntegrations","lastValueFrom","useGetOnCallIntegrationsQuery","isInOnCallIntegrations","url","integrationsUrls","isOnCallReceiver","onlyOneIntegration","isOncall","useGetGrafanaReceiverTypeChecker","isOnCallEnabled","usePluginBridge","useGetAmRouteReceiverWithGrafanaAppTypes","getGrafanaReceiverType","receiverToSelectableContactPointValue","useGetReceiversWithGrafanaAppTypes","icon","to","target","onClick","tooltipPlacement","ariaLabel","omitLabels","common","commonLabel","extractCommonLabels","flatLabels","useIsAlertManagerAvailable","am","queryParams","updateQueryParams","isAlertManagerAvailable","querySource","storeSource","useAlertManagersByPermission","accessType","getAlertTableStyles","generateCopiedName","originalName","exisitingNames","nonDuplicateName"],"sourceRoot":""}