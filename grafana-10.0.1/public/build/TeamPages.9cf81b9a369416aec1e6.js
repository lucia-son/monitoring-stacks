"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[8612],{77830:($,b,t)=>{t.d(b,{f:()=>f});var y=t(66111),e=t(13821),l=t(77582),M=t(27876),I=t(17069),C=t(11630);const f=({teamId:r,roleOptions:m,disabled:n,onApplyRoles:d,pendingRoles:g,apply:E=!1,maxWidth:S})=>{const[{loading:z,value:B=[]},U]=(0,e.Z)(async()=>{try{if(E&&Boolean(g?.length))return g;if(l.Vt.hasPermission(M.AccessControlAction.ActionTeamsRolesList))return await(0,C._C)(r)}catch(L){console.error("Error loading options",L)}return[]},[r,g]);(0,y.useEffect)(()=>{U()},[r,U,g]);const x=async L=>{E?d&&d(L):(await(0,C.u7)(L,r),await U())},v=l.Vt.hasPermission(M.AccessControlAction.ActionTeamsRolesAdd)&&l.Vt.hasPermission(M.AccessControlAction.ActionTeamsRolesRemove);return y.createElement(I.I,{apply:E,onRolesChange:x,roleOptions:m,appliedRoles:B,isLoading:z,disabled:n,basicRoleDisabled:!0,canUpdateRoles:v,maxWidth:S})}},58693:($,b,t)=>{t.d(b,{C:()=>C});var y=t(66111),e=t(42638),l=t(77582),M=t(27876),I=t(11630);const C=f=>{const[r,m]=(0,y.useState)(f),{value:n=[]}=(0,e.Z)(async()=>l.Vt.licensedAccessControlEnabled()&&l.Vt.hasPermission(M.AccessControlAction.ActionRolesList)?(0,I.ul)(r):Promise.resolve([]),[r]);return[{roleOptions:n},m]}},18885:($,b,t)=>{t.d(b,{Z:()=>i,v:()=>o});var y=t(9892),e=t(66111),l=t(206),M=t(68183),I=t(35645),C=t(41818),f=t(94270),r=t(13393),m=t(24799),n=t(2594),d=t(64353),g=t(52566),E=t(80124),S=t(26338),z=t(8581),B=t(31403),U=t(7804),x=t(99661),v=t(35287),L=t(19719),F=t(42454);function O(){const A=L.a2.map(p=>({value:p.code,label:p.name}));return[{value:"",label:(0,v.t)("common.locale.default","Default")},...A]}const W=Boolean(I.v.featureToggles.internationalization);class o extends e.PureComponent{constructor(D){super(D),this.onSubmitForm=async()=>{if(this.props.onConfirm?await this.props.onConfirm():!0){const{homeDashboardUID:G,theme:N,timezone:H,weekStart:J,language:Z,queryHistory:Q}=this.state;await this.service.update({homeDashboardUID:G,theme:N,timezone:H,weekStart:J,language:Z,queryHistory:Q}),window.location.reload()}},this.onThemeChanged=p=>{this.setState({theme:p})},this.onTimeZoneChanged=p=>{p&&this.setState({timezone:p})},this.onWeekStartChanged=p=>{this.setState({weekStart:p})},this.onHomeDashboardChanged=p=>{this.setState({homeDashboardUID:p})},this.onLanguageChanged=p=>{this.setState({language:p}),(0,C.ff)("grafana_preferences_language_changed",{toLanguage:p,preferenceType:this.props.preferenceType})},this.service=new F.y(D.resourceUri),this.state={theme:"",timezone:"",weekStart:"",language:"",queryHistory:{homeTab:""}},this.themeOptions=[{value:"",label:(0,v.t)("shared-preferences.theme.default-label","Default")},{value:"dark",label:(0,v.t)("shared-preferences.theme.dark-label","Dark")},{value:"light",label:(0,v.t)("shared-preferences.theme.light-label","Light")},{value:"system",label:(0,v.t)("shared-preferences.theme.system-label","System")}]}async componentDidMount(){const D=await this.service.load();this.setState({homeDashboardUID:D.homeDashboardUID,theme:D.theme,timezone:D.timezone,weekStart:D.weekStart,language:D.language,queryHistory:D.queryHistory})}render(){const{theme:D,timezone:p,weekStart:G,homeDashboardUID:N,language:H}=this.state,{disabled:J}=this.props,Z=P(),Q=O();let j=this.themeOptions[0].value;return D?.length&&(j=this.themeOptions.find(_=>_.value===D)?.value),e.createElement(f.l,{onSubmit:this.onSubmitForm},()=>e.createElement(r.C,{label:e.createElement(v.cC,{i18nKey:"shared-preferences.title"},"Preferences"),disabled:J},e.createElement(m.g,{label:(0,v.t)("shared-preferences.fields.theme-label","UI Theme")},e.createElement(n.S,{options:this.themeOptions,value:j,onChange:this.onThemeChanged})),e.createElement(m.g,{label:e.createElement(d._,{htmlFor:"home-dashboard-select"},e.createElement("span",{className:Z.labelText},e.createElement(v.cC,{i18nKey:"shared-preferences.fields.home-dashboard-label"},"Home Dashboard"))),"data-testid":"User preferences home dashboard drop down"},e.createElement(x.o,{value:N,onChange:_=>this.onHomeDashboardChanged(_?.uid??""),defaultOptions:!0,isClearable:!0,placeholder:(0,v.t)("shared-preferences.fields.home-dashboard-placeholder","Default dashboard"),inputId:"home-dashboard-select"})),e.createElement(m.g,{label:(0,v.t)("shared-dashboard.fields.timezone-label","Timezone"),"data-testid":M.wl.components.TimeZonePicker.containerV2},e.createElement(g.O,{includeInternal:!0,value:p,onChange:this.onTimeZoneChanged,inputId:"shared-preferences-timezone-picker"})),e.createElement(m.g,{label:(0,v.t)("shared-preferences.fields.week-start-label","Week start"),"data-testid":M.wl.components.WeekStartPicker.containerV2},e.createElement(E.z,{value:G||"",onChange:this.onWeekStartChanged,inputId:"shared-preferences-week-start-picker"})),W?e.createElement(m.g,{label:e.createElement(d._,{htmlFor:"locale-select"},e.createElement("span",{className:Z.labelText},e.createElement(v.cC,{i18nKey:"shared-preferences.fields.locale-label"},"Language")),e.createElement(S.a,{featureState:l.CQ.beta})),"data-testid":"User preferences language drop down"},e.createElement(z.Ph,{value:Q.find(_=>_.value===H),onChange:_=>this.onLanguageChanged(_.value??""),options:Q,placeholder:(0,v.t)("shared-preferences.fields.locale-placeholder","Choose language"),inputId:"locale-select"})):null,e.createElement("div",{className:"gf-form-button-row"},e.createElement(B.zx,{type:"submit",variant:"primary","data-testid":M.wl.components.UserProfile.preferencesSaveButton},e.createElement(v.cC,{i18nKey:"common.save"},"Save")))))}}const i=o,P=(0,U.B)(()=>({labelText:y.css`
      margin-right: 6px;
    `}))},64975:($,b,t)=>{t.r(b),t.d(b,{TeamPages:()=>Y,default:()=>Ce});var y=t(82897),e=t(66111),l=t(67948),M=t(66121),I=t(72648),C=t(8412),f=t(39284),r=t(47694),m=t(86245),n=t(82002),d=t(27876),g=t(31403),E=t(39904),S=t(61860),z=t(11543),B=t(81764),U=t(46967),x=t(1108),v=t(50796),L=t(69142),F=t(77293),O=t(13949),W=t(3813);function o(u){return{groups:(0,W.JB)(u.team)}}const i={loadTeamGroups:O.j_,addTeamGroup:O.A_,removeTeamGroup:O.P5},P=(0,l.connect)(o,i),A="Sync LDAP, OAuth or SAML groups with your Grafana teams.";class D extends e.PureComponent{constructor(a){super(a),this.onToggleAdding=()=>{this.setState({isAdding:!this.state.isAdding})},this.onNewGroupIdChanged=s=>{this.setState({newGroupId:s.target.value})},this.onAddGroup=s=>{s.preventDefault(),this.props.addTeamGroup(this.state.newGroupId),this.setState({isAdding:!1,newGroupId:""})},this.onRemoveGroup=s=>{this.props.removeTeamGroup(s.groupId)},this.state={isAdding:!1,newGroupId:""}}componentDidMount(){this.fetchTeamGroups()}async fetchTeamGroups(){await this.props.loadTeamGroups()}isNewGroupValid(){return this.state.newGroupId.length>1}renderGroup(a){const{isReadOnly:s}=this.props;return e.createElement("tr",{key:a.groupId},e.createElement("td",null,a.groupId),e.createElement("td",{style:{width:"1%"}},e.createElement(g.zx,{size:"sm",variant:"destructive",onClick:()=>this.onRemoveGroup(a),disabled:s,"aria-label":`Remove group ${a.groupId}`},e.createElement(E.J,{name:"times"}))))}render(){const{isAdding:a,newGroupId:s}=this.state,{groups:c,isReadOnly:h}=this.props;return e.createElement("div",null,(0,F.d5)()&&e.createElement(f.Xz,{featureId:"team-sync",eventVariant:"trial",featureName:"team sync",text:"Add a group to enable team sync for free during your trial of Grafana Pro."}),e.createElement("div",{className:"page-action-bar"},(!(0,F.d5)()||c.length>0)&&e.createElement(e.Fragment,null,e.createElement("h3",{className:"page-sub-heading"},"External group sync"),e.createElement(S.u,{placement:"auto",content:A},e.createElement(E.J,{className:"icon--has-hover page-sub-heading-icon",name:"question-circle"}))),e.createElement("div",{className:"page-action-bar__spacer"}),c.length>0&&e.createElement(g.zx,{className:"pull-right",onClick:this.onToggleAdding,disabled:h},e.createElement(E.J,{name:"plus"})," Add group")),e.createElement(x.s,{in:a},e.createElement("div",{className:"cta-form"},e.createElement(v.P,{onClick:this.onToggleAdding}),e.createElement("form",{onSubmit:this.onAddGroup},e.createElement(z.Z,null,e.createElement(B._,{label:"Add External Group",tooltip:"LDAP Group Example: cn=users,ou=groups,dc=grafana,dc=org."},e.createElement(U.I,{type:"text",id:"add-external-group",placeholder:"",value:s,onChange:this.onNewGroupIdChanged,disabled:h})),e.createElement(g.zx,{type:"submit",disabled:h||!this.isNewGroupValid(),style:{marginLeft:4}},"Add group"))))),c.length===0&&!a&&((0,F.d5)()?e.createElement(p,{action:{onClick:this.onToggleAdding,text:"Add group"}}):e.createElement(L.Z,{onClick:this.onToggleAdding,buttonIcon:"users-alt",title:"There are no external groups to sync with",buttonTitle:"Add group",proTip:A,proTipLinkTitle:"Learn more",proTipLink:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-team-sync/",proTipTarget:"_blank",buttonDisabled:h})),c.length>0&&e.createElement("div",{className:"admin-list-table"},e.createElement("table",{className:"filter-table filter-table--hover form-inline"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null,"External Group ID"),e.createElement("th",{style:{width:"1%"}}))),e.createElement("tbody",null,c.map(T=>this.renderGroup(T))))))}}const p=({action:u})=>{const a=(0,I.l4)();return e.createElement(f.TA,{action:u,listItems:["Stop managing user access in two places - assign users to groups in SAML, LDAP or Oauth, and manage access at a Team level in Grafana","Update users\u2019 permissions immediately when you add or remove them from an LDAP group, with no need for them to sign out and back in"],image:`team-sync-${a.isLight?"light":"dark"}.png`,featureName:"team sync",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/team-sync",description:"Team Sync makes it easier for you to manage users\u2019 access in Grafana, by immediately updating each user\u2019s Grafana teams and permissions based on their single sign-on group membership, instead of when users sign in."})},G=(0,l.connect)(o,i)(D);var N=t(14747),H=t(64353),J=t(28038),Z=t(21731);const Q=({featureToggle:u,children:a})=>u===!0?e.createElement(e.Fragment,null,a):null;var j=t(8581),_=t(13626);const w={removeTeamMember:O.zT,updateTeamMember:O.zZ},k=(0,l.connect)(null,w);class q extends e.PureComponent{constructor(a){super(a),this.onPermissionChange=(s,c)=>{const h=s.value,T={...c,permission:h};this.props.updateTeamMember(T)},this.renderLabels=this.renderLabels.bind(this),this.renderPermissions=this.renderPermissions.bind(this)}onRemoveMember(a){this.props.removeTeamMember(a.userId)}renderPermissions(a){const{editorsCanAdmin:s,signedInUserIsTeamAdmin:c}=this.props,h=d.teamsPermissionLevels.find(T=>T.value===a.permission);return e.createElement(Q,{featureToggle:s},e.createElement("td",{className:"width-5 team-permissions"},c?e.createElement(j.Ph,{isSearchable:!1,options:d.teamsPermissionLevels,onChange:T=>this.onPermissionChange(T,a),value:h,width:32,"aria-label":`Select member's ${a.name} permission level`}):e.createElement("span",null,h.label)))}renderLabels(a){return a?e.createElement("td",null,a.map(s=>e.createElement(Z.e,{key:s,label:s,removeIcon:!1,count:0}))):e.createElement("td",null)}render(){const{member:a,syncEnabled:s,signedInUserIsTeamAdmin:c}=this.props;return e.createElement("tr",{key:a.userId},e.createElement("td",{className:"width-4 text-center"},e.createElement("img",{alt:`Avatar for team member "${a.name}"`,className:"filter-table__avatar",src:a.avatarUrl})),e.createElement("td",null,a.login),e.createElement("td",null,a.email),e.createElement("td",null,a.name),this.renderPermissions(a),s&&this.renderLabels(a.labels),e.createElement("td",{className:"text-right"},e.createElement(_.m,{"aria-label":`Remove team member ${a.name}`,size:"sm",disabled:!c,onConfirm:()=>this.onRemoveMember(a)})))}}const ee=k(q);var te=t(97189);function ae(u){return{searchMemberQuery:(0,W.xc)(u.team),editorsCanAdmin:r.vc.editorsCanAdmin,signedInUser:n.Vt.user}}const ne={addTeamMember:O.Lt,setSearchMemberQuery:te.UD},se=(0,l.connect)(ae,ne);class re extends e.PureComponent{constructor(a){super(a),this.onSearchQueryChange=s=>{this.props.setSearchMemberQuery(s)},this.onToggleAdding=()=>{this.setState({isAdding:!this.state.isAdding})},this.onUserSelected=s=>{this.setState({newTeamMember:s})},this.onAddUserToTeam=async()=>{this.props.addTeamMember(this.state.newTeamMember.id),this.setState({newTeamMember:null})},this.state={isAdding:!1,newTeamMember:null}}renderLabels(a){return a?e.createElement("td",null,a.map(s=>e.createElement(Z.e,{key:s,label:s,removeIcon:!1,count:0}))):e.createElement("td",null)}render(){const{isAdding:a}=this.state,{searchMemberQuery:s,members:c,syncEnabled:h,editorsCanAdmin:T,signedInUser:K}=this.props,V=(0,W.vt)({members:c,editorsCanAdmin:T,signedInUser:K});return e.createElement("div",null,e.createElement("div",{className:"page-action-bar"},e.createElement("div",{className:"gf-form gf-form--grow"},e.createElement(N.H,{placeholder:"Search members",value:s,onChange:this.onSearchQueryChange})),e.createElement(g.zx,{className:"pull-right",onClick:this.onToggleAdding,disabled:a||!V},"Add member")),e.createElement(x.s,{in:a},e.createElement("div",{className:"cta-form"},e.createElement(v.P,{"aria-label":"Close 'Add team member' dialogue",onClick:this.onToggleAdding}),e.createElement(H._,{htmlFor:"user-picker"},"Add team member"),e.createElement("div",{className:"gf-form-inline"},e.createElement(J.f,{inputId:"user-picker",onSelected:this.onUserSelected,className:"min-width-30"}),this.state.newTeamMember&&e.createElement(g.zx,{type:"submit",onClick:this.onAddUserToTeam},"Add to team")))),e.createElement("div",{className:"admin-list-table"},e.createElement("table",{className:"filter-table filter-table--hover form-inline"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null),e.createElement("th",null,"Login"),e.createElement("th",null,"Email"),e.createElement("th",null,"Name"),e.createElement(Q,{featureToggle:T},e.createElement("th",null,"Permission")),h&&e.createElement("th",null),e.createElement("th",{style:{width:"1%"}}))),e.createElement("tbody",null,c&&c.map(R=>e.createElement(ee,{key:R.userId,member:R,syncEnabled:h,editorsCanAdmin:T,signedInUserIsTeamAdmin:V}))))))}}const oe=se(re);var ie=t(73546);const le=u=>{const a=n.Vt.hasPermissionInMetadata(d.AccessControlAction.ActionTeamsPermissionsWrite,u.team);return e.createElement(ie.P,{title:"",addPermissionTitle:"Add member",buttonLabel:"Add member",emptyLabel:"There are no members in this team or you do not have the permissions to list the current members.",resource:"teams",resourceId:u.team.id,canSetPermissions:a})};var me=t(52081),ce=t(94270),de=t(13393),X=t(24799),ue=t(77830),he=t(11630),ge=t(58693),Ee=t(18885);const pe={updateTeam:O.fs},fe=(0,l.connect)(null,pe)(({team:u,updateTeam:a})=>{const s=n.Vt.hasPermissionInMetadata(d.AccessControlAction.ActionTeamsWrite,u),c=n.Vt.user.orgId,[{roleOptions:h}]=(0,ge.C)(c),[T,K]=(0,e.useState)([]),V=n.Vt.hasPermission(d.AccessControlAction.ActionUserRolesAdd)&&n.Vt.hasPermission(d.AccessControlAction.ActionUserRolesRemove);return e.createElement(me.wc,{spacing:"lg"},e.createElement(ce.l,{defaultValues:{...u},onSubmit:async R=>{n.Vt.licensedAccessControlEnabled()&&V&&await(0,he.u7)(T,u.id),a(R.name,R.email||"")},disabled:!s},({register:R,errors:De})=>e.createElement(de.C,{label:"Team details"},e.createElement(X.g,{label:"Name",disabled:!s,required:!0,invalid:!!De.name,error:"Name is required"},e.createElement(U.I,{...R("name",{required:!0}),id:"name-input"})),n.Vt.licensedAccessControlEnabled()&&e.createElement(X.g,{label:"Role"},e.createElement(ue.f,{teamId:u.id,roleOptions:h,disabled:!1,apply:!0,onApplyRoles:K,pendingRoles:T,maxWidth:"100%"})),e.createElement(X.g,{label:"Email",description:"This is optional and is primarily used to set the team profile avatar (via gravatar service).",disabled:!s},e.createElement(U.I,{...R("email"),placeholder:"team@email.com",type:"email",id:"email-input"})),e.createElement(g.zx,{type:"submit",disabled:!s},"Update"))),e.createElement(Ee.v,{resourceUri:`teams/${u.id}`,disabled:!s,preferenceType:"team"}))});var Te=t(87941),ve=(u=>(u.Members="members",u.Settings="settings",u.GroupSync="groupsync",u))(ve||{});function Pe(u,a){const s=parseInt(a.match.params.id,10),c=(0,W.VP)(u.team,s);let h="members";n.Vt.accessControlEnabled()&&(!c||!n.Vt.hasPermissionInMetadata(d.AccessControlAction.ActionTeamsPermissionsRead,c))&&(h="settings");const T=a.match.params.page??h,K=(0,Te.o)(T),V=(0,m.ht)(u.navIndex,`team-${T}-${s}`,K).main,R=(0,W.YY)(u.team);return{pageNav:V,teamId:s,pageName:T,team:c,members:R,editorsCanAdmin:r.ZP.editorsCanAdmin,signedInUser:n.Vt.user}}const Ae={loadTeam:O.QX,loadTeamMembers:O.ei},Me=(0,l.connect)(Pe,Ae);class Y extends e.PureComponent{constructor(a){super(a),this.textsAreEqual=(s,c)=>!s&&!c?!0:!s||!c?!1:s.toLocaleLowerCase()===c.toLocaleLowerCase(),this.hideTabsFromNonTeamAdmin=(s,c)=>(n.Vt.accessControlEnabled()||!c&&s&&s.children&&s.children.filter(h=>!this.textsAreEqual(h.text,"members")).map(h=>{h.hideFromTabs=!0}),s),this.state={isLoading:!1,isSyncEnabled:(0,M.v)("teamsync")}}async componentDidMount(){await this.fetchTeam()}async fetchTeam(){const{loadTeam:a,teamId:s}=this.props;this.setState({isLoading:!0});const c=await a(s);return n.Vt.accessControlEnabled()||await this.props.loadTeamMembers(),this.setState({isLoading:!1}),c}getCurrentPage(){const a=["members","settings","groupsync"],s=this.props.pageName;return(0,y.includes)(a,s)?s:a[0]}renderPage(a){const{isSyncEnabled:s}=this.state,{members:c,team:h}=this.props,T=this.getCurrentPage(),K=n.Vt.hasAccessInMetadata(d.AccessControlAction.ActionTeamsRead,h,a),V=n.Vt.hasAccessInMetadata(d.AccessControlAction.ActionTeamsPermissionsRead,h,a),R=n.Vt.hasAccessInMetadata(d.AccessControlAction.ActionTeamsPermissionsWrite,h,a);switch(T){case"members":return n.Vt.accessControlEnabled()?e.createElement(le,{team:h}):e.createElement(oe,{syncEnabled:s,members:c});case"settings":return K&&e.createElement(fe,{team:h});case"groupsync":if(s){if(V)return e.createElement(G,{isReadOnly:!R})}else if(r.ZP.featureToggles.featureHighlights)return e.createElement(e.Fragment,null,e.createElement(f.Xz,{featureName:"team sync",featureId:"team-sync"}),e.createElement(p,null))}return null}render(){const{team:a,pageNav:s,members:c,editorsCanAdmin:h,signedInUser:T}=this.props,K=(0,W.vt)({members:c,editorsCanAdmin:h,signedInUser:T});return e.createElement(C.T,{navId:"teams",pageNav:this.hideTabsFromNonTeamAdmin(s,K)},e.createElement(C.T.Contents,{isLoading:this.state.isLoading},a&&Object.keys(a).length!==0&&this.renderPage(K)))}}const Ce=Me((0,I.HE)(Y))},13949:($,b,t)=>{t.d(b,{A_:()=>F,Lt:()=>U,P5:()=>O,QX:()=>g,R5:()=>S,ei:()=>B,fC:()=>E,fs:()=>v,jI:()=>n,j_:()=>L,oO:()=>z,zT:()=>x,zZ:()=>W});var y=t(82897),e=t.n(y),l=t(54899),M=t(659),I=t(77582),C=t(95156),f=t(27876),r=t(87941),m=t(97189);function n(o=!1){return async(i,P)=>{const{query:A,page:D,perPage:p}=P().teams;if(!I.Vt.hasPermission(f.AccessControlAction.ActionTeamsRead)){i((0,m.PL)({teams:[],totalCount:0,page:1,perPage:p,noTeams:!0}));return}const G=await(0,l.i)().get("/api/teams/search",(0,C.y)({query:A,page:D,perpage:p}));let N=!1;o&&(N=G.teams.length===0),i((0,m.PL)({noTeams:N,...G}))}}const d=(0,y.debounce)(o=>o(n()),500);function g(o){return async i=>{const P=await(0,l.i)().get(`/api/teams/${o}`,(0,C.y)());i((0,m.y$)(P)),i((0,M.RL)((0,r.B)(P)))}}function E(o){return async i=>{await(0,l.i)().delete(`/api/teams/${o}`),await I.Vt.fetchUserPermissions(),i(n())}}function S(o){return async i=>{i((0,m.aj)(o)),d(i)}}function z(o){return async i=>{i((0,m.PJ)(o)),i(n())}}function B(){return async(o,i)=>{const P=i().team.team,A=await(0,l.i)().get(`/api/teams/${P.id}/members`);o((0,m.n2)(A))}}function U(o){return async(i,P)=>{const A=P().team.team;await(0,l.i)().post(`/api/teams/${A.id}/members`,{userId:o}),i(B())}}function x(o){return async(i,P)=>{const A=P().team.team;await(0,l.i)().delete(`/api/teams/${A.id}/members/${o}`),i(B())}}function v(o,i){return async(P,A)=>{const D=A().team.team;await(0,l.i)().put(`/api/teams/${D.id}`,{name:o,email:i}),P(g(D.id))}}function L(){return async(o,i)=>{const P=i().team.team,A=await(0,l.i)().get(`/api/teams/${P.id}/groups`);o((0,m.iI)(A))}}function F(o){return async(i,P)=>{const A=P().team.team;await(0,l.i)().post(`/api/teams/${A.id}/groups`,{groupId:o}),i(L())}}function O(o){return async(i,P)=>{const A=P().team.team;await(0,l.i)().delete(`/api/teams/${A.id}/groups?groupId=${encodeURIComponent(o)}`),i(L())}}function W(o){return async i=>{await(0,l.i)().put(`/api/teams/${o.teamId}/members/${o.userId}`,{permission:o.permission}),i(B())}}},87941:($,b,t)=>{t.d(b,{B:()=>r,o:()=>m});var y=t(66121),e=t(73194),l=t(47694),M=t(82002),I=t(77293),C=t(27876);const f={avatarUrl:"public/img/user_profile.png",id:1,name:"Loading",email:"loading",memberCount:0,permission:C.TeamPermissionLevel.Member,accessControl:{isEditor:!1},orgId:0,updated:""};function r(n){const d={img:n.avatarUrl,id:"team-"+n.id,subTitle:"Manage members and settings",url:"",text:n.name,breadcrumbs:[{title:"Teams",url:"org/teams"}],children:[{active:!1,icon:"sliders-v-alt",id:`team-settings-${n.id}`,text:"Settings",url:`org/teams/edit/${n.id}/settings`}]};(n===f||M.Vt.hasPermissionInMetadata(C.AccessControlAction.ActionTeamsPermissionsRead,n))&&d.children.unshift({active:!1,icon:"users-alt",id:`team-members-${n.id}`,text:"Members",url:`org/teams/edit/${n.id}/members`});const g={active:!1,icon:"sync",id:`team-groupsync-${n.id}`,text:"External group sync",url:`org/teams/edit/${n.id}/groupsync`},E=n===f;return(0,I.d5)()&&(g.tabSuffix=()=>(0,e.Z)({experimentId:E?"":"feature-highlights-team-sync-badge",eventVariant:"trial"})),(0,y.v)("teamsync")?(E||M.Vt.hasPermissionInMetadata(C.AccessControlAction.ActionTeamsPermissionsRead,n))&&d.children.push(g):l.ZP.featureToggles.featureHighlights&&d.children.push({...g,tabSuffix:()=>(0,e.Z)({experimentId:E?"":"feature-highlights-team-sync-badge"})}),d}function m(n){const d=r(f);let g;for(const E of d.children)if(E.id.indexOf(n)>0){E.active=!0,g=E;break}return{main:d,node:g}}},3813:($,b,t)=>{t.d(b,{JB:()=>l,VP:()=>M,YY:()=>I,kC:()=>f,vt:()=>C,xc:()=>e});var y=t(27876);const e=r=>r.searchMemberQuery,l=r=>r.groups,M=(r,m)=>r.team.id===parseInt(m,10)?r.team:null,I=r=>{const m=RegExp(r.searchMemberQuery,"i");return r.members.filter(n=>m.test(n.login)||m.test(n.email)||m.test(n.name))},C=r=>{const{members:m,signedInUser:n,editorsCanAdmin:d}=r,g=m.find(S=>S.userId===n.id),E=g?g.permission:y.TeamPermissionLevel.Member;return f({permission:E,signedInUser:n,editorsCanAdmin:d})},f=r=>{const{permission:m,signedInUser:n,editorsCanAdmin:d}=r,g=n.isGrafanaAdmin||n.orgRole===y.OrgRole.Admin,E=m===y.TeamPermissionLevel.Admin;return g||E||!d}},42638:($,b,t)=>{var y;y={value:!0};var e=t(9683),l=t(66111),M=e.__importDefault(t(55986));function I(C,f){f===void 0&&(f=[]);var r=M.default(C,f,{loading:!0}),m=r[0],n=r[1];return l.useEffect(function(){n()},[n]),m}b.Z=I}}]);

//# sourceMappingURL=TeamPages.9cf81b9a369416aec1e6.js.map