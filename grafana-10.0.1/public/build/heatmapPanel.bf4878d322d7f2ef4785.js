"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6987],{10:(ot,Ae,i)=>{i.d(Ae,{q:()=>K});var h=i(9892),W=i(66111),$e=i(72648);const Le=10,K=({colorPalette:de,min:Ee,max:Fe,display:z,hoverValue:ke,useStopsPercentage:Te})=>{const[Se,Be]=(0,W.useState)([]),[be,Pe]=(0,W.useState)({isShown:!1,value:0}),[Ie,Qe]=(0,W.useState)(null),He=(0,$e.l4)(),Oe=Ze(He,Se);(0,W.useEffect)(()=>{Be(b({colorArray:de,stops:Le,useStopsPercentage:Te}))},[de,Te]);const at=Ue=>{const lt=Ue.nativeEvent.offsetX,nt=Ue.currentTarget.offsetWidth,Xe=Math.floor(lt*100/nt+1),We=Math.floor((Fe-Ee)*Xe/100+Ee);Pe({isShown:!0,value:We}),Qe(Xe)},Re=()=>{Pe({isShown:!1,value:0})};return(0,W.useEffect)(()=>{Qe(ke==null?null:c((ke-Ee)/(Fe-Ee)))},[ke,Ee,Fe]),W.createElement("div",{className:Oe.scaleWrapper,onMouseMove:at,onMouseLeave:Re},W.createElement("div",{className:Oe.scaleGradient},z&&(be.isShown||ke!==void 0)&&W.createElement("div",{className:Oe.followerContainer},W.createElement("div",{className:Oe.follower,style:{left:`${Ie}%`}}))),z&&W.createElement("div",{className:Oe.followerContainer},W.createElement("div",{className:Oe.legendValues},W.createElement("span",null,z(Ee)),W.createElement("span",null,z(Fe))),Ie!=null&&(be.isShown||ke!==void 0)&&W.createElement("span",{className:Oe.hoverValue,style:{left:`${Ie}%`}},z(ke??be.value))))},b=({colorArray:de,stops:Ee,useStopsPercentage:Fe=!0})=>{const z=de.length;if(Fe&&z<=20){const Be=1/z*100;let be=0;const Pe=[];for(const Ie of de)be>0?Pe.push(`${Ie} ${be}%`):Pe.push(Ie),be+=Be,Pe.push(`${Ie} ${be}%`);return Pe}const ke=de[z-1],Te=Math.ceil(z/Ee),Se=new Set;for(let Be=0;Be<z;Be+=Te)Se.add(de[Be]);return Se.add(ke),[...Se]};function c(de){return de>1?100:de<0?0:de*100}const Ze=(de,Ee)=>({scaleWrapper:h.css`
    width: 100%;
    font-size: 11px;
    opacity: 1;
  `,scaleGradient:h.css`
    background: linear-gradient(90deg, ${Ee.join()});
    height: 10px;
    pointer-events: none;
  `,legendValues:h.css`
    display: flex;
    justify-content: space-between;
    pointer-events: none;
  `,hoverValue:h.css`
    position: absolute;
    margin-top: -14px;
    padding: 3px 15px;
    background: ${de.colors.background.primary};
    transform: translateX(-50%);
  `,followerContainer:h.css`
    position: relative;
    pointer-events: none;
    white-space: nowrap;
  `,follower:h.css`
    position: absolute;
    height: 14px;
    width: 14px;
    border-radius: 50%;
    transform: translateX(-50%) translateY(-50%);
    border: 2px solid ${de.colors.text.primary};
    margin-top: 5px;
  `})},30749:(ot,Ae,i)=>{i.d(Ae,{Ky:()=>ye,n:()=>Qe,nM:()=>ct,nf:()=>qe,vs:()=>Re});var h=i(47700),W=i(82897),$e=i.n(W),Le=i(206),K=i(99098),b=i(89749),c=i(86029),Ze=i(6194),de=i(7569),Ee=i(39393),Fe=i(30471),z=i(35645),ke=i(86647),Te=i(20308),Se=i(44332),Be=i(37462);const be=/^[+-]?inf(?:inity)?$/i,Pe=(n,r)=>r.app===Le.zj.Explore&&(n.meta?.custom?.resultType==="vector"||n.meta?.custom?.resultType==="scalar")?!0:r.targets.find(g=>g.refId===n.refId)?.format==="table",Ie=(n,r)=>r.targets.find(g=>g.refId===n.refId)?.format==="heatmap";function Qe(n,r,x){z.v.featureToggles.prometheusDataplane&&n.data.forEach(Y=>{const we=r.targets.find(P=>P.refId===Y.refId);we&&we.legendFormat==="__auto"&&Y.fields.forEach(P=>{if(P.labels?.__name__&&P.labels?.__name__===P.name){const he={...P,name:K.M5};P.config.displayNameFromDS=(0,Fe.$w)(he,Y,n.data)}})});const[g,E]=(0,W.partition)(n.data,Y=>Pe(Y,r)),D=Oe(g),[j,T]=(0,W.partition)(E,Y=>Y.meta?.custom?.resultType==="exemplar"),{exemplarTraceIdDestinations:G}=x,$=j.map(Y=>{if(G?.length)for(const we of G){const P=Y.fields.find(he=>he.name===we.name);if(P){const he=Ue(we);P.config.links=P.config.links?.length?[...P.config.links,...he]:he}}return{...Y,meta:{...Y.meta,dataTopic:b.w5.Annotations}}}),[Z,Ce]=(0,W.partition)(T,Y=>Ie(Y,r));Z.forEach(Y=>{if(Y.name==null){let we=Y.fields.find(P=>P.name==="Value");if(we){let P=we.labels?.le;P&&(Y.name=P,we.config.displayNameFromDS=P)}}});const q=(0,W.groupBy)(Z,Y=>Y.refId);let re=[];for(const Y in q){const we=q[Y],P=(0,W.groupBy)(we,he=>{const Ve=he.fields.find(k=>k.name===K.M5);if(Ve?.labels&&He in Ve.labels){const{le:k,...Je}=Ve?.labels;return Object.values(Je).join()}return Object.values(Ve?.labels??[]).join()});(0,W.forOwn)(P,(he,Ve)=>{const k=he.sort(qe);re.push(ze(Ye(k)))})}const De=Ce.map(Y=>({...Y,meta:{...Y.meta,preferredVisualisationType:"graph"}})),_e=(0,W.flatten)(re);return{...n,data:[...De,...D,..._e,...$]}}const He="le";function Oe(n){if(n.length===0||n.length===1&&n[0].length===0)return n;const r=(0,W.groupBy)(n,"refId"),x=Object.keys(r);return x.map(E=>{const D=at(x.length,E),j=je({data:[],valueName:D}),T=Ke([]),G=[];r[E].forEach(Z=>{const q=Z.fields[1]?.labels??{};Object.keys(q).sort().forEach(re=>{if(!G.some(De=>De.name===re)){const De=re===He;G.push({name:re,config:{filterable:!0},type:De?K.fS.number:K.fS.string,values:[]})}})}),r[E].forEach(Z=>{const Ce=Z.fields[0]?.values??[],q=Z.fields[1]?.values??[];Ce.forEach(re=>T.values.push(re)),q.forEach(re=>{j.values.push(ye(re));const De=Z.fields[1].labels??{};G.forEach(_e=>_e.values.push(We(De,_e.name)))})});const $=[T,...G,j];return{refId:E,fields:$,meta:{...n[0].meta,preferredVisualisationType:"rawPrometheus"},length:T.values.length}})}function at(n,r=""){return n>1?`Value #${r}`:"Value"}function Re(n,r){const x={format:r.target.format,step:r.query.step,legendFormat:r.target.legendFormat,start:r.query.start,end:r.query.end,query:r.query.expr,responseListLength:r.responseListLength,scopedVars:r.scopedVars,refId:r.target.refId,valueWithRefId:r.target.valueWithRefId,meta:{preferredVisualisationType:r.query.instant?"rawPrometheus":"graph"}},g=n.data.data;if((0,Be.WS)(g)){const D=[];g.forEach(G=>{const $=G.exemplars.map(Z=>({[K.Ls]:Z.timestamp*1e3,[K.M5]:Z.value,...Z.labels,...G.seriesLabels}));D.push(...$)});const j=lt(D,x),T=new c.i(j);if(T.meta={dataTopic:b.w5.Annotations},r.exemplarTraceIdDestinations?.length)for(const G of r.exemplarTraceIdDestinations){const $=T.fields.find(Z=>Z.name===G.name);if($){const Z=Ue(G);$.config.links=$.config.links?.length?[...$.config.links,...Z]:Z}}return[T]}if(!g?.result)return[];if(g.resultType==="scalar")return[{meta:x.meta,refId:x.refId,length:1,fields:[Ke([g.result]),je({data:[g.result]})]}];if(x.format==="table")return[Xe(g.result,x)];const E=[];return g.result.forEach(D=>E.push(nt(D,x))),x.format==="heatmap"?ze(Ye(E.sort(qe))):E}function Ue(n){const r=[];if(n.datasourceUid){const g=(0,ke.F)().getInstanceSettings(n.datasourceUid);g&&r.push({title:n.urlDisplayLabel||`Query with ${g?.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:n.datasourceUid,datasourceName:g?.name??"Data source not found"}})}return n.url&&r.push({title:n.urlDisplayLabel||`Go to ${n.url}`,url:n.url,targetBlank:!0}),r}function lt(n,r){const x=r.step||15,g={},E=[];for(const G of n){const $=String(Math.floor(G[K.Ls]/1e3/x)*x*1e3);g[$]||(g[$]=[]),g[$].push(G),E.push(G[K.M5])}const D=(0,h.deviation)(E),j=Object.keys(g).sort(),T=[];for(const G of j){const $=g[G];if($.length===1)T.push($[0]);else{const Ce=$.map(q=>q[K.M5]).sort(h.descending).reduce((q,re)=>{if(q.length===0)q.push(re);else{const De=q[q.length-1];D&&De-re>=2*D&&q.push(re)}return q},[]);T.push(...Ce.map(q=>$.find(re=>re[K.M5]===q)))}}return T}function nt(n,r){const{name:x,labels:g}=it(n.metric,r),E=[];if((0,Be.el)(n)){const D=r.step?r.step*1e3:NaN;let j=r.start*1e3;const T=[];for(const $ of n.values){let Z=ye($[1]);isNaN(Z)&&(Z=null);const Ce=$[0]*1e3;for(let q=j;q<Ce;q+=D)T.push([q,null]);j=Ce+D,T.push([Ce,Z])}const G=r.end*1e3;for(let $=j;$<=G;$+=D)T.push([$,null]);E.push(Ke(T,!0)),E.push(je({data:T,parseValue:!1,labels:g,displayNameFromDS:x}))}else E.push(Ke([n.value])),E.push(je({data:[n.value],labels:g,displayNameFromDS:x}));return{meta:r.meta,refId:r.refId,length:E[0].values.length,fields:E,name:x}}function Xe(n,r){if(!n||n.length===0)return{meta:r.meta,refId:r.refId,length:0,fields:[]};const x=r.responseListLength>1||r.valueWithRefId?`Value #${r.refId}`:"Value",g=Ke([]),E=Object.keys(n.reduce((j,T)=>({...j,...T.metric}),{})).sort().map(j=>({name:j,config:{filterable:!0},type:j===He?K.fS.number:K.fS.string,values:[]})),D=je({data:[],valueName:x});return n.forEach(j=>{(0,Be.el)(j)?j.values.forEach(T=>{g.values.push(T[0]*1e3),E.forEach(G=>G.values.push(We(j.metric,G.name))),D.values.push(ye(T[1]))}):(g.values.push(j.value[0]*1e3),E.forEach(T=>T.values.push(We(j.metric,T.name))),D.values.push(ye(j.value[1])))}),{meta:r.meta,refId:r.refId,length:g.values.length,fields:[g,...E,D]}}function We(n,r){return n.hasOwnProperty(r)?r===He?ye(n[r]):n[r]:""}function Ke(n,r=!1){return{name:K.Ls,type:K.fS.time,config:{},values:n.map(x=>r?x[0]:x[0]*1e3)}}function je({data:n,valueName:r=K.M5,parseValue:x=!0,labels:g,displayNameFromDS:E}){return{name:r,type:K.fS.number,display:(0,Ze.U_)(),config:{displayNameFromDS:E},labels:g,values:n.map(D=>x?ye(D[1]):D[1])}}function it(n,r){if(r?.legendFormat)return{name:(0,Se.W)((0,Te.J)().replace(r.legendFormat,r?.scopedVars),n),labels:n};const{__name__:x,...g}=n,E=(0,de.aA)(g);let D=`${x??""}${E}`;return D||(D=r.query),{name:D,labels:g}}function ct(n){const r=n.__name__||"";delete n.__name__;const x=Object.entries(n).map(g=>`${g[0]}="${g[1]}"`).join(",");return`${r}{${x}}`}function ze(n){if(n.length===0)return[];const r=n[0].fields.find(g=>g.type===K.fS.time),x=n.map(g=>{let E=g.fields.find(D=>D.type===K.fS.number);return{...E,name:E.config.displayNameFromDS}});return[{...n[0],meta:{...n[0].meta,type:Ee.P.HeatmapRows},fields:[r,...x]}]}function Ye(n){for(let r=n.length-1;r>0;r--){const x=n[r].fields.find(E=>E.name===K.M5),g=n[r-1].fields.find(E=>E.name===K.M5);if(!x||!g)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let E=0;E<x.values.length;E++){const D=g.values[E]||[0];x.values[E]-=D}}return n}function qe(n,r){let x,g;try{x=ye(n.name??n.fields[1].name),g=ye(r.name??r.fields[1].name)}catch(E){return console.error(E),0}return x>g?1:x<g?-1:0}function ye(n){return be.test(n)?n[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(n)}},37462:(ot,Ae,i)=>{i.d(Ae,{WS:()=>$e,el:()=>W,jo:()=>K,pD:()=>Le,x3:()=>h});var h=(b=>(b.Low="Low",b.Medium="Medium",b.High="High",b.None="None",b))(h||{});function W(b){return"values"in b}function $e(b){return b==null||!Array.isArray(b)?!1:b.length?"exemplars"in b[0]:!1}var Le=(b=>(b.Auto="__auto",b.Verbose="__verbose",b.Custom="__custom",b))(Le||{}),K=(b=>(b[b.LabelNames=0]="LabelNames",b[b.LabelValues=1]="LabelValues",b[b.MetricNames=2]="MetricNames",b[b.VarQueryResult=3]="VarQueryResult",b[b.SeriesQuery=4]="SeriesQuery",b))(K||{})},77899:(ot,Ae,i)=>{i.r(Ae),i.d(Ae,{plugin:()=>Et});var h=i(66111),W=i(36873),$e=i(3947),Le=i(99098),K=i(72293),b=i(35645),c=i(40538),Ze=i(34315),de=i(91511),Ee=i(10),Fe=i(90024),z=i(77564),ke=i(9892),Te=i(76095),Se=i(39393),Be=i(87670),be=i(72648),Pe=i(60325),Ie=i(729),Qe=i(3200),He=i(85511),Oe=i(20888),at=i(7211),Re=i(2703),Ue=i(30471),lt=i(52081),nt=i(31403),Xe=i(9398),We=i(16225);const Ke=e=>e.hover.seriesIdx===2?h.createElement(We.H,{data:e.data.exemplars,rowIndex:e.hover.dataIdx,header:"Exemplar"}):h.createElement(je,{...e}),je=({data:e,hover:l,showHistogram:t})=>{const o=l.dataIdx,a=e.heatmap?.fields[0],s=e.heatmap?.fields[1],u=e.heatmap?.fields[2],d=m=>{if(a?.display)return(0,Re.zc)(a.display(m));if(a?.type===Le.fS.time){const v="YYYY-MM-DD HH:mm:ss";return(0,Xe.h4)().getCurrent()?.formatDate(m,v)}return`${m}`},w=a?.values,S=s?.values,B=u?.values,J=(0,z.d8)(e.heatmap),F=s?.display?m=>(0,Re.zc)(s.display(m)):m=>`${m}`,me=o%e.yBucketCount;let _,ue,R;if(J.yOrdinalDisplay){const m=e.yLayout===c.kv.le?me-1:me,v=e.yLayout===c.kv.le?me:me+1;_=m<0?J.yMinDisplay:`${J.yOrdinalDisplay[m]}`,ue=`${J.yOrdinalDisplay[v]}`,(!J.yOrdinalLabel||Number.isNaN(+J.yOrdinalLabel[0]))&&(R=e.yLayout===c.kv.le?ue:_)}else{const m=S?.[me];if(e.yLayout===c.kv.le)if(ue=`${m}`,e.yLog){let te=(e.yLog===2?Math.log2:Math.log10)(m)-1/e.yLogSplit;_=`${e.yLog**te}`}else _=`${m-e.yBucketSize}`;else if(_=`${m}`,e.yLog){let te=(e.yLog===2?Math.log2:Math.log10)(m)+1/e.yLogSplit;ue=`${e.yLog**te}`}else ue=`${m+e.yBucketSize}`}let O,V;e.xLayout===c.kv.le?(V=w?.[o],O=V-e.xBucketSize):(O=w?.[o],V=O+e.xBucketSize);const N=B?.[o],oe=e.heatmap?.fields.filter(m=>!Boolean(m.config.custom?.hideFrom?.tooltip)),U=[],ne=new Set;for(const m of oe??[])if(m.getLinks){const v=m.values[o],te=m.display?m.display(v):{text:`${v}`,numeric:+v};m.getLinks({calculatedValue:te,valueRowIndex:o}).forEach(le=>{const ae=`${le.title}/${le.href}`;ne.has(ae)||(U.push(le),ne.add(ae))})}let H=(0,h.useRef)(null),ee=150,Q=50,ie=Math.round(ee*devicePixelRatio),I=Math.round(Q*devicePixelRatio);(0,h.useEffect)(()=>{if(t){let m=H.current?.getContext("2d");if(m&&w&&S&&B){let v=o;for(;w[v--]===w[o];);v++;let te=v+e.yBucketCount,le=0,ae=v;for(;ae<te;){let C=B[ae];le=Math.max(le,C),ae++}let ce=new Path2D,pe=new Path2D;ae=v;let ge=0;for(;ae<te;){let C=B[ae];if(C>0){let Me=C/le,Ne=ge/(e.yBucketCount+1);(ae===o?ce:pe).rect(Math.round(ie*Ne),Math.round(I*(1-Me)),Math.round(ie/e.yBucketCount),Math.round(I*Me))}ae++,ge++}m.clearRect(0,0,ie,I),m.fillStyle="#ffffff80",m.fill(pe),m.fillStyle="#ff000080",m.fill(ce)}}},[o]);const[xe]=(0,h.useState)(()=>e.heatmap?.meta?.type===Se.P.HeatmapCells&&!(0,z.qJ)(e.heatmap));if(xe)return h.createElement("div",null,h.createElement(We.H,{data:e.heatmap,rowIndex:o}));const ve=()=>{if(R)return h.createElement("div",null,"Name: ",R);switch(e.yLayout){case c.kv.unknown:return h.createElement("div",null,F(_))}return h.createElement("div",null,"Bucket: ",F(_)," - ",F(ue))};return h.createElement(h.Fragment,null,h.createElement("div",null,h.createElement("div",null,d(O)),e.xLayout!==c.kv.unknown&&h.createElement("div",null,d(V))),t&&h.createElement("canvas",{width:ie,height:I,ref:H,style:{width:ie+"px",height:I+"px"}}),h.createElement("div",null,ve(),h.createElement("div",null,(0,Ue.CZ)(u,e.heatmap),": ",e.display(N))),U.length>0&&h.createElement(lt.wc,null,U.map((m,v)=>h.createElement(nt.Qj,{key:v,icon:"external-link-alt",target:m.target,href:m.href,onClick:m.onClick,fill:"text",style:{width:"100%"}},m.title))))};var it=i(17587),ct=i(6194),ze=i(30749),Ye=i(75974),qe=i(23588),ye=i(75133),n=i(56632),r=i(13347),x=i(60892);function g(e){const{dataRef:l,theme:t,eventBus:o,onhover:a,onclick:s,onzoom:u,isToolTipOpen:d,timeZone:w,getTimeRange:S,palette:B,cellGap:J,hideLE:F,hideGE:me,yAxisConfig:_,ySizeDivisor:ue,sync:R}=e,O="x";let V="time",N=!0;l.current?.heatmap?.fields[0].type!==Le.fS.time&&(V=l.current?.heatmap?.fields[0].config?.unit??"x",N=!1);const oe=devicePixelRatio;let U=l.current?.heatmap?.meta?.type;const ne=t.visualization.getColorByName(e.exemplarColor);let H,ee,Q=new r.U(w),ie;Q.addHook("init",f=>{f.root.querySelectorAll(".u-cursor-pt").forEach(y=>{Object.assign(y.style,{borderRadius:"0",border:"1px solid white",background:"transparent"})}),s&&f.over.addEventListener("mouseup",y=>{f.cursor.drag._x||f.cursor.drag._y||s(y)},!0)}),u&&Q.addHook("setSelect",f=>{u({xMin:f.posToVal(f.select.left,O),xMax:f.posToVal(f.select.left+f.select.width,O)}),f.setSelect({left:0,top:0,width:0,height:0},!1)}),N&&Q.addHook("setData",f=>{let{min:y,max:p}=f.scales.x,M=S().from.valueOf(),L=S().to.valueOf();(y!==M||p!==L)&&queueMicrotask(()=>{f.setScale(O,{min:M,max:L})})}),Q.addHook("syncRect",(f,y)=>{ie=y});const I={point:{[V]:null},data:l.current?.heatmap},xe=new qe.es(I);let ve;a&&Q.addHook("setLegend",f=>{if(f.cursor.idxs!=null)for(let y=0;y<f.cursor.idxs.length;y++){const p=f.cursor.idxs[y];if(p!=null){const{left:M,top:L}=f.cursor;I.rowIndex=p,I.point[V]=f.posToVal(M,O),o.publish(xe),d.current||(ve&&(clearTimeout(ve),ve=0),a({seriesIdx:y,dataIdx:p,pageX:ie.left+M,pageY:ie.top+L}));return}}d.current||ve||(ve=setTimeout(()=>{a(null),I.rowIndex=void 0,I.point[V]=null,o.publish(xe)},100))}),Q.addHook("drawClear",f=>{H=H||new x.lW(0,0,f.bbox.width,f.bbox.height),H.clear(),f.series.forEach((y,p)=>{p>0&&(y._paths=null)})}),Q.setMode(2),Q.addScale({scaleKey:O,isTime:N,orientation:c.wN.Horizontal,direction:c.bQ.Right,range:(f,y,p)=>{if(N)return[S().from.valueOf(),S().to.valueOf()];if(l.current?.xLayout===c.kv.le)return[y-l.current?.xBucketSize,p];if(l.current?.xLayout===c.kv.ge)return[y,p+l.current?.xBucketSize];{let M=l.current?.xBucketSize/2;return[y-M,p+M]}}});let m;if(!N){m=[];for(let f=0;f<10;f++)m.push(f*l.current?.xBucketSize)}Q.addAxis({scaleKey:O,placement:c.LB.Bottom,incrs:m,isTime:N,theme:t,timeZone:w});const v=l.current?.heatmap?.fields[1];if(!v)return Q;const le=v.config?.custom?.scaleDistribution??{type:c.wf.Linear},ae=Boolean(_.reverse),ce=U===Se.P.HeatmapCells&&!(0,z.qJ)(l.current?.heatmap),pe=le.type!==c.wf.Linear||ce,ge=(0,z.d8)(l.current?.heatmap).yOrdinalDisplay!=null,C="y_"+(Math.random()+1).toString(36).substring(7);Q.addScale({scaleKey:C,isTime:!1,orientation:c.wN.Vertical,direction:ae?c.bQ.Down:c.bQ.Up,distribution:pe?c.wf.Log:c.wf.Linear,log:le.log??2,range:ce?(f,y,p)=>{let M,L;if([M,L]=pe?Ye.Z.rangeLog(y,p,le.log??2,!0):[y,p],pe&&!ge){let A=f.scales[C].log,se=A===2?Math.log2:Math.log10,{min:X,max:Ge}=_;if(X!=null&&X>0){let et=se(X);M=A**(0,ye.mB)(et,1)}if(Ge!=null&&Ge>0){let et=se(Ge);L=A**(0,ye.UO)(et,1)}}return[M,L]}:(f,y,p)=>{let M=y,L=p,{min:A,max:se}=_;if(pe){let X=f.scales[C].log,Ge=!1,et=!1,rt=X===2?Math.log2:Math.log10;if(ue!==1){let tt=rt(y),mt=rt(p);Number.isInteger(tt)||(M=X**(0,ye.mB)(tt,1),Ge=!0),Number.isInteger(mt)||(L=X**(0,ye.UO)(mt,1),et=!0)}if(l.current?.yLayout===c.kv.le?Ge||(M/=X):l.current?.yLayout===c.kv.ge?et||(L*=X):(M/=X/2,L*=X/2),!ge){if(A!=null&&A>0){let tt=rt(A);M=X**(0,ye.mB)(tt,1)}if(se!=null&&se>0){let tt=rt(se);L=X**(0,ye.UO)(tt,1)}}}else{let X=l.current?.yBucketSize;X===0&&(X=1),X&&(l.current?.yLayout===c.kv.le?M-=X:l.current?.yLayout===c.kv.ge?L+=X:(M-=X/2,L+=X/2)),ge||(M=A??M,L=se??L)}return[M,L]}});const Me=v.display??(0,Re.Cf)("short");Q.addAxis({scaleKey:C,show:_.axisPlacement!==c.LB.Hidden,placement:_.axisPlacement||c.LB.Left,size:_.axisWidth||null,label:_.axisLabel,theme:t,formatValue:(f,y)=>(0,Re.zc)(Me(f,y)),splits:ge?f=>{const y=(0,z.d8)(l.current?.heatmap);if(!y.yOrdinalDisplay)return[0,1];let p=y.yOrdinalDisplay.map((M,L)=>L);switch(l.current?.yLayout){case c.kv.le:p.unshift(-1);break;case c.kv.ge:p.push(p.length);break}if(f.height<60)p=[p[0],p[p.length-1]];else for(;p.length>3&&(f.height-15)/p.length<10;)p=p.filter((M,L)=>L%2===0);return p}:void 0,values:ge?(f,y)=>{const p=(0,z.d8)(l.current?.heatmap);return p.yOrdinalDisplay?y.map(M=>M<0?p.yMinDisplay??"":p.yOrdinalDisplay[M]??""):y}:void 0});const Ne=ce?T:D;Q.addSeries({facets:[{scale:O,auto:!0,sorted:1},{scale:C,auto:!0}],pathBuilder:Ne({each:(f,y,p,M,L,A,se)=>{H.add({x:M-f.bbox.left,y:L-f.bbox.top,w:A,h:se,sidx:y,didx:p})},gap:J,hideLE:F,hideGE:me,xAlign:l.current?.xLayout===c.kv.le?-1:l.current?.xLayout===c.kv.ge?1:0,yAlign:(l.current?.yLayout===c.kv.le?-1:l.current?.yLayout===c.kv.ge?1:0)*(ae?-1:1),ySizeDivisor:ue,disp:{fill:{values:(f,y)=>{let p=ce?3:2;return $(f.data[y][p],B,l.current?.minValue,l.current?.maxValue)},index:B}}}),theme:t,scaleKey:""}),Q.addSeries({facets:[{scale:O,auto:!0,sorted:1},{scale:C,auto:!0}],pathBuilder:j({each:(f,y,p,M,L,A,se)=>{H.add({x:M-f.bbox.left,y:L-f.bbox.top,w:A,h:se,sidx:y,didx:p})}},ne),theme:t,scaleKey:""});const fe={drag:{x:!0,y:!1,setScale:!1},dataIdx:(f,y)=>{if(y===1){ee=null;let p=f.cursor.left*oe,M=f.cursor.top*oe;H.get(p,M,1,1,L=>{(0,x.Pn)(p,M,L.x,L.y,L.x+L.w,L.y+L.h)&&(ee=L)})}return ee&&y===ee.sidx?ee.didx:null},points:{fill:"rgba(255,255,255, 0.3)",bbox:(f,y)=>{let p=ee&&y===ee.sidx;return{left:p?ee.x/oe:-10,top:p?ee.y/oe:-10,width:p?ee.w/oe:0,height:p?ee.h/oe:0}}}};return R&&R()!==n.m.Off&&(fe.sync={key:"__global_",scales:[O,C],filters:{pub:(f,y,p,M,L,A,se)=>(p<0?(I.point[V]=null,o.publish(new qe.xH)):(I.point[V]=y.posToVal(p,O),o.publish(xe)),!0)}},Q.setSync()),Q.setCursor(fe),Q}const E=4;function D(e){const{disp:l,each:t,gap:o=1,hideLE:a=-1/0,hideGE:s=1/0,xAlign:u=1,yAlign:d=1,ySizeDivisor:w=1}=e,S=devicePixelRatio,B=o>=E?Math.round:F=>F,J=Math.round(o*S);return(F,me)=>(Ye.Z.orient(F,me,(_,ue,R,O,V,N,oe,U,ne,H,ee,Q,ie,I,xe)=>{let ve=F.data[me];const m=ve[0],v=ve[1],te=ve[2],le=m.length;let ae=l.fill.values(F,me),ce=l.fill.index??[...new Set(ae)],pe=ce.map(A=>new Path2D),ge=le-v.lastIndexOf(v[0]),C=le/ge,Me=v[1]-v[0]||V.max-V.min,Ne=m[ge]-m[0],fe,f;O.distr===3?fe=Math.abs(N(m[0]*O.log,O,H,U)-N(m[0],O,H,U)):fe=Math.abs(N(Ne,O,H,U)-N(0,O,H,U)),V.distr===3?f=Math.abs(oe(v[0]*V.log,V,ee,ne)-oe(v[0],V,ee,ne))/w:f=Math.abs(oe(Me,V,ee,ne)-oe(0,V,ee,ne))/w,fe=Math.max(1,B(fe-J)),f=Math.max(1,B(f-J));let y=u===-1?-fe:u===0?-fe/2:0,p=d===1?-f:d===0?-f/2:0,M=v.slice(0,ge).map(A=>B(oe(A,V,ee,ne)+p)),L=Array.from({length:C},(A,se)=>B(N(m[se*ge],O,H,U)+y));for(let A=0;A<le;A++)if(te[A]>a&&te[A]<s){let se=L[~~(A/ge)],X=M[A%ge],Ge=pe[ae[A]];I(Ge,se,X,fe,f),t(F,1,A,se,X,fe,f)}return F.ctx.save(),F.ctx.rect(F.bbox.left,F.bbox.top,F.bbox.width,F.bbox.height),F.ctx.clip(),pe.forEach((A,se)=>{F.ctx.fillStyle=ce[se],F.ctx.fill(A)}),F.ctx.restore(),null}),null)}function j(e,l){return(t,o)=>(Ye.Z.orient(t,o,(a,s,u,d,w,S,B,J,F,me,_,ue,R,O,V)=>{let N=new Path2D,oe=[N],U=[l??"rgba(255,0,255,0.7)"];for(let ne=0;ne<s.length;ne++){let H=u[ne];H-=.5;let ee=Math.round(Math.random())*2-1;H+=ee*.5*Math.random();let Q=S(s[ne],d,me,J),ie=B(H,w,_,F),I=8,xe=8;O(N,Q-I/2,ie-xe/2,I,xe),e.each(t,o,ne,Q-I/2,ie-xe/2,I,xe)}t.ctx.save(),t.ctx.rect(t.bbox.left,t.bbox.top,t.bbox.width,t.bbox.height),t.ctx.clip(),oe.forEach((ne,H)=>{t.ctx.fillStyle=U[H],t.ctx.fill(ne)}),t.ctx.restore()}),null)}function T(e){const{disp:l,each:t,gap:o=1,hideLE:a=-1/0,hideGE:s=1/0}=e,u=devicePixelRatio,d=o>=E?Math.round:S=>S,w=Math.round(o*u);return(S,B)=>(Ye.Z.orient(S,B,(J,F,me,_,ue,R,O,V,N,oe,U,ne,H,ee,Q)=>{let ie=S.data[B];const I=ie[0],xe=ie[1],ve=ie[2],m=ie[3],v=I.length;let te=l.fill.values(S,B),le=l.fill.index??[...new Set(te)],ae=le.map(C=>new Path2D),ce=new Map,pe=new Map;for(let C=0;C<I.length;C++){let Me=I[C],Ne=xe[C],fe=ve[C];ce.has(Me)||ce.set(Me,d(R(Me,_,oe,V))),pe.has(Ne)||pe.set(Ne,d(O(Ne,ue,U,N))),pe.has(fe)||pe.set(fe,d(O(fe,ue,U,N)))}let ge=ce.get(I.find(C=>C!==I[0]))-ce.get(I[0]);for(let C=0;C<v;C++){if(m[C]<=a||m[C]>=s)continue;let Me=I[C],Ne=xe[C],fe=ve[C],f=ce.get(Me),y=pe.get(Ne),p=pe.get(fe),M=ge,L=y-p;M=Math.max(1,M-w),L=Math.max(1,L-w);let A=f,se=y,X=ae[te[C]];ee(X,A,se,M,L),t(S,1,C,A,se,M,L)}S.ctx.save(),S.ctx.rect(S.bbox.left,S.bbox.top,S.bbox.width,S.bbox.height),S.ctx.clip(),ae.forEach((C,Me)=>{S.ctx.fillStyle=le[Me],S.ctx.fill(C)}),S.ctx.restore()}),null)}const G=(e,l,t,o=-1/0,a=1/0)=>{if(l==null){l=1/0;for(let s=0;s<e.length;s++)e[s]>o&&e[s]<a&&(l=Math.min(l,e[s]))}if(t==null){t=-1/0;for(let s=0;s<e.length;s++)e[s]>o&&e[s]<a&&(t=Math.max(t,e[s]))}return[l,t]},$=(e,l,t,o)=>{let a=o-t||1,s=l.length,u=Array(e.length);for(let d=0;d<e.length;d++)u[d]=e[d]<t?0:e[d]>o?s-1:Math.min(s-1,Math.floor(s*(e[d]-t)/a));return u};function Z(e,l,t,o,a){if(!e?.length)return{};const s=l?.find(d=>d.name==="exemplar");if(a&&s?.fields.forEach((d,w)=>{s.fields[w].getLinks=a(s,d)}),t.calculate)return q((0,z.xf)(e,t.calculation??{}),s,t,o);let u;for(const d of e)switch(d.meta?.type){case Se.P.HeatmapCells:return(0,z.qJ)(d)?q(d,s,t,o):Ce(d,s,t,o);case Se.P.HeatmapRows:u=d}if(!u)if(e.length>1)e.every(w=>!Number.isNaN((0,ze.Ky)(w.name??w.fields[1].name)))&&e.sort(ze.nf),u=[(0,it._9)({frames:e})][0];else{let d=e[0],w=d.fields.filter(B=>B.type===Le.fS.number);w.every(B=>!Number.isNaN((0,ze.Ky)(B.name)))?(w.sort((B,J)=>(0,ze.Ky)(B.name)-(0,ze.Ky)(J.name)),u={...d,fields:[d.fields.find(B=>B.type===Le.fS.time),...w]}):u=d}return q((0,z.Cj)({unit:t.yAxis?.unit,decimals:t.yAxis?.decimals,...t.rowsFrame,frame:u}),s,t,o)}const Ce=(e,l,t,o)=>{if(e.meta?.type!==Se.P.HeatmapCells||(0,z.qJ)(e))return{warning:"Expected sparse heatmap format",heatmap:e};re(e.fields[1],t.yAxis,o);const a=re(e.fields[3],t.cellValues,o);let[s,u]=G(e.fields[3].values,t.color.min,t.color.max,t.filterValues?.le,t.filterValues?.ge);return{heatmap:e,minValue:s,maxValue:u,exemplars:l,display:d=>(0,Re.zc)(a(d))}},q=(e,l,t,o)=>{if(e.meta?.type!==Se.P.HeatmapCells)return{warning:"Expected heatmap scanlines format",heatmap:e};if(e.fields.length<2||e.length<2)return{heatmap:e};const a=(0,z.d8)(e);let s,u,d;for(const U of e.fields)switch(U.name){case"y":u=U.name;case"yMin":case"yMax":{u||(u=U.name),a.yOrdinalDisplay==null&&re(U,t.yAxis,o);break}case"x":case"xMin":case"xMax":s=U.name;break;default:U.type===Le.fS.number&&!d&&(d=U)}if(!u)return{warning:"Missing Y field",heatmap:e};if(!u)return{warning:"Missing X field",heatmap:e};if(!d)return{warning:"Missing value field",heatmap:e};const w=re(d,t.cellValues,o),S=e.fields[0].values,B=e.fields[1].values,J=S.length;let F=J-B.lastIndexOf(B[0]),me=J/F,_=B[1]-B[0],ue=S[F]-S[0],[R,O]=G(d.values,t.color.min,t.color.max,t.filterValues?.le,t.filterValues?.ge),V=t.calculation?.xBuckets,N=t.calculation?.yBuckets;return{heatmap:e,exemplars:l?.length?l:void 0,xBucketSize:ue,yBucketSize:_,xBucketCount:me,yBucketCount:F,yLog:N?.scale?.log??0,xLog:V?.scale?.log??0,xLogSplit:V?.scale?.log?+(V?.value??"1"):1,yLogSplit:N?.scale?.log?+(N?.value??"1"):1,minValue:R,maxValue:O,xLayout:s==="xMax"?c.kv.le:s==="xMin"?c.kv.ge:c.kv.unknown,yLayout:u==="yMax"?c.kv.le:u==="yMin"?c.kv.ge:c.kv.unknown,display:U=>(0,Re.zc)(w(U))}};function re(e,l,t){if(l?.unit?.length||l?.decimals!=null){const{unit:o,decimals:a}=l;e.display=void 0,e.config={...e.config},o?.length&&(e.config.unit=o),a!=null&&(e.config.decimals=a)}return e.display||(e.display=(0,ct.U_)({field:e,theme:t})),e.display}var De=i(47700),_e=i(65356),Y=i(28550);const we=Object.freeze([0,0]);var P=(e=>(e.Opacity="opacity",e.Scheme="scheme",e))(P||{}),he=(e=>(e.Exponential="exponential",e.Linear="linear",e))(he||{});const Ve={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},showValue:c.Jp.Auto,tooltip:{show:!0,yHistogram:!1}},k={...Ve,color:{...Ve.color,mode:P.Scheme,scale:he.Exponential},yAxis:{...Ve.yAxis,axisPlacement:c.LB.Left},rowsFrame:{...Ve.rowsFrame,layout:c.kv.auto}},Je=[{name:"BrBG",invert:"always"},{name:"PiYG",invert:"always"},{name:"PRGn",invert:"always"},{name:"PuOr",invert:"always"},{name:"RdBu",invert:"always"},{name:"RdGy",invert:"always"},{name:"RdYlBu",invert:"always"},{name:"RdYlGn",invert:"always"},{name:"Spectral",invert:"always"},{name:"Blues",invert:"dark"},{name:"Greens",invert:"dark"},{name:"Greys",invert:"dark"},{name:"Oranges",invert:"dark"},{name:"Purples",invert:"dark"},{name:"Reds",invert:"dark"},{name:"Turbo",invert:"light"},{name:"Cividis",invert:"light"},{name:"Viridis",invert:"light"},{name:"Magma",invert:"light"},{name:"Inferno",invert:"light"},{name:"Plasma",invert:"light"},{name:"Warm",invert:"light"},{name:"Cool",invert:"light"},{name:"Cubehelix",invert:"light",name2:"CubehelixDefault"},{name:"BuGn",invert:"dark"},{name:"BuPu",invert:"dark"},{name:"GnBu",invert:"dark"},{name:"OrRd",invert:"dark"},{name:"PuBuGn",invert:"dark"},{name:"PuBu",invert:"dark"},{name:"PuRd",invert:"dark"},{name:"RdPu",invert:"dark"},{name:"YlGnBu",invert:"dark"},{name:"YlGn",invert:"dark"},{name:"YlOrBr",invert:"dark"},{name:"YlOrRd",invert:"dark"},{name:"Rainbow",invert:"always"},{name:"Sinebow",invert:"always"}],ft=Je.find(e=>e.name==="Spectral");function ut(e,l){const t={...k.color,...e},o=[],a=(t.steps??128)-1;if(e.mode===P.Opacity){const s=(0,Y.Z)(l.visualization.getColorByName(e.fill)).toPercentageRgb(),u=t.scale===he.Exponential?De.scalePow().exponent(t.exponent).domain([0,1]).range([0,1]):De.scaleLinear().domain([0,1]).range([0,1]);for(let d=0;d<=a;d++)s.a=u(d/a),o.push((0,Y.Z)(s).toString("hex8"))}else{const s=Je.find(w=>w.name===t.scheme)??ft;let u="interpolate"+(s.name2??s.name);const d=_e[u];for(let w=0;w<=a;w++){let S=d(w/a),B=S.indexOf("rgb")===0?"#"+[...S.matchAll(/\d+/g)].map(J=>(+J[0]).toString(16).padStart(2,"0")).join(""):S;o.push(B)}(s.invert==="always"||s.invert==="dark"&&l.isDark||s.invert==="light"&&l.isLight)&&o.reverse(),e.reverse&&o.reverse()}return o}const ht=({data:e,id:l,timeRange:t,timeZone:o,width:a,height:s,options:u,fieldConfig:d,eventBus:w,onChangeTimeRange:S,replaceVariables:B})=>{const J=(0,be.l4)(),F=(0,be.wW)(pt),{sync:me}=(0,Pe.R9)();let _=(0,h.useRef)(t);_.current=t;const ue=(0,h.useCallback)((m,v)=>(0,Te.oB)(m,v,v.state?.scopedVars??{},B),[B]),R=(0,h.useMemo)(()=>{try{return Z(e.series,e.annotations,u,J,ue)}catch(m){return{warning:`${m}`}}},[e.series,e.annotations,u,J,ue]),O=(0,h.useMemo)(()=>{let m=[],v=[];const te=(0,z.d8)(R.heatmap);return R.exemplars?.length&&te.yMatchWithLabel&&(m=R.exemplars?.fields[0].values,te.yOrdinalDisplay!=null?v=(R.exemplars?.fields.find(ce=>ce.name===te.yMatchWithLabel).values).map(ce=>te.yOrdinalLabel?.indexOf(ce)):v=R.exemplars?.fields[1].values),[null,R.heatmap?.fields.map(le=>le.values),[m,v]]},[R.heatmap,R.exemplars]),V=(0,h.useMemo)(()=>ut(u.color,J),[u.color,J]),[N,oe]=(0,h.useState)(void 0),[U,ne]=(0,h.useState)(!1),H=(0,h.useRef)(!1),ee=()=>{H.current=!1,ne(!1),ie(null)},Q=()=>{H.current=!H.current,ne(H.current)},ie=(0,h.useCallback)(m=>{oe(m??void 0)},[u,e.structureRev]),I=(0,h.useRef)(R);I.current=R;const xe=(0,h.useMemo)(()=>{const m=I.current?.heatmap?.fields[1].config?.custom?.scaleDistribution;return g({dataRef:I,theme:J,eventBus:w,onhover:ie,onclick:u.tooltip.show?Q:null,onzoom:v=>{v.xMax-v.xMin>1&&S({from:v.xMin,to:v.xMax})},isToolTipOpen:H,timeZone:o,getTimeRange:()=>_.current,sync:me,palette:V,cellGap:u.cellGap,hideLE:u.filterValues?.le,hideGE:u.filterValues?.ge,exemplarColor:u.exemplars?.color??"rgba(255,0,255,0.7)",yAxisConfig:u.yAxis,ySizeDivisor:m?.type===c.wf.Log?+(u.calculation?.yBuckets?.value||1):1})},[u,o,e.structureRev]),ve=()=>{if(!R.heatmap||!u.legend.show)return null;let te=I.current?.heatmap?.meta?.type===Se.P.HeatmapCells&&!(0,z.qJ)(I.current?.heatmap)?3:2;const le=R.heatmap.fields[te];let ae;return N&&R.heatmap.fields&&N.seriesIdx===1&&(ae=le.values[N.dataIdx]),h.createElement(Ie.AY.Legend,{placement:"bottom",maxHeight:"20%"},h.createElement("div",{className:F.colorScaleWrapper},h.createElement(Ee.q,{hoverValue:ae,colorPalette:V,min:I.current.minValue,max:I.current.maxValue,display:R.display})))};return R.warning||!R.heatmap?h.createElement(Be.Z,{panelId:l,fieldConfig:d,data:e,needsNumberField:!0,message:R.warning}):h.createElement(h.Fragment,null,h.createElement(Ie.AY,{width:a,height:s,legend:ve()},(m,v)=>h.createElement(Qe.N,{config:xe,data:O,width:m,height:v,timeRange:t})),h.createElement(He.h_,null,N&&u.tooltip.show&&h.createElement(Oe.S,{position:{x:N.pageX,y:N.pageY},offset:{x:10,y:10},allowPointerEvents:H.current},U&&h.createElement(at.o,{onClick:ee}),h.createElement(Ke,{timeRange:t,data:R,hover:N,showHistogram:u.tooltip.yHistogram}))))},pt=e=>({colorScaleWrapper:ke.css`
    margin-left: 25px;
    padding: 10px 0;
    max-width: 300px;
  `}),gt=e=>Object.keys(e.options).length===0?dt(e,"heatmap",{angular:e},e.fieldConfig):e.options,dt=(e,l,t,o)=>{if(l==="heatmap"&&t.angular){const{fieldConfig:a,options:s}=yt({...t.angular,fieldConfig:o});return e.fieldConfig=a,s}if(l==="heatmap-new"){const{bucketFrame:a,...s}=e.options;return a?{...s,rowsFrame:a}:e.options}return{}};function yt(e){const l={defaults:{},overrides:[]},t=e.dataFormat!=="tsbuckets",o={...k.calculation},a={logBase:1,...e.yAxis};t&&(e.xBucketSize?o.xBuckets={mode:c.kW.Size,value:`${e.xBucketSize}`}:e.xBucketNumber&&(o.xBuckets={mode:c.kW.Count,value:`${e.xBucketNumber}`}),e.yBucketSize?o.yBuckets={mode:c.kW.Size,value:`${e.yBucketSize}`}:e.xBucketNumber&&(o.yBuckets={mode:c.kW.Count,value:`${e.yBucketNumber}`}),a.logBase>1&&(o.yBuckets={mode:c.kW.Count,value:+a.splitFactor>0?`${a.splitFactor}`:void 0,scale:{type:c.wf.Log,log:a.logBase}}));const s=st(e.cards?.cardPadding,2),u={calculate:t,calculation:o,color:{...k.color,steps:128},cellGap:s||1,cellRadius:st(e.cards?.cardRound),yAxis:{axisPlacement:a.show===!1?c.LB.Hidden:c.LB.Left,reverse:Boolean(e.reverseYBuckets),axisWidth:st(a.width),min:a.min,max:a.max,unit:a.format,decimals:a.decimals},cellValues:{decimals:st(e.tooltipDecimals)},rowsFrame:{layout:xt(e.yBucketBound)},legend:{show:Boolean(e.legend?.show)},showValue:c.Jp.Never,tooltip:{show:Boolean(e.tooltip?.show),yHistogram:Boolean(e.tooltip?.showHistogram)},exemplars:{...k.exemplars}};e.hideZeroBuckets&&(u.filterValues={...k.filterValues});const d=e.color??{};switch(d?.mode){case"spectrum":{u.color.mode=P.Scheme;const w=d.colorScheme;let S=Je.find(B=>B.name===w);S||(S=Je.find(B=>w.indexOf(B.name)>=0)),u.color.scheme=S?S.name:k.color.scheme;break}case"opacity":{u.color.mode=P.Opacity,u.color.scale=d.scale;break}}return u.color.fill=d.cardColor,u.color.min=d.min,u.color.max=d.max,typeof d.min=="number"&&typeof d.max=="number"&&d.min>d.max&&(u.color.min=d.max,u.color.max=d.min,u.color.reverse=!0),{fieldConfig:l,options:u}}function xt(e){switch(e){case"upper":return c.kv.ge;case"lower":return c.kv.le;case"middle":return c.kv.unknown}return c.kv.auto}function st(e,l){if(e==null||e==="")return l;const t=+e;return isNaN(t)?l:t}class vt{getSuggestionsForData(l){const{dataSummary:t}=l;if(!l.data?.series||!t.hasData||t.timeFieldCount<1||t.numberFieldCount<2||t.numberFieldCount>10)return;const o=Z(l.data.series,void 0,k,b.v.theme2);!o||o.warning||l.getListAppender({name:"",pluginId:"heatmap",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}})}}const Et=new W.c(ht).useFieldConfig({disableStandardOptions:Object.values($e.qb).filter(e=>e!==$e.qb.Links),useCustomConfig:e=>{e.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Y axis scale",category:["Heatmap"],editor:Ze.Y,override:Ze.Y,defaultValue:{type:c.wf.Linear},shouldApply:l=>l.type===Le.fS.number,process:K.kG,hideFromDefaults:!0}),(0,de.B)(e)}}).setPanelChangeHandler(dt).setMigrationHandler(gt).setPanelOptions((e,l)=>{const t=l.options??k;let o=!1;try{const s=Z(l.data,void 0,t,b.v.theme2);o=(0,z.d8)(s.heatmap).yOrdinalDisplay!=null}catch{}let a=["Heatmap"];e.addRadio({path:"calculate",name:"Calculate from data",defaultValue:k.calculate,category:a,settings:{options:[{label:"Yes",value:!0},{label:"No",value:!1}]}}),t.calculate&&(0,Fe.J)("calculation.",e,t.calculation,a),a=["Y Axis"],e.addRadio({path:"yAxis.axisPlacement",name:"Placement",defaultValue:k.yAxis.axisPlacement??c.LB.Left,category:a,settings:{options:[{label:"Left",value:c.LB.Left},{label:"Right",value:c.LB.Right},{label:"Hidden",value:c.LB.Hidden}]}}).addUnitPicker({category:a,path:"yAxis.unit",name:"Unit",defaultValue:void 0,settings:{isClearable:!0}}).addNumberInput({category:a,path:"yAxis.decimals",name:"Decimals",settings:{placeholder:"Auto"}}),o||e.addNumberInput({path:"yAxis.min",name:"Min value",settings:{placeholder:"Auto"},category:a}).addTextInput({path:"yAxis.max",name:"Max value",settings:{placeholder:"Auto"},category:a}),e.addNumberInput({path:"yAxis.axisWidth",name:"Axis width",defaultValue:k.yAxis.axisWidth,settings:{placeholder:"Auto",min:5},category:a}).addTextInput({path:"yAxis.axisLabel",name:"Axis label",defaultValue:k.yAxis.axisLabel,settings:{placeholder:"Auto"},category:a}),t.calculate||e.addRadio({path:"rowsFrame.layout",name:"Tick alignment",defaultValue:k.rowsFrame?.layout??c.kv.auto,category:a,settings:{options:[{label:"Auto",value:c.kv.auto},{label:"Top (LE)",value:c.kv.le},{label:"Middle",value:c.kv.unknown},{label:"Bottom (GE)",value:c.kv.ge}]}}),e.addBooleanSwitch({path:"yAxis.reverse",name:"Reverse",defaultValue:k.yAxis.reverse===!0,category:a}),a=["Colors"],e.addRadio({path:"color.mode",name:"Mode",defaultValue:k.color.mode,category:a,settings:{options:[{label:"Scheme",value:P.Scheme},{label:"Opacity",value:P.Opacity}]}}),e.addColorPicker({path:"color.fill",name:"Color",defaultValue:k.color.fill,category:a,showIf:s=>s.color.mode===P.Opacity}),e.addRadio({path:"color.scale",name:"Scale",defaultValue:k.color.scale,category:a,settings:{options:[{label:"Exponential",value:he.Exponential},{label:"Linear",value:he.Linear}]},showIf:s=>s.color.mode===P.Opacity}),e.addSliderInput({path:"color.exponent",name:"Exponent",defaultValue:k.color.exponent,category:a,settings:{min:.1,max:2,step:.1},showIf:s=>s.color.mode===P.Opacity&&s.color.scale===he.Exponential}),e.addSelect({path:"color.scheme",name:"Scheme",description:"",defaultValue:k.color.scheme,category:a,settings:{options:Je.map(s=>({value:s.name,label:s.name}))},showIf:s=>s.color.mode!==P.Opacity}),e.addSliderInput({path:"color.steps",name:"Steps",defaultValue:k.color.steps,category:a,settings:{min:2,max:128,step:1}}).addBooleanSwitch({path:"color.reverse",name:"Reverse",defaultValue:k.color.reverse,category:a}).addCustomEditor({id:"__scale__",path:"__scale__",name:"",category:a,editor:()=>{const s=ut(t.color,b.v.theme2);return h.createElement("div",null,h.createElement(Ee.q,{colorPalette:s,min:1,max:100}))}}),e.addNumberInput({path:"color.min",name:"Start color scale from value",defaultValue:k.color.min,settings:{placeholder:"Auto (min)"},category:a}).addNumberInput({path:"color.max",name:"End color scale at value",defaultValue:k.color.max,settings:{placeholder:"Auto (max)"},category:a}),a=["Cell display"],t.calculate||e.addTextInput({path:"rowsFrame.value",name:"Value name",defaultValue:k.rowsFrame?.value,settings:{placeholder:"Value"},category:a}),e.addUnitPicker({category:a,path:"cellValues.unit",name:"Unit",defaultValue:void 0,settings:{isClearable:!0}}).addNumberInput({category:a,path:"cellValues.decimals",name:"Decimals",settings:{placeholder:"Auto"}}),e.addSliderInput({name:"Cell gap",path:"cellGap",defaultValue:k.cellGap,category:a,settings:{min:0,max:25}}).addNumberInput({path:"filterValues.le",name:"Hide cells with values <=",defaultValue:k.filterValues?.le,settings:{placeholder:"None"},category:a}).addNumberInput({path:"filterValues.ge",name:"Hide cells with values >=",defaultValue:k.filterValues?.ge,settings:{placeholder:"None"},category:a}),a=["Tooltip"],e.addBooleanSwitch({path:"tooltip.show",name:"Show tooltip",defaultValue:k.tooltip.show,category:a}),e.addBooleanSwitch({path:"tooltip.yHistogram",name:"Show histogram (Y axis)",defaultValue:k.tooltip.yHistogram,category:a,showIf:s=>s.tooltip.show}),a=["Legend"],e.addBooleanSwitch({path:"legend.show",name:"Show legend",defaultValue:k.legend.show,category:a}),a=["Exemplars"],e.addColorPicker({path:"exemplars.color",name:"Color",defaultValue:k.exemplars.color,category:a})}).setSuggestionsSupplier(new vt)}}]);

//# sourceMappingURL=heatmapPanel.bf4878d322d7f2ef4785.js.map