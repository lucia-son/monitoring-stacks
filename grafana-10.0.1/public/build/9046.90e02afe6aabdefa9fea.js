"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9046],{20172:(go,je,v)=>{v.r(je),v.d(je,{plugin:()=>no});var kt=v(89424),At=v(23588),Tt=v(82378),o=v(66111),Nt=v(73446),P=v(20308),Me=v(54899),H=v(45253),Mt=v(12580),Rt=v(47694),w=v(82897),ye=v.n(w),Re=v(47891);class x{static createISO8601Duration(e,r){const s=["hour","minute","h","m"];return(0,w.includes)(s,r)?`PT${e}${r[0].toUpperCase()}`:`P${e}${r[0].toUpperCase()}`}static createISO8601DurationFromInterval(e){const r=+e.slice(0,e.length-1),s=e[e.length-1];if(e.indexOf("ms")>-1)return x.createISO8601Duration(1,"m");if(e[e.length-1]==="s"){let a=r*60%60;return a<1&&(a=1),x.createISO8601Duration(a,"m")}return x.createISO8601Duration(r,s)}static findClosestTimeGrain(e,r){const s=(0,w.filter)(r,c=>c!=="auto");let a=s[0];const i=Re.intervalToMs(e);for(let c=0;c<s.length;c++)i>Re.intervalToMs(s[c])&&(c+1<s.length?a=s[c+1]:a=s[c]);return a}static createTimeGrainFromISO8601Duration(e){let r=1;e.substring(0,2)==="PT"&&(r=2);const s=e.substring(r,e.length-1),a=e.substring(e.length-1);return s+" "+x.timeUnitToText(+s,a)}static timeUnitToText(e,r){let s="";return r==="S"&&(s="second"),r==="M"&&(s="minute"),r==="H"&&(s="hour"),r==="D"&&(s="day"),e>1?s+"s":s}static createKbnUnitFromISO8601Duration(e){if(e==="auto")return"auto";let r=1;e.substring(0,2)==="PT"&&(r=2);const s=e.substring(r,e.length-1),a=e.substring(e.length-1);return s+x.timeUnitToKbn(+s,a)}static timeUnitToKbn(e,r){return r==="S"?"s":r==="M"?"m":r==="H"?"h":r==="D"?"d":""}}class ${static parseResponseValues(e,r,s){const a=[];if(!e)return a;for(let i=0;i<e.value.length;i++)if(!(0,w.find)(a,["value",(0,w.get)(e.value[i],s)])){const c=(0,w.get)(e.value[i],s),n=(0,w.get)(e.value[i],r,c);a.push({text:n,value:c})}return a}static parseResourceNames(e,r){const s=[];if(!e)return s;for(let a=0;a<e.value.length;a++)typeof e.value[a].type=="string"&&(!r||e.value[a].type.toLocaleLowerCase()===r.toLocaleLowerCase())&&s.push({text:e.value[a].name,value:e.value[a].name});return s}static parseMetadata(e,r){const s=["None","Average","Minimum","Maximum","Total","Count"],a=e?.value.find(i=>i.name.value===r);return a?{primaryAggType:a.primaryAggregationType,supportedAggTypes:a.supportedAggregationTypes||s,supportedTimeGrains:[{label:"Auto",value:"auto"},...$.parseTimeGrains(a.metricAvailabilities??[])],dimensions:$.parseDimensions(a.dimensions??[])}:{primaryAggType:"",supportedAggTypes:s,supportedTimeGrains:[],dimensions:[]}}static parseTimeGrains(e){const r=[];return e&&e.forEach(s=>{s.timeGrain&&r.push({label:x.createTimeGrainFromISO8601Duration(s.timeGrain),value:s.timeGrain})}),r}static parseDimensions(e){return e.map(r=>({label:r.localizedValue||r.value,value:r.value}))}static parseSubscriptions(e){const r=[];if(!e)return r;const s="subscriptionId",a="displayName";for(let i=0;i<e.value.length;i++)(0,w.find)(r,["value",(0,w.get)(e.value[i],s)])||r.push({text:`${(0,w.get)(e.value[i],a)}`,value:(0,w.get)(e.value[i],s)});return r}static parseSubscriptionsForSelect(e){const r=[];if(!e)return r;const s="subscriptionId",a="displayName";for(let i=0;i<e.data.value.length;i++)(0,w.find)(r,["value",(0,w.get)(e.data.value[i],s)])||r.push({label:`${(0,w.get)(e.data.value[i],a)} - ${(0,w.get)(e.data.value[i],s)}`,value:(0,w.get)(e.data.value[i],s)});return r}static parseWorkspacesForSelect(e){const r=[];if(!e)return r;const s="customerId",a="name";for(let i=0;i<e.data.value.length;i++)(0,w.find)(r,["value",(0,w.get)(e.data.value[i].properties,s)])||r.push({label:(0,w.get)(e.data.value[i],a),value:(0,w.get)(e.data.value[i].properties,s)});return r}static parseLocations(e){const r=[];if(!e)return r;for(const s of e.value)r.push({name:s.name,displayName:s.displayName,supportsLogs:void 0});return r}}const Ct=(t,e)=>t.some(r=>r.options?Ct(r.options,e):r.value===e),Ce=(t,e=[])=>{if(e.length===0)return[];const r=e.reduce((s,a)=>(s.add(a),s),new Set);return t.filter(s=>r.has(s.value))},It=t=>({value:t.value,label:t.text}),J=(t,e,r)=>{const s=[...t,e],a=t.map(i=>i.value.toLowerCase()).concat(e.options.map(i=>i.value));return r&&!a.includes(r.toLowerCase())&&s.push({label:r,value:r}),s};function ho(t){const e=[];return t.forEach(r=>{r.value!=="auto"&&e.push(rangeUtil.intervalToMs(TimegrainConverter.createKbnUnitFromISO8601Duration(r.value)))}),e}const Y={azureMonitor:"azuremonitor",logAnalytics:"loganalytics",appInsights:"appinsights",resourceGraph:"resourcegraph"};function le(t,e){return typeof t=="string"?e.multi||e.includeAll&&!e.allValue?"'"+t+"'":t:typeof t=="number"?t:(0,w.map)(t,s=>typeof t=="number"?t:"'"+s+"'").join(",")}var re=v(35645),bo=v(89829);const vo=Object.freeze([0,0]),yo={subscriptions:[]};var m=(t=>(t.AzureMonitor="Azure Monitor",t.AzureResourceGraph="Azure Resource Graph",t.AzureTraces="Azure Traces",t.GrafanaTemplateVariableFn="Grafana Template Variable Function",t.LocationsQuery="Azure Regions",t.LogAnalytics="Azure Log Analytics",t.MetricNamesQuery="Azure Metric Names",t.NamespacesQuery="Azure Namespaces",t.ResourceGroupsQuery="Azure Resource Groups",t.ResourceNamesQuery="Azure Resource Names",t.SubscriptionsQuery="Azure Subscriptions",t.WorkspacesQuery="Azure Workspaces",t))(m||{});const wo={allowedTimeGrainsMs:[],dimensionFilters:[],resources:[]},So={resources:[]},zo={filters:[],resources:[],traceTypes:[]},Eo={filters:[]};var j=(t=>(t.Table="table",t.TimeSeries="time_series",t.Trace="trace",t))(j||{});const ko={filters:[]};var me=(t=>(t.Public="AzureCloud",t.China="AzureChinaCloud",t.USGovernment="AzureUSGovernment",t.None="",t))(me||{});const Ft=Symbol("Concealed client secret");function we(t){return t.jsonData.azureAuthType?t.jsonData.azureAuthType:t.jsonData.tenantId&&t.jsonData.clientId?"clientsecret":re.v.azure.managedIdentityEnabled?"msi":"clientsecret"}function pe(){switch(re.v.azure.cloud){case me.Public:case me.None:case void 0:return"azuremonitor";case me.China:return"chinaazuremonitor";case me.USGovernment:return"govazuremonitor";default:throw new Error(`The cloud '${re.v.azure.cloud}' not supported.`)}}function Be(t){switch(t){case"azuremonitor":return"https://portal.azure.com";case"chinaazuremonitor":return"https://portal.azure.cn";case"govazuremonitor":return"https://portal.azure.us";default:throw new Error("The cloud not supported.")}}function He(t){switch(we(t)){case"msi":return pe();case"clientsecret":return t.jsonData.cloudName||pe()}}function Gt(t){if(t.secureJsonFields.clientSecret)return Ft;{const e=t.secureJsonData?.clientSecret;return typeof e=="string"&&e.length>0?e:void 0}}function Dt(t){switch(t.authType){case"msi":return!0;case"clientsecret":return!!(t.azureCloud&&t.tenantId&&t.clientId&&t.clientSecret)}}function Lt(t){switch(we(t)){case"msi":return re.v.azure.managedIdentityEnabled?{authType:"msi"}:{authType:"clientsecret",azureCloud:pe()};case"clientsecret":return{authType:"clientsecret",azureCloud:t.jsonData.cloudName||pe(),tenantId:t.jsonData.tenantId,clientId:t.jsonData.clientId,clientSecret:Gt(t)}}}function Qt(t,e){switch(e.authType){case"msi":if(!re.v.azure.managedIdentityEnabled)throw new Error("Managed Identity authentication is not enabled in Grafana config.");return t={...t,jsonData:{...t.jsonData,azureAuthType:"msi"}},t;case"clientsecret":return t={...t,jsonData:{...t.jsonData,azureAuthType:"clientsecret",cloudName:e.azureCloud||pe(),tenantId:e.tenantId,clientId:e.clientId},secureJsonData:{...t.secureJsonData,clientSecret:typeof e.clientSecret=="string"?e.clientSecret:void 0},secureJsonFields:{...t.secureJsonFields,clientSecret:typeof e.clientSecret=="symbol"}},t}}var Pt=v(14835),I=v(81764),C=v(8581),q=v(31403);const T={components:{configEditor:{authType:{select:"data-testid auth-type"},azureCloud:{input:"data-testid azure-cloud"},tenantID:{input:"data-testid tenant-id"},clientID:{input:"data-testid client-id"},clientSecret:{input:"data-testid client-secret"},loadSubscriptions:{button:"data-testid load-subscriptions"},defaultSubscription:{input:"data-testid default-subscription"}},queryEditor:{header:{select:"data-testid azure-monitor-experimental-header"},resourcePicker:{select:{button:"data-testid resource-picker-select"},search:{input:"data-testid resource-picker-search"},apply:{button:"data-testid resource-picker-apply"},cancel:{button:"data-testid resource-picker-cancel"},advanced:{collapse:"data-testid resource-picker-advanced",subscription:{input:"data-testid resource-picker-subscription"},resourceGroup:{input:"data-testid resource-picker-resource-group"},namespace:{input:"data-testid resource-picker-namespace"},region:{input:"data-testid resource-picker-region"},resource:{input:"data-testid resource-picker-resource"}}},metricsQueryEditor:{container:{input:"data-testid azure-monitor-metrics-query-editor-with-experimental-ui"},metricName:{input:"data-testid metric-name"}},logsQueryEditor:{container:{input:"data-testid azure-monitor-logs-query-editor-with-experimental-ui"},formatSelection:{input:"data-testid format-selection"}},argsQueryEditor:{container:{input:"data-testid azure-monitor-arg-query-editor"},subscriptions:{input:"data-testid azure-monitor-args-subscription"}},tracesQueryEditor:{container:{input:"data-testid azure-monitor-traces-query-editor-with-experimental-ui"},traceTypes:{select:"data-testid azure-monitor-traces-query-editor-trace-types"}}},variableEditor:{queryType:{input:"data-testid query-type"},subscription:{input:"data-testid subscription"},resourceGroup:{input:"data-testid resource-group"},namespace:{input:"data-testid namespace"},resource:{input:"data-testid resource"},region:{input:"data-testid region"}}}},{Input:Se}=Pt.LegacyForms,Je=[{value:"msi",label:"Managed Identity"},{value:"clientsecret",label:"App Registration"}],se=18,Vt=t=>{const{credentials:e,azureCloudOptions:r,onCredentialsChange:s,disabled:a,managedIdentityEnabled:i}=t,c=d=>{if(s){const h={...e,authType:d.value||"msi"};s(h)}},n=d=>{if(s&&e.authType==="clientsecret"){const h={...e,azureCloud:d.value};s(h)}},u=d=>{if(s&&e.authType==="clientsecret"){const h={...e,tenantId:d.target.value};s(h)}},l=d=>{if(s&&e.authType==="clientsecret"){const h={...e,clientId:d.target.value};s(h)}},p=d=>{if(s&&e.authType==="clientsecret"){const h={...e,clientSecret:d.target.value};s(h)}},g=()=>{if(s&&e.authType==="clientsecret"){const d={...e,clientSecret:""};s(d)}};return o.createElement("div",{className:"gf-form-group"},i&&o.createElement(I._,{label:"Authentication",labelWidth:se,tooltip:"Choose the type of authentication to Azure services","data-testid":T.components.configEditor.authType.select,htmlFor:"authentication-type"},o.createElement(C.Ph,{className:"width-15",value:Je.find(d=>d.value===e.authType),options:Je,onChange:c,disabled:a})),e.authType==="clientsecret"&&o.createElement(o.Fragment,null,r&&o.createElement(I._,{label:"Azure Cloud",labelWidth:se,tooltip:"Choose an Azure Cloud","data-testid":T.components.configEditor.azureCloud.input,htmlFor:"azure-cloud-type",disabled:a},o.createElement(C.Ph,{inputId:"azure-cloud-type","aria-label":"Azure Cloud",className:"width-15",value:r.find(d=>d.value===e.azureCloud),options:r,onChange:n})),o.createElement(I._,{label:"Directory (tenant) ID",labelWidth:se,"data-testid":T.components.configEditor.tenantID.input,htmlFor:"tenant-id"},o.createElement("div",{className:"width-15"},o.createElement(Se,{"aria-label":"Tenant ID",className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:e.tenantId||"",onChange:u,disabled:a}))),o.createElement(I._,{label:"Application (client) ID",labelWidth:se,"data-testid":T.components.configEditor.clientID.input,htmlFor:"tenant-id"},o.createElement("div",{className:"width-15"},o.createElement(Se,{className:"width-30","aria-label":"Client ID",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:e.clientId||"",onChange:l,disabled:a}))),!a&&(typeof e.clientSecret=="symbol"?o.createElement(I._,{label:"Client Secret",labelWidth:se,htmlFor:"client-secret"},o.createElement("div",{className:"width-30",style:{display:"flex",gap:"4px"}},o.createElement(Se,{"aria-label":"Client Secret",placeholder:"configured",disabled:!0,"data-testid":"client-secret"}),o.createElement(q.zx,{variant:"secondary",type:"button",onClick:g,disabled:a},"Reset"))):o.createElement(I._,{label:"Client Secret",labelWidth:se,"data-testid":T.components.configEditor.clientSecret.input,htmlFor:"client-secret"},o.createElement(Se,{className:"width-30","aria-label":"Client Secret",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:e.clientSecret||"",onChange:p,id:"client-secret",disabled:a})))),t.children)},To=null,xt=18,$t=t=>{const{credentials:e,disabled:r,options:s,subscriptions:a,getSubscriptions:i,onSubscriptionChange:c,onSubscriptionsChange:n}=t,u=Dt(e),[l,p]=(0,o.useReducer)(h=>h+1,0);(0,o.useEffect)(()=>{if(!i||!u){g([]);return}let h=!1;return i().then(y=>{h||g(y,l)}),()=>{h=!0}},[l]);const g=(h,y=!1)=>{n(h),i&&(y&&!s.subscriptionId&&h.length>0?d(h[0]):s.subscriptionId&&(h.find(b=>b.value===s.subscriptionId)||d(void 0)))},d=h=>c(h?.value);return o.createElement(o.Fragment,null,o.createElement(I._,{label:"Default Subscription",labelWidth:xt,"data-testid":T.components.configEditor.defaultSubscription.input,htmlFor:"default-subscription"},o.createElement("div",{className:"width-30",style:{display:"flex",gap:"4px"}},o.createElement(C.Ph,{inputId:"default-subscription","aria-label":"Default Subscription",value:s.subscriptionId?a.find(h=>h.value===s.subscriptionId):void 0,options:a,onChange:d,disabled:r}),o.createElement(q.zx,{variant:"secondary",type:"button",onClick:p,disabled:!u||r,"data-testid":T.components.configEditor.loadSubscriptions.button},"Load Subscriptions"))))},Wt=[{value:"azuremonitor",label:"Azure"},{value:"govazuremonitor",label:"Azure US Government"},{value:"chinaazuremonitor",label:"Azure China"}],Ut=t=>{const{updateOptions:e,getSubscriptions:r,options:s}=t,[a,i]=(0,o.useState)([]),c=(0,o.useMemo)(()=>Lt(t.options),[t.options]),n=(p,g)=>{g||i([]),e(d=>Qt({...d,jsonData:{...d.jsonData,subscriptionId:g}},p))},u=p=>i(p),l=p=>e(g=>({...g,jsonData:{...g.jsonData,subscriptionId:p}}));return o.createElement(o.Fragment,null,o.createElement("h3",{className:"page-heading"},"Authentication"),o.createElement(Vt,{managedIdentityEnabled:re.v.azure.managedIdentityEnabled,credentials:c,azureCloudOptions:Wt,onCredentialsChange:n,disabled:t.options.readOnly},o.createElement($t,{subscriptions:a,credentials:c,getSubscriptions:r,disabled:t.options.readOnly,onSubscriptionsChange:u,onSubscriptionChange:l,options:s.jsonData})))},No=null;class Ot extends o.PureComponent{constructor(e){super(e),this.templateSrv=(0,P.J)(),this.updateOptions=r=>{const s=r(this.props.options);this.props.onOptionsChange(s),this.setState({unsaved:!0})},this.saveOptions=async()=>{this.state.unsaved&&(await(0,Me.i)().put(`/api/datasources/${this.props.options.id}`,this.props.options).then(r=>{(0,Nt.fd)(this.props,"version",r.datasource.version)}),this.setState({unsaved:!1}))},this.getSubscriptions=async()=>{await this.saveOptions();const r="?api-version=2019-03-01";try{const s=await(0,Me.i)().fetch({url:this.baseURL+r,method:"GET"}).toPromise();return this.setState({error:void 0}),$.parseSubscriptionsForSelect(s)}catch(s){return(0,Me.kW)(s)&&this.setState({error:{title:"Error requesting subscriptions",description:"Could not request subscriptions from Azure. Check your credentials and try again.",details:s?.data?.message}}),Promise.resolve([])}},this.state={unsaved:!1},this.baseURL=`/api/datasources/${this.props.options.id}/resources/${Y.azureMonitor}/subscriptions`}render(){const{options:e,onOptionsChange:r}=this.props,{error:s}=this.state;return o.createElement(o.Fragment,null,o.createElement(Ut,{options:e,updateOptions:this.updateOptions,getSubscriptions:this.getSubscriptions}),s&&o.createElement(H.b,{severity:"error",title:s.title},o.createElement("p",null,s.description),s.details&&o.createElement("details",{style:{whiteSpace:"pre-wrap"}},s.details)),Rt.vc.secureSocksDSProxyEnabled&&o.createElement(Mt.i,{options:e,onOptionsChange:r}))}}const Mo=null;var Ie=v(9405);function Xt(t){return(0,o.isValidElement)(t)?t:oe(t)}function oe(t){if(!t||typeof t!="object")return;if(typeof t.message=="string")return t.message;if(typeof t.data?.error?.message=="string")return t.data.error.message;const e=t.error?.data?.error?.innererror?.innererror?.message||t.error?.data?.error?.innererror?.message||t.error?.data?.error?.message||t.error?.data?.message||t.data?.message||t;if(typeof e=="string")return e;if(e&&e.toString)return e.toString()}function Ke(){const[t,e]=(0,o.useState)([]),r=(0,o.useCallback)((a,i)=>{e(c=>{const n=[...c],u=c.findIndex(([l])=>l===a);return u>-1&&n.splice(u,1),i&&n.unshift([a,i]),n})},[]);return[(0,o.useMemo)(()=>{const a=t[0];return a&&Xt(a[1])},[t]),r]}var A=v(26418);const jt=({query:t,onQueryChange:e})=>{const r=(0,o.useCallback)(s=>{e({...t,azureResourceGraph:{...t.azureResourceGraph,query:s}})},[e,t]);return o.createElement(Ie.p,{value:t.azureResourceGraph?.query??"",language:"kusto",height:200,width:"100%",showMiniMap:!1,onBlur:r,onSave:r})};var Bt=v(57227);const Ze=18,W=t=>{const{labelWidth:e,inlineField:r,...s}=t;return r?o.createElement(I._,{labelWidth:e||Ze,...s}):o.createElement(A.EditorField,{width:e||Ze,...s})},Ht=({query:t,subscriptions:e,variableOptionGroup:r,onQueryChange:s})=>{const[a,i]=(0,o.useState)(!1),[c,n]=(0,o.useState)([]),u=(0,o.useMemo)(()=>[...e,r],[e,r]);(0,o.useEffect)(()=>{t.subscriptions&&t.subscriptions.length>0?(n(Ce([...e,...r.options],t.subscriptions)),i(!1)):i(!0)},[t.subscriptions,e,r.options]);const l=p=>{if(!p||p.length===0)n([]),s({...t,subscriptions:[]}),i(!0);else{const g=p.map(d=>d.value??"");s({...t,subscriptions:g}),n(Ce([...e,...r.options],g)),i(!1)}};return o.createElement(W,{label:"Subscriptions","data-testid":T.components.queryEditor.argsQueryEditor.subscriptions.input},o.createElement(o.Fragment,null,o.createElement(C.NU,{isClearable:!0,value:c,inputId:"azure-monitor-subscriptions-field",onChange:l,options:u,width:38}),a?o.createElement(Bt.S,null,"At least one subscription must be chosen."):null))},Ye="arg-subscriptions";function Jt(t,e,r){let s=e||[];s.length===0&&r&&(s=[r]),s.length===0&&t.length&&(s=[t[0]]);const a=s.filter(c=>c.includes("$")),i=(0,w.intersection)(s,t).concat(a);return t.length&&s.length>i.length&&(s=i.length>0?i:[t[0]]),s}const qe=({query:t,datasource:e,subscriptionId:r,variableOptionGroup:s,onChange:a,setError:i})=>{const[c,n]=(0,o.useState)([]);return(0,o.useMemo)(()=>{e.getSubscriptions().then(u=>{const l=u.map(p=>({label:p.text,value:p.value,description:p.value}));n(l),i(Ye,void 0),a({...t,subscriptions:Jt(l.map(p=>p.value),t.subscriptions,t.subscription)})}).catch(u=>i(Ye,u))},[e]),o.createElement("span",{"data-testid":T.components.queryEditor.argsQueryEditor.container.input},o.createElement(A.EditorRows,null,o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,o.createElement(Ht,{subscriptions:c,query:t,datasource:e,subscriptionId:r,variableOptionGroup:s,onQueryChange:a,setError:i})))),o.createElement(jt,{query:t,datasource:e,subscriptionId:r,variableOptionGroup:s,onQueryChange:a,setError:i}))};var Fe=v(49380);const _e=({query:t,variableOptionGroup:e,onQueryChange:r,inputId:s,options:a,defaultValue:i,setFormatAs:c,resultFormat:n})=>{const u=(0,o.useMemo)(()=>[...a,e],[e,a]),l=(0,o.useCallback)(p=>{const{value:g}=p;if(!g)return;const d=c(t,g);r(d)},[r,t,c]);return(0,Fe.Z)(()=>{n?a.find(p=>p.value===n)||l({value:i}):l({value:i})}),o.createElement(W,{label:"Format as","data-testid":T.components.queryEditor.logsQueryEditor.formatSelection.input},o.createElement(C.Ph,{inputId:`${s}-format-as-field`,value:n??i,onChange:l,options:u,width:38}))};var k=v(9892),B=v(72648),Kt=v(35029),K=v(39904),et=v(61744),Zt=v(7804);const Q=t=>{const e=(0,B.l4)(),r=Yt(e,t);return o.createElement("span",{className:(0,k.cx)(r.wrapper)})};Q.defaultProps={v:0,h:0,layout:"block"};const Yt=(0,Zt.B)((t,e)=>({wrapper:(0,k.css)([{paddingRight:t.spacing(e.h??0),paddingBottom:t.spacing(e.v??0)},e.layout==="inline"&&{display:"inline-block"},e.layout==="block"&&{display:"block"}])}));var qt=v(2352);const _t=({resources:t,onChange:e,renderAdvanced:r})=>{const[s,a]=(0,o.useState)(!!t.length&&JSON.stringify(t).includes("$"));return o.createElement("div",{"data-testid":T.components.queryEditor.resourcePicker.advanced.collapse},o.createElement(qt.U,{collapsible:!0,label:"Advanced",isOpen:s,onToggle:()=>a(!s)},r(t,e),o.createElement(Q,{v:2})))};var er=v(19801),tr=v(8180),tt=v(58255),R=(t=>(t.Subscription="Subscription",t.ResourceGroup="ResourceGroup",t.Resource="Resource",t.VariableGroup="TemplateVariableGroup",t.Variable="TemplateVariable",t))(R||{});const rr=({isOpen:t,entry:{type:e}})=>{switch(e){case R.Subscription:return o.createElement(K.J,{name:"layer-group"});case R.ResourceGroup:return o.createElement(K.J,{name:t?"folder-open":"folder"});case R.Resource:return o.createElement(K.J,{name:"cube"});case R.VariableGroup:return o.createElement(K.J,{name:"x"});case R.Variable:return o.createElement(K.J,{name:"x"});default:return null}},de=t=>({table:(0,k.css)({width:"100%",tableLayout:"fixed"}),tableScroller:(0,k.css)({maxHeight:"50vh",overflow:"auto"}),header:(0,k.css)({background:t.colors.background.secondary}),row:(0,k.css)({borderBottom:`1px solid ${t.colors.border.weak}`,"&:last-of-type":{borderBottomColor:t.colors.border.medium}}),disabledRow:(0,k.css)({opacity:.5}),cell:(0,k.css)({padding:t.spacing(1,1,1,0),width:"25%",overflow:"hidden",textOverflow:"ellipsis","&:first-of-type":{width:"50%",padding:t.spacing(1,1,1,2)}}),collapseButton:(0,k.css)({margin:0}),loadingCell:(0,k.css)({textAlign:"center"}),spinner:(0,k.css)({marginBottom:0}),nestedEntry:(0,k.css)({display:"flex",alignItems:"center"}),entryContentItem:(0,k.css)({margin:t.spacing(0,1,0,0)}),truncated:(0,k.css)({minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),resourceField:(0,k.css)({maxWidth:t.spacing(36),overflow:"hidden"}),resourceFieldButton:(0,k.css)({padding:"7px",textAlign:"left"}),nestedRowCheckbox:(0,k.css)({zIndex:0}),selectionFooter:(0,k.css)({position:"sticky",bottom:0,background:t.colors.background.primary,paddingTop:t.spacing(2)}),loadingWrapper:(0,k.css)({textAlign:"center",paddingTop:t.spacing(2),paddingBottom:t.spacing(2),color:t.colors.text.secondary}),resultLimit:(0,k.css)({margin:"4px 0",fontStyle:"italic"}),modal:(0,k.css)({width:t.breakpoints.values.lg})}),sr=({entry:t,isSelected:e,isDisabled:r,isOpen:s,isSelectable:a,level:i,scrollIntoView:c,onToggleCollapse:n,onSelectedChange:u})=>{const l=(0,B.l4)(),p=(0,B.wW)(de),g=!!t.children,d=(0,o.useCallback)(()=>{n(t)},[n,t]),h=(0,o.useCallback)(f=>{const b=f.target.checked;u(t,b)},[t,u]),y=`${c?"table":"summary"}_checkbox_${t.uri}`;return(0,o.useEffect)(()=>{e&&c&&document.getElementById(y)?.scrollIntoView({behavior:"smooth",block:"center"})},[]),o.createElement("div",{className:p.nestedEntry,style:{marginLeft:i*(3*l.spacing.gridSize)}},g?o.createElement(tr.h,{className:p.collapseButton,name:s?"angle-down":"angle-right","aria-label":s?`Collapse ${t.name}`:`Expand ${t.name}`,onClick:d,id:t.id}):o.createElement(Q,{layout:"inline",h:2}),o.createElement(Q,{layout:"inline",h:2}),a&&o.createElement(o.Fragment,null,o.createElement(tt.X,{id:y,onChange:h,disabled:r,value:e,className:p.nestedRowCheckbox}),o.createElement(Q,{layout:"inline",h:2})),o.createElement(rr,{entry:t,isOpen:s}),o.createElement(Q,{layout:"inline",h:1}),o.createElement("label",{htmlFor:y,className:(0,k.cx)(p.entryContentItem,p.truncated)},t.name))};var or=v(39493);class _{static buildResourceUri(e,r){const s=[],{subscription:a,resourceGroup:i,metricNamespace:c,resourceName:n}=r;if(a&&(s.push("/subscriptions",a),i&&(s.push("resourceGroups",i),c&&n))){const u=e.replace(c),l=c.split("/"),p=e.replace(n),g=n.split("/"),d=l.shift();if(d&&s.push("providers",d),u.toLowerCase().startsWith("microsoft.storage/storageaccounts/")&&!p.endsWith("default")&&g.push("default"),g.length>l.length){const h=g.shift();h&&s.push(h)}for(const h in l)s.push(l[h]),s.push(g[h])}return s.join("/")}static buildAzureMonitorGetMetricNamespacesUrl(e,r,s,a,i){let c;if("resourceUri"in s)c=s.resourceUri;else{const{subscription:n,resourceGroup:u,metricNamespace:l,resourceName:p}=s;c=_.buildResourceUri(i,{subscription:n,resourceGroup:u,metricNamespace:l,resourceName:p})}return`${e}${c}/providers/microsoft.insights/metricNamespaces?api-version=${r}${a?"&region=global":""}`}static buildAzureMonitorGetMetricNamesUrl(e,r,s,a){let i;const{customNamespace:c}=s;if("resourceUri"in s)i=s.resourceUri;else{const{subscription:u,resourceGroup:l,metricNamespace:p,resourceName:g}=s;i=_.buildResourceUri(a,{subscription:u,resourceGroup:l,metricNamespace:p,resourceName:g})}let n=`${e}${i}/providers/microsoft.insights/metricdefinitions?api-version=${r}`;return c&&(n+=`&metricnamespace=${encodeURIComponent(c)}`),n}}const ar=/\/subscriptions\/(?<subscription>[^/]+)(?:\/resourceGroups\/(?<resourceGroup>[^/]+)(?:\/providers\/(?<metricNamespaceAndResource>.+))?)?/;function ir(t){if(!t)return{};const e=t.split("/"),r=e.splice(0,2),s=e.splice(0,1);for(;e.length;){const a=e.shift();e.length%2===0?s.push(a):r.push(a)}return{metricNamespace:r.join("/"),resourceName:s.join("/")}}function ze(t){const r=ar.exec(t)?.groups??{},{subscription:s,resourceGroup:a,metricNamespaceAndResource:i}=r,{metricNamespace:c,resourceName:n}=ir(i);return{subscription:s,resourceGroup:a,metricNamespace:c,resourceName:n}}function ee(t,e){return t.map(r=>V(r,e))}function V(t,e){if(typeof t=="string"){const r=ze(t);return e&&(r.region=e),r}return t}function Ge(t){return t.map(e=>Ee(e))}function Ee(t){return t?typeof t=="string"?t:_.buildResourceUri((0,P.J)(),t):""}function De(t){return!!t.match(/^[A-Z0-9]+/i)}function nr(t,e,r,s){return r?.startsWith("microsoft.storage/storageaccounts")&&(r="microsoft.storage/storageaccounts",s?.endsWith("/default")&&(s=s.slice(0,-8))),t===r&&e===s}function rt(t,e){const r=V(e),s=V(t);return s?.subscription===r?.subscription&&s?.resourceGroup?.toLowerCase()===r?.resourceGroup?.toLowerCase()&&nr(s?.metricNamespace?.toLowerCase(),s?.resourceName,r?.metricNamespace?.toLowerCase(),r?.resourceName)}function cr(t,e){const r=[];return e.forEach(s=>{const a=ae(t,s);a&&r.push(a)}),r}function ae(t,e){for(const r of t){if(rt(r.uri,e))return r;if(r.children){const s=ae(r.children,e);if(s)return s}}}function Le(t,e,r){return(0,or.ZP)(t,s=>{const a=ae(s,e);a&&(a.children=r)})}function ur(t,e,r){if(e==="logs")return{...t,azureLogAnalytics:{...t.azureLogAnalytics,resources:Ge(r).filter(a=>a!=="")}};if(e==="traces")return{...t,azureTraces:{...t.azureTraces,resources:Ge(r).filter(a=>a!=="")}};const s=r.length?V(r[0]):{};return{...t,subscription:s.subscription,azureMonitor:{...t.azureMonitor,metricNamespace:s.metricNamespace?.toLocaleLowerCase(),region:s.region,resources:ee(r).filter(a=>a.resourceName!==""&&a.metricNamespace!==""&&a.subscription!==""&&a.resourceGroup!==""),metricName:void 0,aggregation:void 0,timeGrain:"",dimensionFilters:[]}}}const st=({row:t,selectedRows:e,level:r,requestNestedRows:s,onRowSelectedChange:a,selectableEntryTypes:i,scrollIntoView:c,disableRow:n})=>{const u=(0,B.wW)(de),[l,p]=(0,o.useState)("closed"),g=!!e.find(f=>f.uri.toLowerCase()===t.uri.toLowerCase()),d=!g&&n(t,e),h=l==="open",y=async()=>{if(l==="open"){p("closed");return}p("loading"),s(t).then(()=>p("open")).catch(()=>p("closed"))};return(0,o.useEffect)(()=>{const f=e[0];f&&!!ae(t.children??[],f.uri)&&p("open")},[e,t]),o.createElement(o.Fragment,null,o.createElement("tr",{className:(0,k.cx)(u.row,d&&u.disabledRow),key:t.id},o.createElement("td",{className:u.cell},o.createElement(sr,{level:r,isSelected:g,isDisabled:d,isOpen:h,entry:t,onToggleCollapse:y,onSelectedChange:a,isSelectable:i.some(f=>f===t.type),scrollIntoView:c})),o.createElement("td",{className:u.cell},t.typeLabel),o.createElement("td",{className:u.cell},t.locationDisplayName??"-")),h&&t.children&&Object.keys(t.children).length>0&&t.children.map(f=>o.createElement(st,{key:f.uri,row:f,selectedRows:e,level:r+1,requestNestedRows:s,onRowSelectedChange:a,selectableEntryTypes:i,scrollIntoView:c,disableRow:n})),o.createElement(er.n,{visible:l==="loading"},o.createElement("tr",null,o.createElement("td",{className:(0,k.cx)(u.cell,u.loadingCell),colSpan:3},o.createElement(et.u,{text:"Loading...",className:u.spinner})))))},ot=st;var X=v(46967);const lr=({searchFn:t})=>{const[e,r]=(0,o.useState)(""),s=(0,o.useMemo)(()=>(0,w.debounce)(t,600),[t]);return(0,o.useEffect)(()=>()=>{s.cancel()},[s]),o.createElement(X.I,{"aria-label":"resource search",prefix:o.createElement(K.J,{name:"search"}),value:e,onChange:a=>{const i=a.currentTarget.value;r(i),s(i)},placeholder:"search for a resource","data-testid":T.components.queryEditor.resourcePicker.search.input})},mr=({resourcePickerData:t,resources:e,onApply:r,onCancel:s,selectableEntryTypes:a,queryType:i,disableRow:c,renderAdvanced:n,selectionNotice:u})=>{const l=(0,B.wW)(de),[p,g]=(0,o.useState)(!1),[d,h]=(0,o.useState)([]),[y,f]=(0,o.useState)([]),[b,z]=(0,o.useState)(e),[S,M]=(0,o.useState)(void 0),[U,D]=(0,o.useState)(!1),Te=u?.(y);(0,o.useEffect)(()=>{z(e)},[e]);const ce=(0,o.useCallback)(async()=>{if(!p){try{g(!0);const E=await t.fetchInitialRows(i,ee(b??{}));h(E)}catch(E){M(oe(E))}g(!1)}},[b,p,t,i]);(0,Fe.Z)(()=>{ce()});const he=E=>typeof E=="string"?E!=="":E.subscription&&E.resourceGroup&&E.resourceName&&E.metricNamespace;(0,o.useEffect)(()=>{b||f([]);const E=b.filter(L=>he(L)),G=b&&cr(d,Ge(E));return E?.length>G.length?f(t.parseRows(E)):G&&G.length?f(G):f([])},[b,d,t]);const be=(0,o.useCallback)(async E=>{if(M(void 0),!E.children?.length)try{const G=await t.fetchAndAppendNestedRow(d,E,i);h(G)}catch(G){throw M(oe(G)),G}},[t,d,i]),Ne=(0,o.useCallback)((E,G)=>{if(G){const L=i==="logs"?E.uri:ee([E.uri],E.location)[0],ue=b?b.concat(L):[L];z(ue.filter(te=>he(te)))}else{const L=b?.filter(ue=>!rt(Ee(ue),E.uri));z(L)}},[i,b,z]),Oe=(0,o.useCallback)(()=>{b&&r(i==="logs"?b:ee(b))},[i,b,r]),Xe=(0,o.useCallback)(async E=>{if(M(void 0),D(!1),!E){ce();return}try{g(!0);const G=await t.search(E,i);h(G),G.length>=t.resultLimit&&D(!0)}catch(G){M(oe(G))}g(!1)},[ce,t,i]);return o.createElement("div",null,o.createElement(lr,{searchFn:Xe}),U?o.createElement("p",{className:l.resultLimit},"Showing first ",t.resultLimit," results"):o.createElement(Q,{v:2}),o.createElement("table",{className:l.table},o.createElement("thead",null,o.createElement("tr",{className:(0,k.cx)(l.row,l.header)},o.createElement("td",{className:l.cell},"Scope"),o.createElement("td",{className:l.cell},"Type"),o.createElement("td",{className:l.cell},"Location")))),o.createElement("div",{className:l.tableScroller},o.createElement("table",{className:l.table},o.createElement("tbody",null,p&&o.createElement("tr",{className:(0,k.cx)(l.row)},o.createElement("td",{className:l.cell},o.createElement(et.u,{text:"Loading..."}))),!p&&d.length===0&&o.createElement("tr",{className:(0,k.cx)(l.row)},o.createElement("td",{className:l.cell,"aria-live":"polite"},"No resources found")),!p&&d.map(E=>o.createElement(ot,{key:E.uri,row:E,selectedRows:y,level:0,requestNestedRows:be,onRowSelectedChange:Ne,selectableEntryTypes:a,scrollIntoView:!0,disableRow:c}))))),o.createElement("div",{className:l.selectionFooter},y.length>0&&o.createElement(o.Fragment,null,o.createElement("h5",null,"Selection"),o.createElement("div",{className:l.tableScroller},o.createElement("table",{className:l.table},o.createElement("tbody",null,y.map(E=>o.createElement(ot,{key:E.uri,row:E,selectedRows:y,level:0,requestNestedRows:be,onRowSelectedChange:Ne,selectableEntryTypes:a,disableRow:()=>!1}))))),o.createElement(Q,{v:2}),Te?.length?o.createElement(H.b,{title:"",severity:"info"},Te):null),o.createElement(_t,{resources:b,onChange:E=>z(E),renderAdvanced:n}),o.createElement(Q,{v:2}),o.createElement(q.zx,{disabled:!!S||!b.every(he),onClick:Oe,"data-testid":T.components.queryEditor.resourcePicker.apply.button},"Apply"),o.createElement(Q,{layout:"inline",h:1}),o.createElement(q.zx,{onClick:s,variant:"secondary"},"Cancel")),S&&o.createElement(o.Fragment,null,o.createElement(Q,{v:2}),o.createElement(H.b,{severity:"error",title:"An error occurred while requesting resources from Azure Monitor"},S)))},pr=({query:t,datasource:e,onQueryChange:r,selectableEntryTypes:s,queryType:a,resources:i,inlineField:c,labelWidth:n,disableRow:u,renderAdvanced:l,selectionNotice:p})=>{const g=(0,B.wW)(de),[d,h]=(0,o.useState)(!1),y=(0,o.useCallback)(()=>{h(!0)},[]),f=(0,o.useCallback)(()=>{h(!1)},[]),b=(0,o.useCallback)(z=>{r(ur(t,a,z)),f()},[f,r,t,a]);return o.createElement("span",{"data-testid":T.components.queryEditor.resourcePicker.select.button},o.createElement(Kt.u,{className:g.modal,title:"Select a resource",isOpen:d,onDismiss:f,trapFocus:!1},o.createElement(mr,{resourcePickerData:e.resourcePickerData,resources:i,onApply:b,onCancel:f,selectableEntryTypes:s,queryType:a,disableRow:u,renderAdvanced:l,selectionNotice:p})),o.createElement(W,{label:"Resource",inlineField:c,labelWidth:n},o.createElement(q.zx,{className:g.resourceFieldButton,variant:"secondary",onClick:y,type:"button"},o.createElement(dr,{resources:i,datasource:e}))))},dr=({resources:t,datasource:e})=>{const[r,s]=(0,o.useState)(ee(t));return(0,o.useEffect)(()=>{s(ee(t))},[t]),t.length?o.createElement(fr,{resources:r}):o.createElement(o.Fragment,null,"Select a resource")},fr=({resources:t})=>{const e=(0,B.wW)(de);let r="cube";const s=[];return t.forEach(a=>{if(a.resourceName){s.push(a.resourceName.split("/")[0]);return}if(a.resourceGroup){r="folder",s.push(a.resourceGroup);return}if(a.subscription){r="layer-group",s.push(a.subscription);return}}),o.createElement("span",{className:(0,k.cx)(e.truncated,e.resourceField)},o.createElement(K.J,{name:r}),s.join(", "))},Qe=pr;var at=v(64353),gr=v(61860);const hr=t=>({resourceList:(0,k.css)({width:"100%",display:"flex",marginBlock:t.spacing(1)})}),it=({resources:t,onChange:e})=>{const r=(0,B.wW)(hr);(0,o.useEffect)(()=>{t.length===0&&e([""])},[t,e]);const s=(c,n)=>{const u=[...t];u[c]=n,e(u)},a=c=>{const n=[...t];n.splice(c,1),e(n)},i=()=>{e(t.concat(""))};return o.createElement(o.Fragment,null,o.createElement(at._,null,o.createElement("h6",null,"Resource URI(s)"," ",o.createElement(gr.u,{content:o.createElement(o.Fragment,null,"Manually edit the"," ",o.createElement("a",{href:"https://docs.microsoft.com/en-us/azure/azure-monitor/logs/log-standard-columns#_resourceid",rel:"noopener noreferrer",target:"_blank"},"resource uri"),". Supports the use of multiple template variables (ex: /subscriptions/$subId/resourceGroups/$rg)"),placement:"right",interactive:!0},o.createElement(K.J,{name:"info-circle"})))),t.map((c,n)=>o.createElement("div",{key:`resource-${n+1}`},o.createElement("div",{className:r.resourceList},o.createElement(X.I,{id:`input-advanced-resource-picker-${n+1}`,value:c,onChange:u=>s(n,u.currentTarget.value),placeholder:"ex: /subscriptions/$subId","data-testid":`input-advanced-resource-picker-${n+1}`}),o.createElement(A.AccessoryButton,{"aria-label":"remove",icon:"times",variant:"secondary",onClick:()=>a(n),"data-testid":"remove-resource",hidden:t.length===1})))),o.createElement(q.zx,{"aria-label":"Add",icon:"plus",variant:"secondary",onClick:i,type:"button"},"Add resource URI"))};class br{constructor(){this.resolve=void 0,this.reject=void 0,this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r}),Object.freeze(this)}}function Pe(t,e){return{...t,azureLogAnalytics:{...t.azureLogAnalytics,query:e}}}function vr(t,e){return{...t,azureLogAnalytics:{...t.azureLogAnalytics,resultFormat:e}}}const yr=({query:t,datasource:e,onQueryChange:r})=>{const s=(0,o.useRef)();function a(){return s.current||(s.current=new br),s.current.promise}(0,o.useEffect)(()=>{if(!t.azureLogAnalytics?.resources||!t.azureLogAnalytics.resources.length)return;const n=[e.azureLogAnalyticsDatasource.getKustoSchema(t.azureLogAnalytics.resources[0]),a()];Promise.all(n).then(([u,{monaco:l,editor:p}])=>{l.languages.kusto.getKustoWorker().then(d=>{const h=p.getModel();return h&&d(h.uri)}).then(d=>{d?.setSchema(u,"https://help.kusto.windows.net","Samples")})})},[e.azureLogAnalyticsDatasource,t.azureLogAnalytics?.resources]);const i=(0,o.useCallback)((n,u)=>{s.current?.resolve?.({editor:n,monaco:u})},[]),c=(0,o.useCallback)(n=>{r(Pe(t,n))},[r,t]);return o.createElement(Ie.p,{value:t.azureLogAnalytics?.query??"",language:"kusto",height:200,width:"100%",showMiniMap:!1,onBlur:c,onSave:c,onEditorDidMount:i})};async function wr(t,e,r){if(e.azureLogAnalytics?.workspace!==void 0&&!e.azureLogAnalytics.resources){const s=De(e.azureLogAnalytics.workspace);let a;s?a=await t.resourcePickerData.getResourceURIFromWorkspace(e.azureLogAnalytics.workspace):a=e.azureLogAnalytics.workspace;const i={...e,azureLogAnalytics:{...e.azureLogAnalytics,resource:a,workspace:void 0}};delete i.azureLogAnalytics.workspace,r(i)}}function Sr(t,e,r){const[s,a]=(0,o.useState)();return(0,o.useEffect)(()=>{wr(t,e,r).catch(i=>a({title:"Unable to migrate workspace as a resource",message:i.message}))},[t,e,r]),s}const nt=({query:t,datasource:e,subscriptionId:r,variableOptionGroup:s,onChange:a,setError:i,hideFormatAs:c})=>{const n=Sr(e,t,a),u=(l,p)=>{if(p.length===0)return!1;const g=V(l.uri,l.location).metricNamespace?.toLowerCase(),d=V(p[0].uri,p[0].location).metricNamespace?.toLowerCase();return g!==d};return o.createElement("span",{"data-testid":T.components.queryEditor.logsQueryEditor.container.input},o.createElement(A.EditorRows,null,o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,o.createElement(Qe,{query:t,datasource:e,inlineField:!0,labelWidth:10,subscriptionId:r,variableOptionGroup:s,onQueryChange:a,setError:i,selectableEntryTypes:[R.Subscription,R.ResourceGroup,R.Resource,R.Variable],resources:t.azureLogAnalytics?.resources??[],queryType:"logs",disableRow:u,renderAdvanced:(l,p)=>o.createElement(it,{resources:l,onChange:p}),selectionNotice:()=>"You may only choose items of the same resource type."}))),o.createElement(yr,{query:t,datasource:e,subscriptionId:r,variableOptionGroup:s,onQueryChange:a,setError:i}),o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,!c&&o.createElement(_e,{query:t,datasource:e,subscriptionId:r,variableOptionGroup:s,onQueryChange:a,setError:i,inputId:"azure-monitor-logs",options:[{label:"Time series",value:j.TimeSeries},{label:"Table",value:j.Table}],defaultValue:j.Table,setFormatAs:vr,resultFormat:t.azureLogAnalytics?.resultFormat}),n&&o.createElement(H.b,{title:n.title},n.message)))))},Ve={"microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems":"Backup Items","microsoft.resources/subscriptions":"Subscriptions","microsoft.resources/subscriptions/resourcegroups":"Resource groups","citrix.services/xenappessentials":"Citrix Virtual Apps Essentials","citrix.services/xendesktopessentials":"Citrix Virtual Desktops Essentials","dynatrace.observability/monitors":"Dynatrace","github.enterprise/accounts":"GitHub AE","microsoft.aad/domainservices":"Azure AD Domain Services","microsoft.aadiam/privatelinkforazuread":"Private Link for Azure AD","microsoft.agfoodplatform/farmbeats":"Azure FarmBeats","microsoft.analysisservices/servers":"Analysis Services","microsoft.anybuild/clusters":"AnyBuild clusters","microsoft.apimanagement/service":"API Management services","microsoft.appconfiguration/configurationstores":"App Configuration","microsoft.appplatform/spring":"Azure Spring Cloud","microsoft.attestation/attestationproviders":"Attestation providers","microsoft.authorization/resourcemanagementprivatelinks":"Resource management private links","microsoft.automation/automationaccounts":"Automation Accounts","microsoft.automation/automationaccounts/runbooks":"Runbook","microsoft.autonomoussystems/workspaces":"Bonsai","microsoft.avs/privateclouds":"AVS Private clouds","microsoft.azureactivedirectory/b2cdirectories":"B2C Tenants","microsoft.azureactivedirectory/guestusages":"Guest Usages","microsoft.azurearcdata/datacontrollers":"Azure Arc data controllers","microsoft.azurearcdata/postgresinstances":"Azure Arc-enabled PostgreSQL Hyperscale server groups","microsoft.azurearcdata/sqlmanagedinstances":"SQL managed instances - Azure Arc","microsoft.azurearcdata/sqlserverinstances":"SQL Server - Azure Arc","microsoft.azuredata/sqlserverregistrations":"SQL Server registries","microsoft.azurepercept/accounts":"Azure Percept accounts","microsoft.azurestackhci/clusters":"Azure Stack HCI","microsoft.azurestackhci/virtualmachines":"Azure Stack HCI virtual machine - Azure Arc","microsoft.baremetal/crayservers":"Cray Servers","microsoft.baremetal/monitoringservers":"Monitoring Servers","microsoft.baremetalinfrastructure/baremetalinstances":"BareMetal Instances","microsoft.batch/batchaccounts":"Batch accounts","microsoft.bing/accounts":"Bing Resources","microsoft.botservice/botservices":"Bot Services","microsoft.cache/redis":"Azure Cache for Redis","microsoft.cache/redisenterprise":"Redis Enterprise","microsoft.cdn/cdnwebapplicationfirewallpolicies":"Content Delivery Network WAF policies","microsoft.cdn/profiles (front doors standard/premium":"Preview)","microsoft.cdn/profiles/afdendpoints":"Endpoints","microsoft.cdn/profiles/endpoints":"Endpoints","microsoft.certificateregistration/certificateorders":"App Service Certificates","microsoft.chaos/chaosexperiments":"Chaos Experiments (Classic)","microsoft.chaos/experiments":"Chaos Experiments","microsoft.classiccompute/domainnames":"Cloud services (classic)","microsoft.classiccompute/virtualmachines":"Virtual machines (classic)","microsoft.classicnetwork/networksecuritygroups":"Network security groups (classic)","microsoft.classicnetwork/reservedips":"Reserved IP addresses (classic)","microsoft.classicnetwork/virtualnetworks":"Virtual networks (classic)","microsoft.classicstorage/storageaccounts":"Storage accounts (classic)","microsoft.cloudtest/accounts":"CloudTest Accounts","microsoft.cloudtest/hostedpools":"1ES Hosted Pools","microsoft.cloudtest/images":"CloudTest Images","microsoft.cloudtest/pools":"CloudTest Pools","microsoft.clusterstor/nodes":"ClusterStors","microsoft.cognitiveservices/accounts":"Cognitive Services","microsoft.compute/availabilitysets":"Availability sets","microsoft.compute/capacityreservationgroups":"Capacity Reservation Groups","microsoft.compute/cloudservices":"Cloud services (extended support)","microsoft.compute/diskaccesses":"Disk Accesses","microsoft.compute/diskencryptionsets":"Disk Encryption Sets","microsoft.compute/disks":"Disks","microsoft.compute/galleries":"Azure compute galleries","microsoft.compute/galleries/applications":"VM application definitions","microsoft.compute/galleries/applications/versions":"VM application versions","microsoft.compute/galleries/images":"VM image definitions","microsoft.compute/galleries/images/versions":"VM image versions","microsoft.compute/hostgroups":"Host groups","microsoft.compute/hostgroups/hosts":"Hosts","microsoft.compute/images":"Images","microsoft.compute/proximityplacementgroups":"Proximity placement groups","microsoft.compute/restorepointcollections":"Restore Point Collections","microsoft.compute/snapshots":"Snapshots","microsoft.compute/sshpublickeys":"SSH keys","microsoft.compute/virtualmachines":"Virtual machines","microsoft.compute/virtualmachinescalesets":"Virtual machine scale sets","microsoft.confidentialledger/ledgers":"Confidential Ledgers","microsoft.confluent/organizations":"Confluent organizations","microsoft.connectedcache/cachenodes":"Connected Cache Resources","microsoft.connectedcache/enterprisecustomers":"Connected Cache Resources","microsoft.connectedvehicle/platformaccounts":"Connected Vehicle Platforms","microsoft.connectedvmwarevsphere/vcenters":"VMware vCenters","microsoft.connectedvmwarevsphere/virtualmachines":"VMware + AVS virtual machines","microsoft.containerinstance/containergroups":"Container instances","microsoft.containerregistry/registries":"Container registries","microsoft.containerregistry/registries/replications":"Container registry replications","microsoft.containerregistry/registries/webhooks":"Container registry webhooks","microsoft.containerservice/managedclusters":"Kubernetes services","microsoft.dashboard/grafana":"Grafana Workspaces","microsoft.databox/jobs":"Azure Data Box","microsoft.databoxedge/databoxedgedevices":"Azure Stack Edge / Data Box Gateway","microsoft.databricks/workspaces":"Azure Databricks Services","microsoft.datacatalog/catalogs":"Data Catalog","microsoft.datacollaboration/workspaces":"Project CI","microsoft.datadog/monitors":"Datadog","microsoft.datafactory/datafactories":"Data factories","microsoft.datafactory/factories":"Data factories (V2)","microsoft.datalakeanalytics/accounts":"Data Lake Analytics","microsoft.datalakestore/accounts":"Data Lake Storage Gen1","microsoft.datamigration/services":"Azure Database Migration Services","microsoft.datamigration/services/projects":"Azure Database Migration Projects","microsoft.datamigration/sqlmigrationservices":"Azure Database Migration Services","microsoft.dataprotection/backupvaults":"Backup vaults","microsoft.dataprotection/resourceguards":"Resource Guards (Preview)","microsoft.datareplication/replicationvaults":"Site Recovery Vaults","microsoft.datashare/accounts":"Data Shares","microsoft.dbformariadb/servers":"Azure Database for MariaDB servers","microsoft.dbformysql/flexibleservers":"Azure Database for MySQL flexible servers","microsoft.dbformysql/servers":"Azure Database for MySQL servers","microsoft.dbforpostgresql/flexibleservers":"Azure Database for PostgreSQL flexible servers","microsoft.dbforpostgresql/servergroups":"Azure Database for PostgreSQL server groups","microsoft.dbforpostgresql/servergroupsv2":"Azure Database for PostgreSQL server groups","microsoft.dbforpostgresql/servers":"Azure Database for PostgreSQL servers","microsoft.dbforpostgresql/serversv2":"Azure Database for PostgreSQL servers v2","microsoft.deploymentmanager/rollouts":"Rollouts","microsoft.desktopvirtualization/applicationgroups":"Application groups","microsoft.desktopvirtualization/hostpools":"Host pools","microsoft.desktopvirtualization/scalingplans":"Scaling plans","microsoft.desktopvirtualization/workspaces":"Workspaces","microsoft.devices/iothubs":"IoT Hub","microsoft.devices/provisioningservices":"Device Provisioning Services","microsoft.deviceupdate/accounts":"Device Update for IoT Hubs","microsoft.devops/pipelines":"DevOps Starter","microsoft.devtestlab/labs":"DevTest Labs","microsoft.devtestlab/labs/virtualmachines":"Virtual machines","microsoft.digitaltwins/digitaltwinsinstances":"Azure Digital Twins","microsoft.documentdb/cassandraclusters":"Azure Managed Instance for Apache Cassandra","microsoft.documentdb/databaseaccounts":"Azure Cosmos DB accounts","microsoft.domainregistration/domains":"App Service Domains","microsoft.edgeorder/addresses":"Azure Edge Hardware Center Address","microsoft.edgeorder/orderitems":"Azure Edge Hardware Center","microsoft.elastic/monitors":"Elasticsearch (Elastic Cloud)","microsoft.eventgrid/domains":"Event Grid Domains","microsoft.eventgrid/partnernamespaces":"Event Grid Partner Namespaces","microsoft.eventgrid/partnerregistrations":"Event Grid Partner Registrations","microsoft.eventgrid/partnertopics":"Event Grid Partner Topics","microsoft.eventgrid/systemtopics":"Event Grid System Topics","microsoft.eventgrid/topics":"Event Grid Topics","microsoft.eventhub/clusters":"Event Hubs Clusters","microsoft.eventhub/namespaces":"Event Hubs Namespaces","microsoft.experimentation/experimentworkspaces":"Experiment Workspaces","microsoft.extendedlocation/customlocations":"Custom locations","microsoft.fidalgo/devcenters":"Fidalgo DevCenters","microsoft.fidalgo/networksettings":"Network Configurations","microsoft.fidalgo/projects":"Fidalgo Projects","microsoft.fidalgo/projects/environments":"Fidalgo Environments","microsoft.fluidrelay/fluidrelayservers":"Fluid Relay","microsoft.genomics/accounts":"Genomics accounts","microsoft.hanaonazure/hanainstances":"SAP HANA on Azure","microsoft.hanaonazure/sapmonitors":"Azure Monitors for SAP Solutions","microsoft.hdinsight/clusterpools":"HDInsight cluster pools","microsoft.hdinsight/clusterpools/clusters":"HDInsight gen2 clusters","microsoft.hdinsight/clusterpools/clusters/sessionclusters":"HDInsight session clusters","microsoft.hdinsight/clusters":"HDInsight clusters","microsoft.healthbot/healthbots":"Azure Health Bot","microsoft.healthcareapis/services":"Azure API for FHIR","microsoft.healthcareapis/workspaces":"Healthcare APIs Workspaces","microsoft.healthcareapis/workspaces/dicomservices":"DICOM services","microsoft.healthcareapis/workspaces/fhirservices":"FHIR services","microsoft.healthcareapis/workspaces/iotconnectors":"IoT connectors","microsoft.hpcworkbench/instances":"HPC Workbenches (preview)","microsoft.hpcworkbench/instances/chambers":"Chambers (preview)","microsoft.hpcworkbench/instances/chambers/accessprofiles":"Chamber Profiles (preview)","microsoft.hpcworkbench/instances/chambers/workloads":"Chamber VMs (preview)","microsoft.hpcworkbench/instances/consortiums":"Consortiums (preview)","microsoft.hybridcompute/machines":"Servers - Azure Arc","microsoft.hybridcompute/privatelinkscopes":"Azure Arc Private Link Scopes","microsoft.hybridcontainerservice/provisionedclusters":"Provisioned clusters","microsoft.hybriddata/datamanagers":"StorSimple Data Managers","microsoft.hybridnetwork/devices":"Azure Network Function Manager \u2013 Devices","microsoft.hybridnetwork/networkfunctions":"Azure Network Function Manager \u2013 Network Functions","microsoft.importexport/jobs":"Import/export jobs","microsoft.insights/components":"Application Insights","microsoft.insights/datacollectionendpoints":"Data collection endpoints","microsoft.insights/datacollectionrules":"Data collection rules","microsoft.insights/privatelinkscopes":"Azure Monitor Private Link Scopes","microsoft.insights/webtests":"Availability tests","microsoft.insights/workbooks":"Azure Workbooks","microsoft.insights/workbooktemplates":"Azure Workbook Templates","microsoft.iotcentral/iotapps":"IoT Central Applications","microsoft.keyvault/vaults":"Key vaults","microsoft.kubernetes/connectedclusters":"Kubernetes - Azure Arc","microsoft.kusto/clusters":"Azure Data Explorer Clusters","microsoft.kusto/clusters/databases":"Azure Data Explorer Databases","microsoft.labservices/labaccounts":"Lab accounts","microsoft.labservices/labplans":"Lab plans","microsoft.labservices/labs":"Labs","microsoft.loadtestservice/loadtests":"Azure Load Testing","microsoft.logic/integrationaccounts":"Integration accounts","microsoft.logic/integrationserviceenvironments":"Integration Service Environments","microsoft.logic/integrationserviceenvironments/managedapis":"Managed Connector","microsoft.logic/workflows":"Logic apps","microsoft.logz/monitors":"Logz main account","microsoft.logz/monitors/accounts":"Logz sub account","microsoft.logz/monitors/metricssource":"Logz metrics data source","microsoft.machinelearning/commitmentplans":"Machine Learning Studio (classic) web service plans","microsoft.machinelearning/webservices":"Machine Learning Studio (classic) web services","microsoft.machinelearning/workspaces":"Machine Learning Studio (classic) workspaces","microsoft.machinelearningservices/workspaces":"Machine learning","microsoft.machinelearningservices/workspaces/onlineendpoints":"Machine learning online endpoints","microsoft.machinelearningservices/workspaces/onlineendpoints/deployments":"Machine learning online deployments","microsoft.maintenance/maintenanceconfigurations":"Maintenance Configurations","microsoft.managedidentity/userassignedidentities":"Managed Identities","microsoft.maps/accounts":"Azure Maps Accounts","microsoft.maps/accounts/creators":"Azure Maps Creator Resources","microsoft.media/mediaservices":"Media Services","microsoft.media/mediaservices/liveevents":"Live events","microsoft.media/mediaservices/streamingendpoints":"Streaming Endpoints","microsoft.media/videoanalyzers":"Video Analyzers","microsoft.migrate/projects":"Migration projects","microsoft.mixedreality/objectanchorsaccounts":"Object Anchors Accounts","microsoft.mixedreality/objectunderstandingaccounts":"Object Understanding Accounts","microsoft.mixedreality/remoterenderingaccounts":"Remote Rendering Accounts","microsoft.mixedreality/spatialanchorsaccounts":"Spatial Anchors Accounts","microsoft.mobilenetwork/mobilenetworks":"Mobile Networks","microsoft.mobilenetwork/mobilenetworks/datanetworks":"Data Networks","microsoft.mobilenetwork/mobilenetworks/services":"Services","microsoft.mobilenetwork/mobilenetworks/simpolicies":"Sim Policies","microsoft.mobilenetwork/mobilenetworks/sites":"Mobile Network Sites","microsoft.mobilenetwork/mobilenetworks/slices":"Slices","microsoft.mobilenetwork/packetcorecontrolplanes":"Packet Core Control Planes","microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes":"Packet Core Data Planes","microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes/attacheddatanetworks":"Attached Data Networks","microsoft.mobilenetwork/sims":"Sims","microsoft.netapp/netappaccounts":"NetApp accounts","microsoft.netapp/netappaccounts/capacitypools":"Capacity pools","microsoft.netapp/netappaccounts/capacitypools/volumes":"Volumes","microsoft.netapp/netappaccounts/capacitypools/volumes/snapshots":"Snapshots","microsoft.netapp/netappaccounts/snapshotpolicies":"Snapshot policies","microsoft.network/applicationgateways":"Application gateways","microsoft.network/applicationgatewaywebapplicationfirewallpolicies":"Application Gateway WAF policies","microsoft.network/applicationsecuritygroups":"Application security groups","microsoft.network/azurefirewalls":"Firewalls","microsoft.network/bastionhosts":"Bastions","microsoft.network/connections":"Connections","microsoft.network/customipprefixes":"Custom IP Prefixes","microsoft.network/ddosprotectionplans":"DDoS protection plans","microsoft.network/dnsforwardingrulesets":"Dns Forwarding Rulesets","microsoft.network/dnsresolvers":"DNS Private Resolvers","microsoft.network/dnszones":"DNS zones","microsoft.network/expressroutecircuits":"ExpressRoute circuits","microsoft.network/expressrouteports":"ExpressRoute Direct","microsoft.network/firewallpolicies":"Firewall Policies","microsoft.network/frontdoors":"Front Doors","microsoft.network/frontdoorwebapplicationfirewallpolicies":"Web Application Firewall policies (WAF)","microsoft.network/ipgroups":"IP Groups","microsoft.network/loadbalancers":"Load balancers","microsoft.network/localnetworkgateways":"Local network gateways","microsoft.network/natgateways":"NAT gateways","microsoft.network/networkexperimentprofiles":"Internet Analyzer profiles","microsoft.network/networkinterfaces":"Network interfaces","microsoft.network/networkmanagers":"Network Managers","microsoft.network/networksecuritygroups":"Network security groups","microsoft.network/networkwatchers":"Network Watchers","microsoft.network/networkwatchers/connectionmonitors":"Connection Monitors","microsoft.network/networkwatchers/flowlogs":"NSG Flow Logs","microsoft.network/privatednszones":"Private DNS zones","microsoft.network/privateendpoints":"Private endpoints","microsoft.network/privatelinkservices":"Private link services","microsoft.network/publicipaddresses":"Public IP addresses","microsoft.network/publicipprefixes":"Public IP Prefixes","microsoft.network/routefilters":"Route filters","microsoft.network/routetables":"Route tables","microsoft.network/serviceendpointpolicies":"Service endpoint policies","microsoft.network/trafficmanagerprofiles":"Traffic Manager profiles","microsoft.network/virtualnetworkgateways":"Virtual network gateways","microsoft.network/virtualnetworks":"Virtual networks","microsoft.network/virtualwans":"Virtual WANs","microsoft.notificationhubs/namespaces":"Notification Hub Namespaces","microsoft.notificationhubs/namespaces/notificationhubs":"Notification Hubs","microsoft.openenergyplatform/energyservices":"Project Oak Forest","microsoft.openlogisticsplatform/workspaces":"Open Supply Chain Platform","microsoft.operationalinsights/querypacks":"Log Analytics query packs","microsoft.operationalinsights/workspaces":"Log Analytics workspaces","microsoft.operationsmanagement/solutions":"Solutions","microsoft.orbital/contactprofiles":"Contact Profiles","microsoft.orbital/edgesites":"Edge Sites","microsoft.orbital/groundstations":"Ground Stations","microsoft.orbital/l2connections":"L2 Connections","microsoft.orbital/spacecrafts":"Spacecrafts","microsoft.peering/peerings":"Peerings","microsoft.peering/peeringservices":"Peering Services","microsoft.playfab/playeraccountpools":"PlayFab player account pools","microsoft.playfab/titles":"PlayFab titles","microsoft.portal/dashboards":"Shared dashboards","microsoft.powerbidedicated/capacities":"Power BI Embedded","microsoft.purview/accounts":"Microsoft Purview accounts","microsoft.quantum/workspaces":"Quantum Workspaces","microsoft.recommendationsservice/accounts":"Intelligent Recommendations Accounts","microsoft.recommendationsservice/accounts/modeling":"Modeling","microsoft.recommendationsservice/accounts/serviceendpoints":"Service Endpoints","microsoft.recoveryservices/vaults":"Recovery Services vaults","microsoft.redhatopenshift/openshiftclusters":"Azure Red Hat OpenShift","microsoft.relay/namespaces":"Relays","microsoft.resourceconnector/appliances":"Resource bridges","microsoft.resourcegraph/queries":"Resource Graph queries","microsoft.resources/deploymentscripts":"Deployment Scripts","microsoft.resources/templatespecs":"Template specs","microsoft.saas/applications":"Software as a Service (classic)","microsoft.saas/resources":"SaaS","microsoft.scom/managedinstances":"Aquila Instances","microsoft.scvmm/virtualmachines":"SCVMM virtual machine - Azure Arc","microsoft.scvmm/vmmservers":"SCVMM management servers","microsoft.search/searchservices":"Search services","microsoft.securitydetonation/chambers":"Security Detonation Chambers","microsoft.servicebus/namespaces":"Service Bus Namespaces","microsoft.servicefabric/clusters":"Service Fabric clusters","microsoft.servicefabric/managedclusters":"Service Fabric managed clusters","microsoft.serviceshub/connectors":"Services Hub Connectors","microsoft.signalrservice/signalr":"SignalR","microsoft.signalrservice/webpubsub":"Web PubSub Service","microsoft.solutions/applicationdefinitions":"Service catalog managed application definitions","microsoft.solutions/applications":"Managed applications","microsoft.sql/instancepools":"Instance pools","microsoft.sql/managedinstances":"SQL managed instances","microsoft.sql/managedinstances/databases":"Managed databases","microsoft.sql/servers":"SQL servers","microsoft.sql/servers/databases":"SQL databases","microsoft.sql/servers/elasticpools":"SQL elastic pools","microsoft.sql/servers/jobagents":"Elastic Job agents","microsoft.sql/virtualclusters":"Virtual clusters","microsoft.sqlvirtualmachine/sqlvirtualmachines":"SQL virtual machines","microsoft.storage/storageaccounts":"Storage accounts","microsoft.storagecache/amlfilesystems":"Lustre File Systems","microsoft.storagecache/caches":"HPC caches","microsoft.storagepool/diskpools":"Disk Pools","microsoft.storagesync/storagesyncservices":"Storage Sync Services","microsoft.storagesyncdev/storagesyncservices":"Storage Sync Services","microsoft.storagesyncint/storagesyncservices":"Storage Sync Services","microsoft.storsimple/managers":"StorSimple Device Managers","microsoft.streamanalytics/clusters":"Stream Analytics clusters","microsoft.streamanalytics/streamingjobs":"Stream Analytics jobs","microsoft.synapse/privatelinkhubs":"Azure Synapse Analytics (private link hubs)","microsoft.synapse/workspaces":"Azure Synapse Analytics","microsoft.synapse/workspaces/bigdatapools":"Apache Spark pools","microsoft.synapse/workspaces/kustopools":"Data Explorer pools (preview)","microsoft.synapse/workspaces/sqlpools":"Dedicated SQL pools","microsoft.testbase/testbaseaccounts":"Test Base Accounts","microsoft.testbase/testbaseaccounts/packages":"Test Base Packages","microsoft.timeseriesinsights/environments":"Time Series Insights environments","microsoft.timeseriesinsights/environments/eventsources":"Time Series Insights event sources","microsoft.timeseriesinsights/environments/referencedatasets":"Time Series Insights reference data sets","microsoft.videoindexer/accounts":"Video Analyzer for Media","microsoft.virtualmachineimages/imagetemplates":"Image Templates","microsoft.visualstudio/account":"Azure DevOps organizations","microsoft.visualstudio/account/project":"DevOps Starter","microsoft.vmwarecloudsimple/dedicatedcloudnodes":"CloudSimple Nodes","microsoft.vmwarecloudsimple/dedicatedcloudservices":"CloudSimple Services","microsoft.vmwarecloudsimple/virtualmachines":"CloudSimple Virtual Machines","microsoft.vsonline/plans":"Visual Studio Online Plans","microsoft.web/connectiongateways":"On-premises data gateways","microsoft.web/connections":"API Connections","microsoft.web/containerapps":"Container Apps","microsoft.web/customapis":"Logic Apps Custom Connector","microsoft.web/hostingenvironments":"App Service Environments","microsoft.web/kubeenvironments":"App Service Kubernetes Environments","microsoft.web/serverfarms":"App Service plans","microsoft.web/sites":"App Services","microsoft.web/sites/slots":"App Service (Slots)","microsoft.web/staticsites":"Static Web Apps","microsoft.windowsesu/multipleactivationkeys":"Windows Multiple Activation Keys","microsoft.windowsiot/deviceservices":"Windows 10 IoT Core Services","microsoft.workloads/monitors":"Azure Monitors for SAP Solutions (v2)","microsoft.workloads/phpworkloads":"Scalable WordPress on Linux","microsoft.workloads/sapvirtualinstances":"SAP Virtual Instances","microsoft.workloads/sapvirtualinstances/applicationinstances":"SAP app server instances","microsoft.workloads/sapvirtualinstances/centralinstances":"SAP central server instances","microsoft.workloads/sapvirtualinstances/databaseinstances":"SAP database server instances","nginx.nginxplus/nginxdeployments":"NGINX Deployment","providers.test/statefulibizaengines":"VLCentral Help","wandisco.fusion/fusiongroups":"LiveData Planes","wandisco.fusion/fusiongroups/azurezones":"Azure Zones","wandisco.fusion/fusiongroups/azurezones/plugins":"Plugins","wandisco.fusion/fusiongroups/hivereplicationrules":"Hive Replication Rules","wandisco.fusion/fusiongroups/managedonpremzones":"On-premises Zones","wandisco.fusion/fusiongroups/replicationrules":"Replication Rules","wandisco.fusion/migrators":"LiveData Migrators","wandisco.fusion/migrators/exclusiontemplates":"Exclusions","wandisco.fusion/migrators/livedatamigrations":"Migrations","wandisco.fusion/migrators/metadatamigrations":"Metadata Migrations","wandisco.fusion/migrators/metadatatargets":"Metadata Targets","wandisco.fusion/migrators/pathmappings":"Path Mappings","wandisco.fusion/migrators/targets":"Targets","microsoft.security/insights/classification":"Data Sensitivity Security Insights (Preview)","microsoft.security/locations/alerts":"Security Alerts"},zr={"microsoft.cache/redis":!0,"microsoft.dbforpostgresql/flexibleservers":!0,"microsoft.storagecache/amlfilesystems":!0,"microsoft.databoxedge/databoxedgedevices":!0,"microsoft.dataprotection/backupvaults":!0,"microsoft.netapp/netappaccounts/capacitypools":!0,"microsoft.network/networkwatchers/connectionmonitors":!0,"microsoft.keyvault/vaults":!0,"microsoft.recoveryservices/vaults":!0,"microsoft.sql/servers/databases":!0,"microsoft.sql/servers/elasticpools":!0,"microsoft.compute/virtualmachinescalesets":!0,"microsoft.compute/virtualmachines":!0,"microsoft.signalrservice/webpubsub":!0},Er=["microsoft.aad/domainservices","microsoft.aadiam/azureadmetrics","microsoft.aadiam/tenants","microsoft.agfoodplatform/farmbeats","microsoft.analysisservices/servers","microsoft.apimanagement/service","microsoft.appconfiguration/configurationstores","microsoft.appplatform/spring","microsoft.attestation/attestationproviders","microsoft.automation/automationaccounts","microsoft.autonomousdevelopmentplatform/accounts","microsoft.autonomousdevelopmentplatform/datapools","microsoft.autonomousdevelopmentplatform/workspaces","microsoft.avs/privateclouds","microsoft.azurestackresourcemonitor/storageaccountmonitor","microsoft.batch/batchaccounts","microsoft.batchai/workspaces","microsoft.blockchain/blockchainmembers","microsoft.blockchain/cordamembers","microsoft.botservice/botservices","microsoft.cache/redis","microsoft.cache/redisenterprise","microsoft.cdn/cdnwebapplicationfirewallpolicies","microsoft.cdn/profiles","microsoft.cdn/profiles/endpoints","microsoft.classiccompute/domainnames","microsoft.classiccompute/virtualmachines","microsoft.classicnetwork/networksecuritygroups","microsoft.classicstorage/storageaccounts","microsoft.cognitiveservices/accounts","microsoft.communication/communicationservices","microsoft.compute/disks","microsoft.compute/virtualmachines","microsoft.compute/virtualmachinescalesets","microsoft.connectedcache/cachenodes","microsoft.connectedvehicle/platformaccounts","microsoft.containerinstance/containergroups","microsoft.containerregistry/registries","microsoft.containerservice/managedclusters","microsoft.customerinsights/hubs","microsoft.customproviders/resourceproviders","microsoft.d365customerinsights/instances","microsoft.dashboard/grafana","microsoft.databoxedge/databoxedgedevices","microsoft.databricks/workspaces","microsoft.datacollaboration/workspaces","microsoft.datafactory/datafactories","microsoft.datafactory/factories","microsoft.datalakeanalytics/accounts","microsoft.datalakestore/accounts","microsoft.datashare/accounts","microsoft.dbformariadb/servers","microsoft.dbformysql/flexibleservers","microsoft.dbformysql/servers","microsoft.dbforpostgresql/flexibleservers","microsoft.dbforpostgresql/servergroupsv2","microsoft.dbforpostgresql/servers","microsoft.dbforpostgresql/serversv2","microsoft.desktopvirtualization/applicationgroups","microsoft.desktopvirtualization/hostpools","microsoft.desktopvirtualization/scalingplans","microsoft.desktopvirtualization/workspaces","microsoft.devices/elasticpools/iothubtenants","microsoft.devices/iothubs","microsoft.devices/provisioningservices","microsoft.digitaltwins/digitaltwinsinstances","microsoft.documentdb/cassandraclusters","microsoft.documentdb/databaseaccounts","microsoft.eventgrid/domains","microsoft.eventgrid/partnernamespaces","microsoft.eventgrid/partnertopics","microsoft.eventgrid/systemtopics","microsoft.eventgrid/topics","microsoft.eventhub/clusters","microsoft.eventhub/namespaces","microsoft.experimentation/experimentworkspaces","microsoft.fabric.admin/fabriclocations","microsoft.hdinsight/clusters","microsoft.healthcareapis/services","microsoft.healthcareapis/workspaces/dicomservices","microsoft.healthcareapis/workspaces/fhirservices","microsoft.insights/autoscalesettings","microsoft.insights/components","microsoft.insights/qos","microsoft.iotcentral/iotapps","microsoft.keyvault/managedhsms","microsoft.keyvault/vaults","microsoft.kubernetes/connectedclusters","microsoft.kusto/clusters","microsoft.loadtestservice/loadtests","microsoft.logic/integrationaccounts","microsoft.logic/integrationserviceenvironments","microsoft.logic/workflows","microsoft.machinelearningservices/workspaces","microsoft.media/mediaservices","microsoft.media/mediaservices/liveevents","microsoft.media/mediaservices/streamingendpoints","microsoft.media/videoanalyzers","microsoft.netapp/netappaccounts/capacitypools","microsoft.netapp/netappaccounts/capacitypools/volumes","microsoft.network/applicationgateways","microsoft.network/azurefirewalls","microsoft.network/bastionhosts","microsoft.network/connections","microsoft.network/dnszones","microsoft.network/expressroutecircuits","microsoft.network/expressroutegateways","microsoft.network/expressrouteports","microsoft.network/frontdoors","microsoft.network/loadbalancers","microsoft.network/natgateways","microsoft.network/networkinterfaces","microsoft.network/networksecuritygroups","microsoft.network/networksecurityperimeters","microsoft.network/networkvirtualappliances","microsoft.network/networkwatchers","microsoft.network/networkwatchers/connectionmonitors","microsoft.network/p2svpngateways","microsoft.network/privateendpoints","microsoft.network/privatelinkservices","microsoft.network/publicipaddresses","microsoft.network/trafficmanagerprofiles","microsoft.network/virtualnetworkgateways","microsoft.network/virtualnetworks","microsoft.network/vpngateways","microsoft.networkfunction/azuretrafficcollectors","microsoft.notificationhubs/namespaces","microsoft.notificationhubs/namespaces/notificationhubs","microsoft.openlogisticsplatform/workspaces","microsoft.operationalinsights/workspaces","microsoft.operationsmanagement/solutions","microsoft.peering/peeringservices","microsoft.powerbi/tenants","microsoft.powerbi/tenants/workspaces","microsoft.powerbidedicated/capacities","microsoft.purview/accounts","microsoft.recoveryservices/vaults","microsoft.relay/namespaces","microsoft.resources/subscriptions","microsoft.resources/subscriptions/resourcegroups","microsoft.search/searchservices","microsoft.security/antimalwaresettings","microsoft.securityinsights/settings","microsoft.servicebus/namespaces","microsoft.signalrservice/signalr","microsoft.signalrservice/webpubsub","microsoft.singularity/accounts","microsoft.sql/managedinstances","microsoft.sql/managedinstances/databases","microsoft.sql/servers/databases","microsoft.sql/servers/elasticpools","microsoft.storage/storageaccounts","microsoft.storage/storageaccounts/blobservices","microsoft.storage/storageaccounts/fileservices","microsoft.storage/storageaccounts/queueservices","microsoft.storage/storageaccounts/tableservices","microsoft.storagecache/caches","microsoft.storagesync/storagesyncservices","microsoft.streamanalytics/streamingjobs","microsoft.synapse/workspaces","microsoft.synapse/workspaces/bigdatapools","microsoft.synapse/workspaces/kustopools","microsoft.synapse/workspaces/scopepools","microsoft.synapse/workspaces/sqlpools","microsoft.timeseriesinsights/environments","microsoft.timeseriesinsights/environments/eventsources","microsoft.videoindexer/accounts","microsoft.vmwarecloudsimple/virtualmachines","microsoft.web/hostingenvironments","microsoft.web/hostingenvironments/workerpools","microsoft.web/serverfarms","microsoft.web/sites","microsoft.web/sites/slots"],kr=t=>({resourceList:(0,k.css)({display:"flex",columnGap:t.spacing(1),flexWrap:"wrap",marginBottom:t.spacing(1)}),resource:(0,k.css)({flex:"0 0 auto"}),resourceLabel:(0,k.css)({padding:t.spacing(1)}),resourceGroupAndName:(0,k.css)({display:"flex",columnGap:t.spacing(.5)})}),Ar=({resources:t,onChange:e})=>{const r=(0,B.wW)(kr);(0,o.useEffect)(()=>{t.length===0&&e([{}])},[t,e]);const s=(n,u)=>{const l=[...t];l[n]=u,e(l)},a=n=>{const u=[...t];u.splice(n,1),e(u)},i=()=>{e(t.concat({subscription:t[0]?.subscription,metricNamespace:t[0]?.metricNamespace,resourceGroup:"",resourceName:""}))},c=n=>{e(t.map(u=>({...u,...n})))};return o.createElement(o.Fragment,null,o.createElement(I._,{label:"Subscription",grow:!0,transparent:!0,htmlFor:"input-advanced-resource-picker-subscription",labelWidth:15,"data-testid":T.components.queryEditor.resourcePicker.advanced.subscription.input},o.createElement(X.I,{id:"input-advanced-resource-picker-subscription",value:t[0]?.subscription??"",onChange:n=>c({subscription:n.currentTarget.value}),placeholder:"aaaaaaaa-bbbb-cccc-dddd-eeeeeeee"})),o.createElement(I._,{label:"Namespace",grow:!0,transparent:!0,htmlFor:"input-advanced-resource-picker-metricNamespace",labelWidth:15,"data-testid":T.components.queryEditor.resourcePicker.advanced.namespace.input},o.createElement(X.I,{id:"input-advanced-resource-picker-metricNamespace",value:t[0]?.metricNamespace??"",onChange:n=>c({metricNamespace:n.currentTarget.value}),placeholder:"Microsoft.Insights/metricNamespaces"})),o.createElement(I._,{label:"Region",grow:!0,transparent:!0,htmlFor:"input-advanced-resource-picker-region",labelWidth:15,"data-testid":T.components.queryEditor.resourcePicker.advanced.region.input,tooltip:"The code region of the resource. Optional for one resource but mandatory when selecting multiple ones."},o.createElement(X.I,{id:"input-advanced-resource-picker-region",value:t[0]?.region??"",onChange:n=>c({region:n.currentTarget.value}),placeholder:"northeurope"})),o.createElement("div",{className:r.resourceList},t.map((n,u)=>o.createElement("div",{key:`resource-${u+1}`,className:r.resource},t.length!==1&&o.createElement(at._,{className:r.resourceLabel},"Resource ",u+1),o.createElement(I._,{label:"Resource Group",transparent:!0,htmlFor:`input-advanced-resource-picker-resourceGroup-${u+1}`,labelWidth:15,"data-testid":T.components.queryEditor.resourcePicker.advanced.resourceGroup.input},o.createElement("div",{className:r.resourceGroupAndName},o.createElement(X.I,{id:`input-advanced-resource-picker-resourceGroup-${u+1}`,value:n?.resourceGroup??"",onChange:l=>s(u,{...n,resourceGroup:l.currentTarget.value}),placeholder:"resource-group"}),o.createElement(A.AccessoryButton,{"aria-label":"remove",icon:"times",variant:"secondary",onClick:()=>a(u),hidden:t.length===1,"data-testid":"remove-resource"}))),o.createElement(I._,{label:"Resource Name",transparent:!0,htmlFor:`input-advanced-resource-picker-resourceName-${u+1}`,labelWidth:15,"data-testid":T.components.queryEditor.resourcePicker.advanced.resource.input},o.createElement(X.I,{id:`input-advanced-resource-picker-resourceName-${u+1}`,value:n?.resourceName??"",onChange:l=>s(u,{...n,resourceName:l.currentTarget.value}),placeholder:"name"}))))),o.createElement(q.zx,{"aria-label":"Add",icon:"plus",variant:"secondary",onClick:i,type:"button"},"Add resource"))};function ct(t,e){return t.azureMonitor?.customNamespace===e?t:e?.toLowerCase().startsWith("microsoft.storage/storageaccounts/")?{...t,azureMonitor:{...t.azureMonitor,metricNamespace:e,metricName:void 0,aggregation:void 0,timeGrain:"",dimensionFilters:[]}}:{...t,azureMonitor:{...t.azureMonitor,customNamespace:e,metricName:void 0,aggregation:void 0,timeGrain:"",dimensionFilters:[]}}}function Tr(t,e){return t.azureMonitor?.metricName===e?t:{...t,azureMonitor:{...t.azureMonitor,metricName:e,aggregation:void 0,timeGrain:"",dimensionFilters:[]}}}function Nr(t,e){return t.azureMonitor?.aggregation===e?t:{...t,azureMonitor:{...t.azureMonitor,aggregation:e}}}function ut(t,e){return t.azureMonitor?.timeGrain===e?t:{...t,azureMonitor:{...t.azureMonitor,timeGrain:e}}}function ke(t,e){return t.azureMonitor?.dimensionFilters===e?t:{...t,azureMonitor:{...t.azureMonitor,dimensionFilters:e}}}function Mr(t,e="",r="eq",s=[]){const a=t.azureMonitor?.dimensionFilters??[];return ke(t,[...a,{dimension:e,operator:r,filters:s}])}function Wo(t,e){const s=[...t.azureMonitor?.dimensionFilters??[]];return s.splice(e,1),ke(t,s)}function Uo(t,e,r,s){const i=[...t.azureMonitor?.dimensionFilters??[]],c=i[e];return c[r]=s,(r==="dimension"||r==="operator")&&(c.filters=[]),ke(t,i)}function Rr(t,e){return t.azureMonitor?.top===e?t:{...t,azureMonitor:{...t.azureMonitor,top:e}}}function Cr(t,e){return t.azureMonitor?.alias===e?t:{...t,azureMonitor:{...t.azureMonitor,alias:e}}}const Ir=({query:t,variableOptionGroup:e,onQueryChange:r,aggregationOptions:s,isLoading:a})=>{const i=(0,o.useCallback)(n=>{if(!n.value)return;const u=Nr(t,n.value);r(u)},[r,t]),c=J(s,e,t.azureMonitor?.aggregation);return o.createElement(W,{label:"Aggregation"},o.createElement(C.Ph,{inputId:"azure-monitor-metrics-aggregation-field",value:t.azureMonitor?.aggregation||null,onChange:i,options:c,isLoading:a}))};var lt=v(52081);const Fr=(t,e)=>{const[r,s]=(0,o.useState)({});return(0,o.useEffect)(()=>{let a={};if(t?.series?.length){const n=t.series.flat().filter(u=>u.refId===e.refId).flatMap(u=>u.fields).map(u=>u.labels).flat().filter(u=>u!=null);for(const u of n)for(const[l,p]of Object.entries(u)){const g=l.toLowerCase();a[g]?a[g].add(p):a[g]=new Set([p])}}s(i=>{const c={},n=Object.keys(a);if(n.length===0)return i;for(const u of n)i[u]&&a[u].size<i[u].size?c[u]=i[u]:c[u]=a[u];return c})},[t?.series,e.refId]),r},Gr=({data:t,query:e,dimensionOptions:r,onQueryChange:s})=>{const a=(0,o.useMemo)(()=>e.azureMonitor?.dimensionFilters??[],[e.azureMonitor?.dimensionFilters]),i=Fr(t,e),c=[{label:"==",value:"eq"},{label:"!=",value:"ne"},{label:"starts with",value:"sw"}],n=(0,o.useMemo)(()=>{let f=r;return a.length&&(f=r.filter(b=>!a.some(z=>z.dimension===b.value))),f},[a,r]),u=(f,b,z,S)=>{b[f]=z,S(b)},l=f=>n.concat(r.filter(b=>b.value===f)),p=(f,b)=>{const z=Array.from(i[b.toLowerCase()]??[]);return z.find(S=>S===f)?z.map(S=>({value:S,label:S})):[...z,...f&&f!=="*"?[f]:[]].map(S=>({value:S,label:S}))},g=(f,b)=>{const z=p(void 0,b);if(f)for(const S of f)z.find(M=>M.value===S)||z.push({value:S,label:S});return z},d=f=>c.find(b=>b.value===f)?c:[...c,...f?[{label:f,value:f}]:[]],h=f=>{const b=f.map(z=>({dimension:z.dimension??"",operator:z.operator??"eq",filters:z.filters??[]}));s(ke(e,b))},y=(f,b,z)=>o.createElement(lt.Lh,{spacing:"none"},o.createElement(C.Ph,{menuShouldPortal:!0,placeholder:"Field",value:f.dimension,options:l(f.dimension||""),onChange:S=>u("dimension",f,S.value??"",b)}),o.createElement(C.Ph,{menuShouldPortal:!0,placeholder:"Operation",value:f.operator,options:d(f.operator||"eq"),onChange:S=>u("operator",f,S.value??"",b),allowCustomValue:!0}),f.operator==="eq"||f.operator==="ne"?o.createElement(C.NU,{menuShouldPortal:!0,placeholder:"Select value(s)",value:f.filters,options:g(f.filters,f.dimension??""),onChange:S=>u("filters",f,S.map(M=>M.value??""),b),"aria-label":"dimension-labels-select",allowCustomValue:!0}):o.createElement(C.Ph,{menuShouldPortal:!0,placeholder:"Select value",value:f.filters?f.filters[0]:"",allowCustomValue:!0,options:p(f.filters?f.filters[0]:"",f.dimension??""),onChange:S=>u("filters",f,[S?.value??""],b),isClearable:!0}),o.createElement(A.AccessoryButton,{"aria-label":"Remove",icon:"times",variant:"secondary",onClick:z,type:"button"}));return o.createElement(W,{label:"Dimensions"},o.createElement(A.EditorList,{items:a,onChange:h,renderItem:y}))},Dr=({onQueryChange:t,query:e})=>{const[r,s]=(0,o.useState)(e.azureMonitor?.alias??""),a=(0,o.useCallback)(c=>{c.target instanceof HTMLInputElement&&s(c.target.value)},[]),i=(0,o.useCallback)(()=>{const c=Cr(e,r);t(c)},[t,e,r]);return o.createElement(W,{label:"Legend format"},o.createElement(X.I,{id:"azure-monitor-metrics-legend-field",placeholder:"Alias patterns",value:r,onChange:a,onBlur:i,width:38}))},Lr=({metricNames:t,query:e,variableOptionGroup:r,onQueryChange:s})=>{const a=(0,o.useCallback)(c=>{if(!c.value)return;const n=Tr(e,c.value);s(n)},[s,e]),i=J(t,r,e.azureMonitor?.metricName);return o.createElement(W,{label:"Metric","data-testid":T.components.queryEditor.metricsQueryEditor.metricName.input},o.createElement(C.Ph,{inputId:"azure-monitor-metrics-metric-field",value:e.azureMonitor?.metricName??null,onChange:a,options:i,allowCustomValue:!0}))},Qr=({metricNamespaces:t,query:e,variableOptionGroup:r,onQueryChange:s})=>{const a=(0,o.useCallback)(n=>{if(!n.value)return;const u=ct(e,n.value);s(u)},[s,e]),i=e.azureMonitor?.customNamespace||e.azureMonitor?.metricNamespace,c=J(t,r,i);return o.createElement(W,{label:"Metric namespace"},o.createElement(C.Ph,{inputId:"azure-monitor-metrics-metric-namespace-field",value:i||null,onChange:a,options:c,allowCustomValue:!0}))},Pr=({query:t,timeGrainOptions:e,variableOptionGroup:r,onQueryChange:s})=>{const a=(0,o.useCallback)(c=>{if(!c.value)return;const n=ut(t,c.value);s(n)},[s,t]),i=(0,o.useMemo)(()=>{const c=x.findClosestTimeGrain("1m",e.map(l=>x.createKbnUnitFromISO8601Duration(l.value))||["1m","5m","15m","30m","1h","6h","12h","1d"]),n=e.map(l=>l.value==="auto"?{...l,description:c}:l);return J(n,r,t.azureMonitor?.timeGrain)},[e,r,t.azureMonitor?.timeGrain]);return o.createElement(W,{label:"Time grain"},o.createElement(C.Ph,{inputId:"azure-monitor-metrics-time-grain-field",value:t.azureMonitor?.timeGrain,onChange:a,options:i}))},Vr=({onQueryChange:t,query:e})=>{const[r,s]=(0,o.useState)(e.azureMonitor?.top??""),a=(0,o.useCallback)(c=>{c.target instanceof HTMLInputElement&&s(c.target.value)},[]),i=(0,o.useCallback)(()=>{const c=Rr(e,r);t(c)},[t,e,r]);return o.createElement(W,{label:"Top"},o.createElement(X.I,{id:"azure-monitor-metrics-top-field",value:r,onChange:a,onBlur:i,width:16}))};function mt(t,e,r){const[s]=(0,o.useState)(()=>Math.random()),[a,i]=(0,o.useState)(),c=(0,o.useMemo)(()=>a??[],[a]);return(0,o.useEffect)(()=>{t().then(n=>{i(n),e(s,void 0)}).catch(n=>{e(s,n)})},r),c}const xe=t=>!t||!t.length?{resourceGroup:"",resourceName:""}:{resourceGroup:t[0].resourceGroup??"",resourceName:t[0].resourceName??""},xr=(t,e,r,s)=>{const{subscription:a}=t,{metricNamespace:i,resources:c}=t.azureMonitor??{},{resourceGroup:n,resourceName:u}=xe(c);return mt(async()=>{if(!a||!n||!u)return;const p=await e.azureMonitorDatasource.getMetricNamespaces({subscription:a,metricNamespace:i,resourceGroup:n,resourceName:u},!1),g=dt(p,i);return!i&&g.length&&r(ct(t,g[0].value)),g},s,[a,i,n,u])},$r=(t,e,r,s)=>{const{subscription:a}=t,{metricNamespace:i,metricName:c,resources:n,customNamespace:u}=t.azureMonitor??{},{resourceGroup:l,resourceName:p}=xe(n);return mt(async()=>{if(!a||!i||!l||!p)return;const g=await e.azureMonitorDatasource.getMetricNames({subscription:a,resourceGroup:l,resourceName:p,metricNamespace:i,customNamespace:u});return dt(g,c)},s,[a,l,p,i,u])},pt={aggOptions:[],timeGrains:[],dimensions:[],isLoading:!1,supportedAggTypes:[],primaryAggType:void 0},Wr=(t,e,r)=>{const[s,a]=(0,o.useState)(pt),{subscription:i}=t,{resources:c,metricNamespace:n,metricName:u,aggregation:l,timeGrain:p,customNamespace:g}=t.azureMonitor??{},{resourceGroup:d,resourceName:h}=xe(c);return(0,o.useEffect)(()=>{if(!i||!d||!h||!n||!u){a(pt);return}e.azureMonitorDatasource.getMetricMetadata({subscription:i,resourceGroup:d,resourceName:h,metricNamespace:n,metricName:u,customNamespace:g}).then(y=>{const f=(y.supportedAggTypes||[y.primaryAggType]).map(b=>({label:b,value:b}));a({aggOptions:f,timeGrains:y.supportedTimeGrains,dimensions:y.dimensions,isLoading:!1,supportedAggTypes:y.supportedAggTypes??[],primaryAggType:y.primaryAggType})})},[e,i,d,h,n,u,g]),(0,o.useEffect)(()=>{const y=l||s.primaryAggType,f=p||"auto";(y!==l||f!==p)&&r({...t,azureMonitor:{...t.azureMonitor,aggregation:y,timeGrain:f,allowedTimeGrainsMs:s.timeGrains.filter(b=>b.value!=="auto").map(b=>Re.intervalToMs(x.createKbnUnitFromISO8601Duration(b.value)))}})},[r,s,l,p,t]),s};function dt(t,e){const r=t.map(It);return e&&!r.find(s=>s.value===e.toLowerCase())&&r.push({label:e,value:e}),r}const Ur=({data:t,query:e,datasource:r,variableOptionGroup:s,onChange:a,setError:i})=>{const c=Wr(e,r,a),n=xr(e,r,a,i),u=$r(e,r,a,i),l=e.azureMonitor?.resources?.map(h=>({subscription:e.subscription,resourceGroup:h.resourceGroup,metricNamespace:e.azureMonitor?.metricNamespace,resourceName:h.resourceName,region:e.azureMonitor?.region}))??[],p=h=>zr[h?.toLocaleLowerCase()??""]??!1,g=(h,y)=>{if(y.length===0)return!1;const f=V(h.uri,h.location),b=V(y[0].uri,y[0].location);return f.subscription!==b.subscription||f.region!==b.region||f.metricNamespace?.toLocaleLowerCase()!==b.metricNamespace?.toLocaleLowerCase()||!p(f.metricNamespace)},d=h=>{if(h.length===0)return"";const y=V(h[0].uri,h[0].location);return p(y.metricNamespace)?"You can select items of the same resource type and location. To select resources of a different resource type or location, please first uncheck your current selection.":""};return o.createElement("span",{"data-testid":T.components.queryEditor.metricsQueryEditor.container.input},o.createElement(A.EditorRows,null,o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,o.createElement(Qe,{query:e,datasource:r,variableOptionGroup:s,onQueryChange:a,setError:i,selectableEntryTypes:[R.Resource],resources:l??[],queryType:"metrics",disableRow:g,renderAdvanced:(h,y)=>o.createElement(Ar,{resources:h,onChange:y}),selectionNotice:d}),o.createElement(Qr,{metricNamespaces:n,query:e,datasource:r,variableOptionGroup:s,onQueryChange:a,setError:i}),o.createElement(Lr,{metricNames:u,query:e,datasource:r,variableOptionGroup:s,onQueryChange:a,setError:i}),o.createElement(Ir,{query:e,datasource:r,variableOptionGroup:s,onQueryChange:a,setError:i,aggregationOptions:c?.aggOptions??[],isLoading:c.isLoading}),o.createElement(Pr,{query:e,datasource:r,variableOptionGroup:s,onQueryChange:a,setError:i,timeGrainOptions:c?.timeGrains??[]}))),o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,o.createElement(Gr,{data:t,query:e,datasource:r,variableOptionGroup:s,onQueryChange:a,setError:i,dimensionOptions:c?.dimensions??[]}))),o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,o.createElement(Vr,{query:e,datasource:r,variableOptionGroup:s,onQueryChange:a,setError:i}),o.createElement(Dr,{query:e,datasource:r,variableOptionGroup:s,onQueryChange:a,setError:i})))))},Or=({query:t,onQueryChange:e})=>{const r=[{value:m.AzureMonitor,label:"Metrics"},{value:m.LogAnalytics,label:"Logs"},{value:m.AzureTraces,label:"Traces"},{value:m.AzureResourceGraph,label:"Azure Resource Graph"}],s=(0,o.useCallback)(a=>{a.value&&a.value!==t.queryType&&e({refId:t.refId,datasource:t.datasource,queryType:a.value})},[e,t]);return o.createElement("span",{"data-testid":T.components.queryEditor.header.select},o.createElement(A.EditorHeader,null,o.createElement(A.InlineSelect,{label:"Service",value:t.queryType,placeholder:"Service...",allowCustomValue:!0,options:r,onChange:s})))};var Xr=v(82965),jr=v(24799),ft=v(65583),Br=v(206),Hr=v(27501),Jr=v(44342);const $e=(t,e,r,s)=>{t==="filters"?e[t]=r.map(a=>a.value):(e[t]=r.value,t==="property"&&(e.filters=[])),s(e)},Kr=async(t,e,r,s,a,i,c)=>{const{azureTraces:n}=t;if(!n)return[];const{resources:u}=n;if(!u||!c)return[];const l=c.property;if(!l)return[];const p=`let ${l} = toscalar(union isfuzzy=true ${s.join(",")}
  | where $__timeFilter(timestamp)
  | summarize count=count() by ${l}
  | summarize make_list(pack_all()));
  print properties = bag_pack("${l}", ${l});`,g=await(0,ft.n)(e.azureLogAnalyticsDatasource.query({requestId:"azure-traces-properties-req",interval:"",intervalMs:0,scopedVars:{},timezone:"",startTime:0,app:Br.zj.Unknown,targets:[{...t,azureLogAnalytics:{resources:u,query:p},queryType:m.LogAnalytics}],range:r}));if(g.data.length>0){const d=g.data[0];if(d.fields.length>0){const y=JSON.parse(d.fields[0].values.toArray()[0])[l].map(f=>{let b=f[l];return f[l]===""&&(b="<Empty>"),{label:b.toString(),value:f[l].toString(),count:f.count}});return a.set(l,y),i(a),y}}return[]};function Zr(t){function e(r,s,a){return o.createElement(qr,{...t,item:r,onChange:s,onDelete:a})}return e}const Yr=t=>{const{data:e,innerProps:r,innerRef:s,isFocused:a,isSelected:i}=t,c=(0,B.l4)(),n=(0,Hr.D)(c),u=l=>{t.selectOption({...e}),l.stopPropagation(),l.preventDefault()};return o.createElement("div",{ref:s,className:(0,k.cx)(n.option,a&&n.optionFocused,i&&n.optionSelected,e.isDisabled&&n.optionDisabled),...r,"aria-label":"Select option",title:e.title,onClick:u},o.createElement("div",{className:n.optionBody},o.createElement(tt.X,{value:i,label:e.label?`${e.label} - (${e.count})`:""})))},qr=t=>{const{query:e,datasource:r,propertyMap:s,setPropertyMap:a,timeRange:i,queryTraceTypes:c,properties:n,item:u,onChange:l,onDelete:p,variableOptionGroup:g}=t,[d,h]=(0,o.useState)(!1),[y,f]=(0,o.useState)(J(s.get(u.property??"")??[],g)),[b,z]=(0,o.useState)(u.filters?u.filters.map(M=>({value:M,label:M===""?"<Empty>":M})):[]),S=async()=>{if(h(!0),u.property&&u.property!==""){const U=s.get(u.property??"");if(U)return f(J(U,g)),h(!1),Promise.resolve(U);{const D=await Kr(e,r,i,c,s,a,u);return f(J(D,g)),h(!1),D}}const M=[];return Promise.resolve(M)};return o.createElement(lt.Lh,{spacing:"none"},o.createElement(C.Ph,{menuShouldPortal:!0,placeholder:"Property",value:u.property?{value:u.property,label:u.property}:null,options:J(n.map(M=>({label:M,value:M})),g),onChange:M=>$e("property",u,M,l),width:25}),o.createElement(Jr.d,{placeholder:"Operator",value:u.operation?{label:u.operation==="eq"?"=":"!=",value:u.operation}:void 0,options:[{label:"=",value:"eq"},{label:"!=",value:"ne"}],onChange:M=>$e("operation",u,M,l),defaultValue:"eq"}),o.createElement(C.M8,{blurInputOnSelect:!1,menuShouldPortal:!0,placeholder:"Value",value:b,loadOptions:S,isLoading:d,onOpenMenu:S,onChange:M=>z(M),width:35,defaultOptions:y,isClearable:!0,components:{Option:Yr},closeMenuOnSelect:!1,onCloseMenu:()=>$e("filters",u,b,l),hideSelectedOptions:!1}),o.createElement(A.AccessoryButton,{"aria-label":"Remove",icon:"times",variant:"secondary",onClick:p,type:"button"}))},Yo=null,_r={availabilityResults:{label:"Availablity Results",description:"Availability test results."},dependencies:{label:"Dependencies",description:"Calls your application makes to other services such as databases or REST APIs."},customEvents:{label:"Custom Events",description:"Calls to TrackEvent that are inserted to monitor usage."},exceptions:{label:"Exceptions",description:"Exceptions that are logged via TrackException, or uncaught exceptions."},pageViews:{label:"Page Views",description:"Web client telemetry to create page view reports."},requests:{label:"Requests",description:"HTTP requests received by the application."},traces:{label:"Traces",description:"Diagnostic logs emitted using TrackTrace and similar methods. Note: Traces are not visualised if the result format is set to Trace"}},qo={AppAvailabilityResults:"availabilityResults",AppDependencies:"dependencies",AppEvents:"events",AppExceptions:"exceptions",AppPageViews:"pageViews",AppRequests:"requests",AppTraces:"traces"},es=["operationId","duration","id","name","problemId","operation_ParentId","timestamp","customDimensions","operation_Name"],fe={appId:"ResourceGUID",application_Version:"AppVersion",appName:"_ResourceId",client_Browser:"ClientBrowser",client_City:"ClientCity",client_CountryOrRegion:"ClientCountryOrRegion",client_IP:"ClientIP",client_Model:"ClientModel",client_OS:"ClientOS",client_StateOrProvince:"ClientStateOrProvince",client_Type:"ClientType",cloud_RoleInstance:"AppRoleInstance",cloud_RoleName:"AppRoleName",customDimensions:"Properties",customMeasurements:"Measurements",duration:"DurationMs",id:"Id",iKey:"IKey",itemCount:"ItemCount",itemId:"_ItemId",itemType:"Type",name:"Name",operation_Id:"OperationId",operation_Name:"OperationName",operation_ParentId:"OperationParentId",operation_SyntheticSource:"OperationSyntheticSource",performanceBucket:"PerformanceBucket",sdkVersion:"SDKVersion",session_Id:"SessionId",success:"Success",timestamp:"TimeGenerated",user_AccountId:"UserAccountId",user_AuthenticatedId:"UserAuthenticatedId",user_Id:"UserId"},ts={...fe,location:"Location",message:"Message",size:"Size"},rs={...fe,data:"Data",resultCode:"ResultCode",target:"Target",type:"DependencyType"},ss=(0,w.omit)(fe,["duration","id","success","performanceBucket"]),os=(0,w.omit)({...fe,url:"Url"},["success"]),as={resultCode:"ResultCode",source:"Source",url:"Url"},is=(0,w.omit)({...fe,assembly:"Assembly",details:"Details",handledAt:"HandledAt",innermostAssembly:"InnermostAssembly",innermostMessage:"InnermostMessage",innermostMethod:"InnermostMethod",innermostType:"InnermostType",message:"Message",method:"Method",outerAssembly:"OuterAssembly",outerMessage:"OuterMessage",outerMethod:"OuterMethod",outerType:"OuterType",problemId:"ProblemId",severityLevel:"SeverityLevel",type:"ExceptionType"},["duration","id","name","performanceBucket","success"]),ns=(0,w.omit)({message:"Message",severityLevel:"SeverityLevel"},["duration","id","name","performanceBucket","success"]),We={availabilityResults:ts,dependencies:rs,customEvents:ss,exceptions:is,pageViews:os,requests:as,traces:ns},_o=Object.entries(We).reduce((t,[e,r])=>({...t,[e]:Object.keys((0,w.omit)(r,es)).join(",")}),{});function cs(t,e){return{...t,azureTraces:{...t.azureTraces,operationId:e}}}function us(t,e){return{...t,azureTraces:{...t.azureTraces,resultFormat:e}}}function ls(t,e){return{...t,azureTraces:{...t.azureTraces,traceTypes:e}}}function ms(t,e){return{...t,azureTraces:{...t.azureTraces,filters:e}}}const ps=({query:t,datasource:e,onQueryChange:r,variableOptionGroup:s})=>{const{azureTraces:a}=t,i=a?.traceTypes?a.traceTypes:Object.keys(We),c=new Set(["customDimensions","customMeasurements","details","duration","id","itemId","operation_Id","operation_ParentId","timestamp"]),n=(0,w.uniq)(i.map(S=>Object.keys(We[S])).flat()).filter(S=>!c.has(S)),[u,l]=(0,o.useState)(new Map),p=(0,o.useMemo)(()=>t.azureTraces?.filters??[],[t.azureTraces?.filters]),[g,d]=(0,o.useState)(p),h=e.azureLogAnalyticsDatasource.timeSrv,[y,f]=(0,o.useState)(h.timeRange());(S=>{y!==null&&(y.raw.from.toString()!==S.raw.from.toString()||y.raw.to.toString()!==S.raw.to.toString())&&f({...S})})(h.timeRange()),(0,o.useEffect)(()=>{l(new Map)},[y,t.azureTraces?.resources,t.azureTraces?.traceTypes,t.azureTraces?.operationId]);const z=S=>{let M=!1;const U=S.map(D=>(D.property!==""&&D.filters&&D.filters.length>0&&D.operation!==""?M=!0:M=!1,{property:D.property??"",filters:D.filters??[],operation:D.operation??"eq"}));d(U),(M||p.length>0&&U.length===0)&&r(ms(t,U))};return o.createElement(jr.g,{label:"Filters"},o.createElement(A.EditorList,{items:g,onChange:z,renderItem:Zr({query:t,datasource:e,propertyMap:u,setPropertyMap:l,timeRange:y,queryTraceTypes:i,properties:n,variableOptionGroup:s})}))},ds=({query:t,variableOptionGroup:e,onQueryChange:r})=>{const s=Object.entries(_r).map(([c,n])=>({label:n.label,description:n.description,value:c})),a=(0,o.useCallback)(c=>{const n=ls(t,c.map(u=>u.value??""));r(n)},[r,t]),i=(0,o.useMemo)(()=>[...s,e],[s,e]);return o.createElement(W,{label:"Event Type"},o.createElement(C.NU,{placeholder:"Choose event types",inputId:"azure-monitor-traces-type-field",value:Ce([...s,...e.options],t.azureTraces?.traceTypes??[]),onChange:a,options:i,allowCustomValue:!0,isClearable:!0,"aria-label":T.components.queryEditor.tracesQueryEditor.traceTypes.select}))},fs=({query:t,datasource:e,subscriptionId:r,variableOptionGroup:s,onChange:a,setError:i})=>{const c=(d,h)=>{if(h.length===0)return!1;const y=V(d.uri,d.location).metricNamespace?.toLowerCase(),f=V(h[0].uri,h[0].location).metricNamespace?.toLowerCase();return y!==f},[n,u]=(0,o.useState)(t.azureTraces?.operationId??""),l=(0,Xr.Z)(t.azureTraces?.operationId);(0,o.useEffect)(()=>{t.azureTraces?.operationId&&l!==t.azureTraces.operationId&&u(t.azureTraces.operationId)},[u,l,t,n]);const p=(0,o.useCallback)(d=>{d.target instanceof HTMLInputElement&&u(d.target.value)},[]),g=(0,o.useCallback)(d=>{const h=cs(t,n);a(h)},[a,n,t]);return o.createElement("span",{"data-testid":T.components.queryEditor.tracesQueryEditor.container.input},o.createElement(A.EditorRows,null,o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,o.createElement(Qe,{query:t,datasource:e,subscriptionId:r,variableOptionGroup:s,onQueryChange:a,setError:i,selectableEntryTypes:[R.Subscription,R.ResourceGroup,R.Resource,R.Variable],resources:t.azureTraces?.resources??[],queryType:"traces",disableRow:c,renderAdvanced:(d,h)=>o.createElement(it,{resources:d,onChange:h}),selectionNotice:()=>"You may only choose items of the same resource type."}))),o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,o.createElement(ds,{datasource:e,onQueryChange:a,query:t,setError:i,variableOptionGroup:s}),o.createElement(W,{label:"Operation ID"},o.createElement(X.I,{id:"azure-monitor-traces-operation-id-field",value:n,onChange:p,onBlur:g,width:40})))),o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,o.createElement(ps,{datasource:e,onQueryChange:a,query:t,setError:i,variableOptionGroup:s}))),o.createElement(A.EditorRow,null,o.createElement(A.EditorFieldGroup,null,o.createElement(_e,{datasource:e,setError:i,query:t,variableOptionGroup:s,onQueryChange:a,inputId:"azure-monitor-traces",options:[{label:"Table",value:j.Table},{label:"Trace",value:j.Trace}],defaultValue:j.Table,setFormatAs:us,resultFormat:t.azureTraces?.resultFormat})))))};var gs=v(10322),hs=v.n(gs);const bs="select";function Ue(t){let e=t;return e.queryType||(e={...e,queryType:m.AzureMonitor}),e=ys(e),e.queryType===m.AzureMonitor&&e.azureMonitor&&(e=vs(e),e=ws(e),e=Ss(e),e=zs(e),e=Es(e)),(e.azureMonitor?.resourceGroup||e.azureMonitor?.resourceName)&&(e=ks(e)),e.azureLogAnalytics?.resource&&(e={...e,azureLogAnalytics:{...e.azureLogAnalytics,resources:[e.azureLogAnalytics.resource]}},delete e.azureLogAnalytics?.resource),e}function vs(t){let e=t;if(e.azureMonitor?.timeGrainUnit&&e.azureMonitor.timeGrain!=="auto"){const r=x.createISO8601Duration(e.azureMonitor.timeGrain??"auto",e.azureMonitor.timeGrainUnit);e=ut(e,r),delete e.azureMonitor?.timeGrainUnit}return e}function ys(t){let e=t;return e.azureLogAnalytics?.query?.match(/\$__from\s/gi)&&(e=Pe(e,e.azureLogAnalytics.query.replace(/\$__from\s/gi,"$__timeFrom() "))),e.azureLogAnalytics?.query?.match(/\$__to\s/gi)&&(e=Pe(e,e.azureLogAnalytics.query.replace(/\$__to\s/gi,"$__timeTo() "))),e}function ws(t){return!(t.azureMonitor?.metricNamespace&&t.azureMonitor.metricNamespace!==bs)&&t.azureMonitor?.metricDefinition?{...t,azureMonitor:{...t.azureMonitor,metricNamespace:t.azureMonitor.metricDefinition,metricDefinition:void 0}}:t}function Ss(t){let e=t;const r=e.azureMonitor?.dimension;return r&&r!=="None"&&(e=Mr(e,r,"eq",[e.azureMonitor?.dimensionFilter||""])),delete e.azureMonitor?.dimension,delete e.azureMonitor?.dimensionFilter,e}function zs(t){const e=t.azureMonitor;if(!e)return t;const r=[],s=e.dimensionFilters;return s&&s.length>0&&(s.forEach(a=>{const i={dimension:a.dimension,operator:a.operator};if(!a.filters&&a.filter)r.push({...i,filters:[a.filter]});else{let c=!1;if(a.filters&&a.filter){for(const n of a.filters)if(a.filter===n){c=!0;break}!c&&a.filter!=="*"&&a.filters.push(a.filter),r.push({...i,filters:a.filters})}}}),r.length>0)?{...t,azureMonitor:{...e,dimensionFilters:r}}:t}function Es(t){if(t.azureMonitor?.resourceUri&&!t.azureMonitor.resourceUri.startsWith("$")){const e=V(t.azureMonitor.resourceUri),r=e?.subscription&&e?.resourceGroup&&e?.resourceName;return{...t,subscription:e?.subscription,azureMonitor:{...t.azureMonitor,resources:[{resourceGroup:e?.resourceGroup,resourceName:e?.resourceName}],metricNamespace:e?.metricNamespace,resourceUri:r?void 0:t.azureMonitor.resourceUri}}}return t}function ks(t){let e=t;return e.azureMonitor?.resourceGroup&&e.azureMonitor?.resourceName&&(e={...e,azureMonitor:{...e.azureMonitor,resources:[{resourceGroup:e.azureMonitor.resourceGroup,resourceName:e.azureMonitor.resourceName}]}},delete e.azureMonitor?.resourceGroup,delete e.azureMonitor?.resourceName),e}const As={queryType:m.AzureMonitor},Ts=t=>{const e=(0,w.defaults)({},t,As),r=Ue(e);return hs()(r,t)?t:r},Ns=(t,e)=>{const r=(0,o.useMemo)(()=>Ts(t),[t]);return(0,o.useEffect)(()=>{r!==t&&e(r)},[r,t,e]),r},Ms=({query:t,datasource:e,onChange:r,onRunQuery:s,data:a})=>{const[i,c]=Ke(),n=(0,o.useMemo)(()=>(0,w.debounce)(s,500),[s]),u=(0,o.useCallback)(d=>{r(d),n()},[r,n]),l=Ns(t,u),p=l.subscription||e.azureMonitorDatasource.defaultSubscriptionId,g={label:"Template Variables",options:e.getVariables().map(d=>({label:d,value:d}))};return o.createElement("div",{"data-testid":"azure-monitor-query-editor"},o.createElement(Or,{query:l,onQueryChange:u}),o.createElement(Rs,{data:a,subscriptionId:p,query:l,datasource:e,onChange:u,variableOptionGroup:g,setError:c}),i&&o.createElement(o.Fragment,null,o.createElement(Q,{v:2}),o.createElement(H.b,{severity:"error",title:"An error occurred while requesting metadata from Azure Monitor"},i instanceof Error?i.message:i)))},Rs=({data:t,subscriptionId:e,query:r,datasource:s,variableOptionGroup:a,onChange:i,setError:c})=>{switch(r.queryType){case m.AzureMonitor:return o.createElement(Ur,{data:t,query:r,datasource:s,onChange:i,variableOptionGroup:a,setError:c});case m.LogAnalytics:return o.createElement(nt,{subscriptionId:e,query:r,datasource:s,onChange:i,variableOptionGroup:a,setError:c});case m.AzureResourceGraph:return o.createElement(qe,{subscriptionId:e,query:r,datasource:s,onChange:i,variableOptionGroup:a,setError:c});case m.AzureTraces:return o.createElement(fs,{subscriptionId:e,query:r,datasource:s,onChange:i,variableOptionGroup:a,setError:c});default:const n=r.queryType;return o.createElement(H.b,{title:"Unknown query type"},(n==="Application Insights"||n==="Insights Analytics")&&o.createElement(o.Fragment,null,n," was deprecated in Grafana 9. See the"," ",o.createElement("a",{href:"https://grafana.com/docs/grafana/latest/datasources/azuremonitor/deprecated-application-insights/",target:"_blank",rel:"noreferrer"},"deprecation notice")," ","to get more information about how to migrate your queries. This is the current query definition:",o.createElement(Ie.p,{height:"200px",readOnly:!0,language:"json",value:JSON.stringify(r,null,4)})))}},Cs=Ms;var Is=v(53208),Fs=v(59980),Gs=v(9471),gt=v(52666),ge=v(22069),Ds=v(28674),ht=v(19349),Ae=v(67483);class Ls{constructor(e,r,s){this.rawQueryString=e,this.options=r,this.defaultTimeField=s}generate(){let e=this.rawQueryString;const r=/\$__([_a-zA-Z0-9]+)\(([^()]*)\)/gi;e=e.replace(r,(i,c,n)=>c==="contains"?this.getMultiContains(n):i),e=e.replace(/\$__escapeMulti\(('[^]*')\)/gi,(i,c)=>this.escape(c)),this.options&&(e=e.replace(r,(i,c,n)=>c==="timeFilter"?this.getTimeFilter(n,this.options):c==="timeFrom"?this.getFrom(this.options):c==="timeTo"?this.getUntil(this.options):i),e=e.replace(/\$__interval/gi,this.options.interval));const s=e;return e=encodeURIComponent(e),{uriString:`query=${e}`,rawQuery:s}}getFrom(e){const r=e.range.from;return`datetime(${(0,Ae.CQ)(r).startOf("minute").toISOString()})`}getUntil(e){if(e.rangeRaw?.to==="now"){const r=Date.now();return`datetime(${(0,Ae.CQ)(r).startOf("minute").toISOString()})`}else{const r=e.range.to;return`datetime(${(0,Ae.CQ)(r).startOf("minute").toISOString()})`}}getTimeFilter(e,r){const s=e||this.defaultTimeField;return r.rangeRaw?.to==="now"?`${s} >= ${this.getFrom(r)}`:`${s}  >= ${this.getFrom(r)} and ${s} <= ${this.getUntil(r)}`}getMultiContains(e){const r=e.indexOf(","),s=e.substring(0,r),a=e.substring(e.indexOf(",")+1);return a&&a.toLowerCase().trim()==="all"?"1 == 1":`${s.trim()} in (${a.trim()})`}escape(e){return e.substring(1,e.length-1).split("','").map(r=>`@'${r}'`).join(", ")}}class ie{constructor(e){this.results=e}parseQueryResult(){let e=[],r=[];for(let s=0;s<this.results.length;s++){if(this.results[s].result.tables.length===0)continue;r=this.results[s].result.tables[0].columns;const a=this.results[s].result.tables[0].rows;this.results[s].query.resultFormat==="time_series"?e=(0,w.concat)(e,this.parseTimeSeriesResult(this.results[s].query,r,a)):e=(0,w.concat)(e,this.parseTableResult(this.results[s].query,r,a))}return e}parseTimeSeriesResult(e,r,s){const a=[];let i=-1,c=-1,n=-1;for(let u=0;u<r.length;u++)i===-1&&r[u].type==="datetime"&&(i=u),c===-1&&r[u].type==="string"&&(c=u),n===-1&&["int","long","real","double"].indexOf(r[u].type)>-1&&(n=u);if(i===-1)throw new Error("No datetime column found in the result. The Time Series format requires a time column.");return(0,w.forEach)(s,u=>{const l=ie.dateTimeToEpoch(u[i]),p=c>-1?u[c]:r[n].name,g=ie.findOrCreateBucket(a,p);g.datapoints.push([u[n],l]),g.refId=e.refId,g.meta={executedQueryString:e.query}}),a}parseTableResult(e,r,s){return{type:"table",columns:(0,w.map)(r,i=>({text:i.name,type:i.type})),rows:s,refId:e.refId,meta:{executedQueryString:e.query}}}parseToVariables(){const e=this.parseQueryResult(),r=[];return(0,w.forEach)(e,s=>{(0,w.forEach)((0,w.flattenDeep)(s.rows),a=>{r.push({text:a,value:a})})}),r}transformToAnnotations(e){const r=this.parseQueryResult(),s=[];return(0,w.forEach)(r,a=>{let i=-1,c=-1,n=-1;for(let u=0;u<a.columns.length;u++)i===-1&&a.columns[u].type==="datetime"&&(i=u),c===-1&&a.columns[u].text.toLowerCase()==="text"&&(c=u),n===-1&&a.columns[u].text.toLowerCase()==="tags"&&(n=u);(0,w.forEach)(a.rows,u=>{s.push({annotation:e.annotation,time:Math.floor(ie.dateTimeToEpoch(u[i])),text:u[c]?u[c].toString():"",tags:u[n]?u[n].trim().split(/\s*,\s*/):[]})})}),s}static findOrCreateBucket(e,r){let s=(0,w.find)(e,["target",r]);return s||(s={target:r,datapoints:[],refId:"",query:""},e.push(s)),s}static dateTimeToEpoch(e){return(0,Ae.CQ)(e).valueOf()}static parseSubscriptions(e){const r=[];if(!e)return r;const s="subscriptionId",a="displayName";for(let i=0;i<e.value.length;i++)(0,w.find)(r,["value",(0,w.get)(e.value[i],s)])||r.push({text:`${(0,w.get)(e.value[i],a)}`,value:(0,w.get)(e.value[i],s)});return r}}const Qs=/([\w\W]+):([\w]+)(?:\s?=\s?([\w\W]+))?/;function Ps(t){return t.functions?t.functions.map(e=>{const r=e.parameters&&e.parameters.split(", ").map(s=>{const a=s.match(Qs);if(!a)return;const[,i,c,n]=a;return{name:i,type:c,defaultValue:n,cslDefaultValue:n}}).filter(s=>!!s);return{name:e.name,body:e.body,inputParameters:r||[]}}):[]}function Vs(t,e,r){const s={name:e,tables:t.tables,functions:Ps(t),majorVersion:0,minorVersion:0};s.functions.push({name:"$__timeFilter",body:"{ true }",inputParameters:[{name:"timeColumn",type:"System.String",defaultValue:'""',cslDefaultValue:'""'}]},{name:"$__timeFrom",body:"{ datetime(2018-06-05T18:09:58.907Z) }",inputParameters:[]},{name:"$__timeTo",body:"{ datetime(2018-06-05T20:09:58.907Z) }",inputParameters:[]},{name:"$__escapeMulti",body:"{ @'\\grafana-vmNetwork(eth0)Total', @'\\hello!'}",inputParameters:[{name:"$myVar",type:"System.String",defaultValue:"$myVar",cslDefaultValue:"$myVar"}]},{name:"$__contains",body:"{ colName in ('value1','value2') }",inputParameters:[{name:"colName",type:"System.String",defaultValue:"colName",cslDefaultValue:"colName"},{name:"$myVar",type:"System.String",defaultValue:"$myVar",cslDefaultValue:"$myVar"}]});const a=r.map(i=>({name:`$${i.name}`,type:"dynamic"}));return{clusterType:"Engine",cluster:{connectionString:e,databases:[s]},database:s,globalParameters:a}}class xs extends ge.CK{constructor(e){super(e),this.instanceSettings=e,this.timeSrv=(0,ht.$t)(),this.resourcePath=`${Y.logAnalytics}`,this.azureMonitorPath=`${Y.azureMonitor}/subscriptions`;const r=He(e);this.azurePortalUrl=Be(r),this.defaultSubscriptionId=this.instanceSettings.jsonData.subscriptionId||""}isConfigured(){return!this.validateDatasource()}filterQuery(e){return e.hide!==!0&&(!!e.azureLogAnalytics?.query&&(!!e.azureLogAnalytics.resources?.length||!!e.azureLogAnalytics.workspace)||!!e.azureTraces?.resources?.length)}async getSubscriptions(){if(!this.isConfigured())return[];const e=`${this.azureMonitorPath}?api-version=2019-03-01`;return await this.getResource(e).then(r=>ie.parseSubscriptions(r))}async getWorkspaces(e){const r=await this.getWorkspaceList(e);return(0,w.map)(r.value,s=>({text:s.name,value:s.id}))||[]}getWorkspaceList(e){const r=(0,P.J)().replace(e||this.defaultSubscriptionId),s=this.azureMonitorPath+`/${r}/providers/Microsoft.OperationalInsights/workspaces?api-version=2017-04-26-preview`;return this.getResource(s)}async getMetadata(e){const r=`${this.resourcePath}/v1${e}/metadata`;return await this.getResource(r)}async getKustoSchema(e){const r=(0,P.J)(),s=r.replace(e,{},le),a=await this.getMetadata(s);return Vs(a,s,r.getVariables())}applyTemplateVariables(e,r){let s;if(e.queryType===m.LogAnalytics&&e.azureLogAnalytics){s=e.azureLogAnalytics;const a=(0,P.J)(),i=s.resources?.map(u=>a.replace(u,r));let c=a.replace(s.workspace,r);!c&&!i&&this.firstWorkspace&&(c=this.firstWorkspace);const n=a.replace(s.query,r,le);return{...e,queryType:e.queryType||m.LogAnalytics,azureLogAnalytics:{resultFormat:s.resultFormat,query:n,resources:i,workspace:c}}}if(e.queryType===m.AzureTraces&&e.azureTraces){s=e.azureTraces;const a=(0,P.J)(),i=s.resources?.map(l=>a.replace(l,r)),c=a.replace(s.query,r,le),n=s.traceTypes?.map(l=>a.replace(l,r)),u=(s.filters??[]).filter(l=>!!l.property).map(l=>{const p=l.filters?.map(g=>a.replace(g??"",r));return{property:a.replace(l.property,r),operation:l.operation||"eq",filters:p||[]}});return{...e,queryType:e.queryType||m.AzureTraces,azureTraces:{resultFormat:s.resultFormat,query:c,resources:i,operationId:a.replace(e.azureTraces?.operationId,r),filters:u,traceTypes:n}}}return e}getDeprecatedDefaultWorkSpace(){return this.instanceSettings.jsonData.logAnalyticsDefaultWorkspace}buildQuery(e,r,s){const i=new Ls((0,P.J)().replace(e,{},le),r,"TimeGenerated").generate().uriString,c=De(s)?`${this.resourcePath}/v1/workspaces/${s}/query?${i}`:`${this.resourcePath}/v1${s}/query?${i}`;return[{datasource:this.getRef(),path:c,resultFormat:"table"}]}async getDefaultOrFirstSubscription(){return this.defaultSubscriptionId?this.defaultSubscriptionId:(await this.getSubscriptions())[0]?.value}async getFirstWorkspace(){if(this.firstWorkspace)return this.firstWorkspace;const e=await this.getDefaultOrFirstSubscription();if(!e)return;const s=(await this.getWorkspaces(e))[0]?.value;return s&&(this.firstWorkspace=s),s}annotationQuery(e){if(!e.annotation.rawQuery)return Promise.reject({message:"Query missing in annotation definition"});const r=this.buildQuery(e.annotation.rawQuery,e,e.annotation.workspace),s=this.doQueries(r);return Promise.all(s).then(a=>new ie(a).transformToAnnotations(e))}doQueries(e){return(0,w.map)(e,r=>this.getResource(r.path).then(s=>({result:s,query:r})).catch(s=>{throw{error:s,query:r}}))}validateDatasource(){if(we(this.instanceSettings)==="clientsecret"){if(!this.isValidConfigField(this.instanceSettings.jsonData.tenantId))return{status:"error",message:"The Tenant Id field is required."};if(!this.isValidConfigField(this.instanceSettings.jsonData.clientId))return{status:"error",message:"The Client Id field is required."}}}isValidConfigField(e){return typeof e=="string"&&e.length>0}}const $s="select";function ne(t){return!!(t&&t!==$s)}class Ws extends ge.CK{constructor(e){super(e),this.instanceSettings=e,this.apiVersion="2018-01-01",this.apiPreviewVersion="2017-12-01-preview",this.listByResourceGroupApiVersion="2021-04-01",this.providerApiVersion="2021-04-01",this.locationsApiVersion="2020-01-01",this.timeSrv=(0,ht.$t)(),this.templateSrv=(0,P.J)(),this.defaultSubscriptionId=e.jsonData.subscriptionId;const r=He(e);this.resourcePath=Y.azureMonitor,this.azurePortalUrl=Be(r)}isConfigured(){return!this.validateDatasource()}filterQuery(e){const r=e?.azureMonitor?.resources&&e.azureMonitor.resources.length>0&&e.azureMonitor.resources.every(a=>ne(a.resourceGroup)&&ne(a.resourceName))&&ne(e?.azureMonitor?.metricDefinition||e?.azureMonitor?.metricNamespace),s=ne(e.azureMonitor?.resourceUri);return!!(e.hide!==!0&&(r||s)&&ne(e?.azureMonitor?.metricName)&&ne(e?.azureMonitor?.aggregation))}applyTemplateVariables(e,r){const s=e.azureMonitor;if(!s)throw new Error("Query is not a valid Azure Monitor Metrics query");const a=(0,P.J)();s.resourceUri&&(s.resourceUri=a.replace(s.resourceUri,r)),s.metricDefinition&&(s.metricDefinition=a.replace(s.metricDefinition,r)),s.timeGrain&&s.timeGrainUnit&&s.timeGrain!=="auto"&&(s.timeGrain=x.createISO8601Duration(s.timeGrain,s.timeGrainUnit));const i=Ue(e),c=i.azureMonitor;if(!c)throw new Error("Query is not a valid Azure Monitor Metrics query");const n=a.replace(i.subscription||this.defaultSubscriptionId,r),u=c.resources?.map(b=>this.replaceTemplateVariables(b,r)).flat(),l=a.replace(c.metricNamespace,r),p=a.replace(c.customNamespace,r),g=a.replace((c.timeGrain||"").toString(),r),d=a.replace(c.aggregation,r),h=a.replace(c.top||"",r),y=(c.dimensionFilters??[]).filter(b=>b.dimension&&b.dimension!=="None").map(b=>{const z=b.filters?.map(S=>a.replace(S??"",r));return{dimension:a.replace(b.dimension,r),operator:b.operator||"eq",filters:z||[]}}),f={...c,resources:u,metricNamespace:l,customNamespace:p,timeGrain:g,allowedTimeGrainsMs:c.allowedTimeGrainsMs,metricName:a.replace(c.metricName,r),region:a.replace(c.region,r),aggregation:d,dimensionFilters:y,top:h||"10",alias:c.alias};return{...e,subscription:n,queryType:m.AzureMonitor,azureMonitor:f}}async getSubscriptions(){return this.isConfigured()?this.getResource(`${this.resourcePath}/subscriptions?api-version=2019-03-01`).then(e=>$.parseSubscriptions(e)):[]}getResourceGroups(e){return this.getResource(`${this.resourcePath}/subscriptions/${e}/resourceGroups?api-version=${this.listByResourceGroupApiVersion}`).then(r=>$.parseResponseValues(r,"name","name"))}async getResourceNames(e,r){const s=this.replaceTemplateVariables(e).map(({metricNamespace:a,subscriptionId:i,resourceGroup:c,region:n})=>{const u=(0,w.startsWith)(a?.toLowerCase(),"microsoft.storage/storageaccounts/")?"microsoft.storage/storageaccounts":a;let l=`${this.resourcePath}/subscriptions/${i}`;c&&(l+=`/resourceGroups/${c}`),l+=`/resources?api-version=${this.listByResourceGroupApiVersion}`;const p=[];return u&&p.push(`resourceType eq '${u}'`),n&&p.push(`location eq '${n}'`),p.length>0&&(l+=`&$filter=${p.join(" and ")}`),r&&(l+=`&$skiptoken=${r}`),this.getResource(l).then(async g=>{let d=[];if((0,w.startsWith)(a?.toLowerCase(),"microsoft.storage/storageaccounts/")){d=$.parseResourceNames(g,"microsoft.storage/storageaccounts");for(let h=0;h<d.length;h++)d[h].text+="/default",d[h].value+="/default"}else d=$.parseResourceNames(g,a);if(g.nextLink){const y=new URL(g.nextLink).searchParams.get("$skiptoken");if(!y)throw Error("unable to request the next page of resources");const f=await this.getResourceNames({metricNamespace:a,subscriptionId:i,resourceGroup:c},y);d=d.concat(f)}return d})});return(await Promise.all(s)).flat()}getMetricNamespaces(e,r){const s=_.buildAzureMonitorGetMetricNamespacesUrl(this.resourcePath,this.apiPreviewVersion,this.replaceSingleTemplateVariables(e),r,this.templateSrv);return this.getResource(s).then(a=>$.parseResponseValues(a,"properties.metricNamespaceName","properties.metricNamespaceName")).then(a=>{if(s.toLowerCase().includes("microsoft.storage/storageaccounts")){const i=["microsoft.storage/storageaccounts","microsoft.storage/storageaccounts/blobservices","microsoft.storage/storageaccounts/fileservices","microsoft.storage/storageaccounts/tableservices","microsoft.storage/storageaccounts/queueservices"];for(const c of i)(0,w.find)(a,["value",c.toLowerCase()])||a.push({value:c,text:c})}return a})}getMetricNames(e){const r=_.buildAzureMonitorGetMetricNamesUrl(this.resourcePath,this.apiVersion,this.replaceSingleTemplateVariables(e),this.templateSrv);return this.getResource(r).then(s=>$.parseResponseValues(s,"name.localizedValue","name.value"))}getMetricMetadata(e){const{metricName:r}=e,s=_.buildAzureMonitorGetMetricNamesUrl(this.resourcePath,this.apiVersion,this.replaceSingleTemplateVariables(e),this.templateSrv);return this.getResource(s).then(a=>$.parseMetadata(a,this.templateSrv.replace(r)))}validateDatasource(){if(we(this.instanceSettings)==="clientsecret"){if(!this.isValidConfigField(this.instanceSettings.jsonData.tenantId))return{status:"error",message:"The Tenant Id field is required."};if(!this.isValidConfigField(this.instanceSettings.jsonData.clientId))return{status:"error",message:"The Client Id field is required."}}}isValidConfigField(e){return typeof e=="string"&&e.length>0}replaceSingleTemplateVariables(e,r){return this.replaceTemplateVariables(e,r)[0]}replaceTemplateVariables(e,r){const s=[{...e}];return Object.keys(e).forEach(i=>{const c=this.templateSrv.replace(s[0][i],r,"raw");if(c.includes(",")){const n=c.split(","),u=[...s];n.forEach((l,p)=>{u.forEach(g=>{p===0?g[i]=l:s.push({...g,[i]:l})})})}else s.forEach(n=>{n[i]=c})}),s}async getProvider(e){return await this.getResource(`${Y.azureMonitor}/providers/${e}?api-version=${this.providerApiVersion}`)}async getLocations(e){const r=new Map;for(const s of e){const a=$.parseLocations(await this.getResource(`${Y.azureMonitor}/subscriptions/${this.templateSrv.replace(s)}/locations?api-version=${this.locationsApiVersion}`));for(const i of a)r.set(i.name,i)}return r}}class Us extends ge.CK{filterQuery(e){return!!e.azureResourceGraph?.query&&!!e.subscriptions&&e.subscriptions.length>0}applyTemplateVariables(e,r){const s=e.azureResourceGraph;if(!s)return e;const a=(0,P.J)(),i=a.getVariables().map(p=>`$${p.name}`),c=ye().find(e.subscriptions,p=>ye().includes(i,p)),u=[...a.replace(c,r,p=>p).split(",").filter(p=>p.length>0),...ye().filter(e.subscriptions,p=>!ye().includes(i,p))],l=a.replace(s.query,r,le);return{...e,queryType:m.AzureResourceGraph,subscriptions:u,azureResourceGraph:{resultFormat:"table",query:l}}}}const Os="/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01",Xs=Er.map(t=>`"${t}"`).join(",");class js extends ge.CK{constructor(e,r){super(e),this.resultLimit=200,this.supportedMetricNamespaces="",this.locationsMap=new Map,this.locations=[],this.search=async(s,a)=>{let i="resources";a==="logs"&&(i+=`
      | union resourcecontainers`),i+=`
        | where id contains "${s}"
        ${await this.filterByType(a)}
        | order by tolower(name) asc
        | limit ${this.resultLimit}
      `;const{data:c}=await this.makeResourceGraphRequest(i);return c.map(n=>{const u=ze(n.id);if(!u||!(u.resourceName||u.resourceGroup||u.subscription))throw new Error("unable to fetch resource details");let l=u.subscription??"",p=R.Subscription;return u.resourceName?(l=u.resourceName,p=R.Resource):u.resourceGroup&&(l=u.resourceGroup,p=R.ResourceGroup),{name:n.name,id:l,uri:n.id,resourceGroupName:n.resourceGroup,type:p,typeLabel:Ve[n.type]||n.type,location:this.locationsMap.get(n.location)?.displayName||n.location}})},this.filterByType=async s=>(this.supportedMetricNamespaces===""&&s!=="logs"&&await this.fetchAllNamespaces(),s==="logs"?`| where type in (${Xs})`:`| where type in (${this.supportedMetricNamespaces})`),this.resourcePath=`${Y.resourceGraph}`,this.azureMonitorDatasource=r}async fetchInitialRows(e,r){const s=await this.getSubscriptions();if(this.locationsMap.size===0&&(this.locationsMap=await this.getLocations(s),this.locations=Array.from(this.locationsMap.values()).map(c=>`"${c.name}"`)),!r)return s;let a=s;const i=r.map(c=>async()=>{if(c.subscription){const n=`/subscriptions/${c.subscription}/resourceGroups/${c.resourceGroup}`;if(c.resourceGroup&&!ae(a,n)){const l=await this.getResourceGroupsBySubscriptionId(c.subscription,e);a=Le(a,`/subscriptions/${c.subscription}`,l)}const u=Ee(c);if(c.resourceName&&!ae(a,u)){const l=await this.getResourcesForResourceGroup(n,e);a=Le(a,n,l)}}});for(const c of i)await c();return a}async fetchAndAppendNestedRow(e,r,s){const a=r.type===R.Subscription?await this.getResourceGroupsBySubscriptionId(r.id,s):await this.getResourcesForResourceGroup(r.id,s);return Le(e,r.uri,a)}async getSubscriptions(){const e=`
    resources
    | join kind=inner (
              ResourceContainers
                | where type == 'microsoft.resources/subscriptions'
                | project subscriptionName=name, subscriptionURI=id, subscriptionId
              ) on subscriptionId
    | summarize count() by subscriptionName, subscriptionURI, subscriptionId
    | order by subscriptionName desc
  `;let r=[],s=!1,a;for(;!s;){let i={};a&&(i={$skipToken:a});const c=await this.makeResourceGraphRequest(e,1,i);if(!c.data.length)throw new Error("No subscriptions were found");r=r.concat(c.data),a=c.$skipToken,s=!a}return r.map(i=>({name:i.subscriptionName,id:i.subscriptionId,uri:`/subscriptions/${i.subscriptionId}`,typeLabel:"Subscription",type:R.Subscription,children:[]}))}async getResourceGroupsBySubscriptionId(e,r){const s=`
    resources
     | join kind=inner (
       ResourceContainers
       | where type == 'microsoft.resources/subscriptions/resourcegroups'
       | project resourceGroupURI=id, resourceGroupName=name, resourceGroup, subscriptionId
     ) on resourceGroup, subscriptionId

     ${await this.filterByType(r)}
     | where subscriptionId == '${e}'
     | summarize count() by resourceGroupName, resourceGroupURI
     | order by resourceGroupURI asc`;let a=[],i=!1,c;for(;!i;){let n={};c&&(n={$skipToken:c});const u=await this.makeResourceGraphRequest(s,1,n);a=a.concat(u.data),c=u.$skipToken,i=!c}return a.map(n=>{const u=ze(n.resourceGroupURI);if(!u||!u.resourceGroup)throw new Error("unable to fetch resource groups");return{name:n.resourceGroupName,uri:n.resourceGroupURI,id:u.resourceGroup,type:R.ResourceGroup,typeLabel:"Resource Group",children:[]}})}async getResourcesForResourceGroup(e,r){if(!this.locations)return[];const{data:s}=await this.makeResourceGraphRequest(`
      resources
      | where id hasprefix "${e}"
      ${await this.filterByType(r)} and location in (${this.locations})
    `);return s.map(a=>{const i=ze(a.id);if(!i||!i.resourceName)throw new Error("unable to fetch resource details");return{name:a.name,id:i.resourceName,uri:a.id,resourceGroupName:a.resourceGroup,type:R.Resource,typeLabel:Ve[a.type]||a.type,locationDisplayName:this.locationsMap.get(a.location)?.displayName||a.location,location:a.location}})}async getResourceURIDisplayProperties(e){const{subscription:r,resourceGroup:s,resourceName:a}=V(e)??{};if(!r)throw new Error("Invalid resource URI passed");const i=`/subscriptions/${r}`,c=`${i}/resourceGroups/${s}`,n=`
    resourcecontainers
    | where type == "microsoft.resources/subscriptions"
    | where id =~ "${i}"
    | project subscriptionName=name, subscriptionId

    | join kind=leftouter (
      resourcecontainers            
            | where type == "microsoft.resources/subscriptions/resourcegroups"
            | where id =~ "${c}"
            | project resourceGroupName=name, resourceGroup, subscriptionId
        ) on subscriptionId

        | join kind=leftouter (
          resources
            | where id =~ "${e}"
            | project resourceName=name, subscriptionId
        ) on subscriptionId

        | project subscriptionName, resourceGroupName, resourceName
    `,{data:u}=await this.makeResourceGraphRequest(n);if(!u.length)throw new Error("unable to fetch resource details");const{subscriptionName:l,resourceGroupName:p,resourceName:g}=u[0];return{subscription:l||r,resourceGroup:p||s,resourceName:g||a}}async getResourceURIFromWorkspace(e){const{data:r}=await this.makeResourceGraphRequest(`
      resources
      | where properties['customerId'] == "${e}"
      | project id
    `);if(!r.length)throw new Error("unable to find resource for workspace "+e);return r[0].id}async makeResourceGraphRequest(e,r=1,s){try{return await this.postResource(this.resourcePath+Os,{query:e,options:{resultFormat:"objectArray",...s}})}catch(a){if(r>0)return this.makeResourceGraphRequest(e,r-1);throw a}}async fetchAllNamespaces(){const e=await this.getSubscriptions();let r=[];for await(const s of e){const a=await this.azureMonitorDatasource.getMetricNamespaces({resourceUri:`/subscriptions/${s.id}`},!0);if(a){const i=a.map(c=>`"${c.value.toLocaleLowerCase()}"`);r=r.concat(i)}}if(r.length===0)throw new Error("Unable to resolve a list of valid metric namespaces. Validate the datasource configuration is correct and required permissions have been granted for all subscriptions. Grafana requires at least the Reader role to be assigned.");this.supportedMetricNamespaces=(0,w.uniq)(r).join(",")}async getLocations(e){const r=e.map(a=>a.id);return await this.azureMonitorDatasource.getLocations(r)}parseRows(e){const r=ee(e),s=[];return r.forEach((a,i)=>{let c=a.resourceName,n=a.resourceName,u=R.Resource;c||(c=a.resourceGroup,n=a.resourceGroup,u=R.ResourceGroup,c||(c=a.subscription,n=a.subscription,u=R.Subscription)),s.push({id:c??"",name:n??"",type:u,uri:Ee(a),typeLabel:Ve[a.metricNamespace?.toLowerCase()??""]??a.metricNamespace??"",locationDisplayName:this.locationsMap.get(a.region??"")?.displayName||a.region,location:a.region})}),s}}function Bs(t){const e=typeof t.rawQuery=="string"?t.rawQuery:null,r=typeof t.workspace=="string"?t.workspace:null;if(!(e&&r&&!t.target?.azureLogAnalytics?.query))return t;const s={...t.target??{},refId:t.target?.refId??"Anno",queryType:m.LogAnalytics,azureLogAnalytics:{query:e,resources:[r]}};return{...t,rawQuery:void 0,workspace:void 0,subscription:void 0,queryType:void 0,target:s}}var Hs=v(49372),Js=v(48976),Z=v(83881);const bt=t=>({subscriptions:t.match(/^Subscriptions\(\)/i),resourceGroups:t.match(/^ResourceGroups\(\)/i),resourceGroupsWithSub:t.match(/^ResourceGroups\(([^\)]+?)(,\s?([^,]+?))?\)/i),namespaces:t.match(/^Namespaces\(([^\)]+?)(,\s?([^,]+?))?\)/i),namespacesWithSub:t.match(/^Namespaces\(([^,]+?),\s?([^,]+?)\)/i),resourceNames:t.match(/^ResourceNames\(([^,]+?),\s?([^,]+?)\)/i),resourceNamesWithSub:t.match(/^ResourceNames\(([^,]+?),\s?([^,]+?),\s?(.+?)\)/i),metricNamespace:t.match(/^MetricNamespace\(([^,]+?),\s?([^,]+?),\s?([^,]+?)\)/i),metricNamespaceWithSub:t.match(/^metricnamespace\(([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?([^,]+?)\)/i),metricNames:t.match(/^MetricNames\(([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?([^,]+?)\)/i),metricNamesWithSub:t.match(/^MetricNames\(([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?(.+?)\)/i),appInsightsMetricNameQuery:t.match(/^AppInsightsMetricNames\(\)/i),appInsightsGroupByQuery:t.match(/^AppInsightsGroupBys\(([^\)]+?)(,\s?([^,]+?))?\)/i),workspacesQuery:t.match(/^workspaces\(\)/i),workspacesQueryWithSub:t.match(/^workspaces\(["']?([^\)]+?)["']?\)/i)}),Ks=t=>{const e=bt(t);return Object.keys(e).some(r=>!!e[r])},Zs=(t,e)=>{const r=bt(t),s=e.azureMonitorDatasource.defaultSubscriptionId,a=()=>r.appInsightsMetricNameQuery?{rawQuery:t,kind:"AppInsightsMetricNameQuery"}:r.appInsightsGroupByQuery?{kind:"AppInsightsGroupByQuery",rawQuery:t,metricName:r.appInsightsGroupByQuery[1]}:r.subscriptions?{kind:"SubscriptionsQuery",rawQuery:t}:r.resourceGroupsWithSub?{kind:"ResourceGroupsQuery",rawQuery:t,subscription:r.resourceGroupsWithSub[1]}:r.resourceGroups&&s?{kind:"ResourceGroupsQuery",rawQuery:t,subscription:s}:r.namespacesWithSub?{kind:"MetricNamespaceQuery",rawQuery:t,subscription:r.namespacesWithSub[1],resourceGroup:r.namespacesWithSub[2]}:r.namespaces&&s?{kind:"MetricNamespaceQuery",rawQuery:t,subscription:s,resourceGroup:r.namespaces[1]}:r.resourceNamesWithSub?{kind:"ResourceNamesQuery",rawQuery:t,subscription:r.resourceNamesWithSub[1],resourceGroup:r.resourceNamesWithSub[2],metricNamespace:r.resourceNamesWithSub[3]}:r.resourceNames&&s?{kind:"ResourceNamesQuery",rawQuery:t,subscription:s,resourceGroup:r.resourceNames[1],metricNamespace:r.resourceNames[2]}:r.metricNamespaceWithSub?{kind:"MetricNamespaceQuery",rawQuery:t,subscription:r.metricNamespaceWithSub[1],resourceGroup:r.metricNamespaceWithSub[2],metricNamespace:r.metricNamespaceWithSub[3],resourceName:r.metricNamespaceWithSub[4]}:r.metricNamespace&&s?{kind:"MetricNamespaceQuery",rawQuery:t,subscription:s,resourceGroup:r.metricNamespace[1],metricNamespace:r.metricNamespace[2],resourceName:r.metricNamespace[3]}:r.metricNames&&s&&r.metricNames[3].indexOf(",")===-1?{kind:"MetricNamesQuery",rawQuery:t,subscription:s,resourceGroup:r.metricNames[1],metricNamespace:r.metricNames[2],resourceName:r.metricNames[3]}:r.metricNamesWithSub?{kind:"MetricNamesQuery",rawQuery:t,subscription:r.metricNamesWithSub[1],resourceGroup:r.metricNamesWithSub[2],metricNamespace:r.metricNamesWithSub[3],resourceName:r.metricNamesWithSub[4]}:r.workspacesQueryWithSub?{kind:"WorkspacesQuery",rawQuery:t,subscription:(r.workspacesQueryWithSub[1]||"").trim()}:r.workspacesQuery&&s?{kind:"WorkspacesQuery",rawQuery:t,subscription:s}:{kind:"SubscriptionsQuery",rawQuery:t};return{refId:"A",queryType:m.GrafanaTemplateVariableFn,grafanaTemplateVariableFn:a(),subscription:s}},Ys=async(t,e)=>{const r=e.azureMonitorDatasource.defaultSubscriptionId;let s="";if(t){const a=e.azureLogAnalyticsDatasource.getDeprecatedDefaultWorkSpace();a?De(a)?s=await e.resourcePickerData.getResourceURIFromWorkspace(a):s=a:s=await e.azureLogAnalyticsDatasource.getFirstWorkspace()||""}return{refId:"A",queryType:m.LogAnalytics,azureLogAnalytics:{query:t,resources:s?[s]:[]},subscription:r}},qs=t=>{const{queryType:e,grafanaTemplateVariableFn:r}=t;if(e!==m.GrafanaTemplateVariableFn||!r)return t;const s={...t};switch("subscription"in r&&(s.subscription=r.subscription),"resourceGroup"in r&&(s.resourceGroup=r.resourceGroup),"metricNamespace"in r&&(s.namespace=r.metricNamespace),"resourceName"in r&&(s.resource=r.resourceName),r.kind){case"SubscriptionsQuery":s.queryType=m.SubscriptionsQuery;break;case"ResourceGroupsQuery":s.queryType=m.ResourceGroupsQuery;break;case"ResourceNamesQuery":s.queryType=m.ResourceNamesQuery;break;case"MetricNamespaceQuery":s.queryType=m.NamespacesQuery;break;case"MetricDefinitionsQuery":s.queryType=m.NamespacesQuery;break;case"MetricNamesQuery":s.queryType=m.MetricNamesQuery;break;case"WorkspacesQuery":s.queryType=m.WorkspacesQuery;break}return s},vt=async(t,e)=>typeof t!="string"?t:Ks(t)?Zs(t,e.datasource):Ys(t,e.datasource),yt=async(t,e)=>{let r=await vt(t,e);return r.queryType===m.GrafanaTemplateVariableFn&&(r=qs(r)),r},_s=({query:t,updateQuery:e,datasource:r})=>{const[s,a]=(0,o.useState)("");(0,o.useEffect)(()=>{a(t.grafanaTemplateVariableFn?.rawQuery||"")},[t.grafanaTemplateVariableFn?.rawQuery]);const i=(0,o.useCallback)(n=>{vt(n,{datasource:r}).then(u=>{u.queryType===m.GrafanaTemplateVariableFn?e(u):e({...t,grafanaTemplateVariableFn:{kind:"UnknownQuery",rawQuery:n}})})},[r,t,e]),c=n=>{a(n.target.value)};return o.createElement(I._,{label:"Grafana template variable function"},o.createElement(X.I,{placeholder:"type a grafana template variable function, ex: Subscriptions()",value:s,onChange:c,onBlur:()=>i(s)}))},wt={label:"-",value:""},eo=t=>{const{query:e,onChange:r,datasource:s}=t,a=[{label:"Subscriptions",value:m.SubscriptionsQuery},{label:"Resource Groups",value:m.ResourceGroupsQuery},{label:"Namespaces",value:m.NamespacesQuery},{label:"Regions",value:m.LocationsQuery},{label:"Resource Names",value:m.ResourceNamesQuery},{label:"Metric Names",value:m.MetricNamesQuery},{label:"Workspaces",value:m.WorkspacesQuery},{label:"Resource Graph",value:m.AzureResourceGraph},{label:"Logs",value:m.LogAnalytics}];typeof t.query=="object"&&t.query.queryType===m.GrafanaTemplateVariableFn&&a.push({label:"Grafana Query Function",value:m.GrafanaTemplateVariableFn});const[i,c]=(0,o.useState)({label:"Template Variables",options:[]}),[n,u]=(0,o.useState)(!1),[l,p]=(0,o.useState)(!1),[g,d]=(0,o.useState)(!1),[h,y]=(0,o.useState)(!1),[f,b]=(0,o.useState)(!1),[z,S]=(0,o.useState)(!1),[M,U]=(0,o.useState)(!1),[D,Te]=(0,o.useState)([]),[ce,he]=(0,o.useState)([]),[be,Ne]=(0,o.useState)([]),[Oe,Xe]=(0,o.useState)([]),[E,G]=(0,o.useState)([]),[L,ue]=Ke(),te=typeof e=="string"?"":e.queryType;(0,o.useEffect)(()=>{yt(e,{datasource:s}).then(N=>{(0,w.isEqual)(e,N)||r(N)})},[e,s,r]),(0,o.useEffect)(()=>{switch(u(!1),p(!1),d(!1),b(!1),S(!1),U(!1),te){case m.ResourceGroupsQuery:case m.WorkspacesQuery:u(!0);break;case m.NamespacesQuery:u(!0),p(!0);break;case m.ResourceNamesQuery:u(!0),p(!0),d(!0),y(!0);break;case m.MetricNamesQuery:u(!0),b(!0),S(!0),U(!0);break;case m.LocationsQuery:u(!0);break}},[te]),(0,o.useEffect)(()=>{const N=[];s.getVariablesRaw().forEach(F=>{(0,w.get)(F,"query.queryType")!==te&&N.push({label:F.label||F.name,value:`$${F.name}`})}),c({label:"Template Variables",options:N})},[s,te]),(0,Fe.Z)(()=>{s.getSubscriptions().then(N=>{Te(N.map(F=>({label:F.text,value:F.value})))})});const O=typeof e=="object"&&e.subscription;(0,o.useEffect)(()=>{O&&s.getResourceGroups(O).then(N=>{he(N.map(F=>({label:F.text,value:F.value})))})},[s,O]);const ve=typeof e=="object"&&e.resourceGroup||"";(0,o.useEffect)(()=>{O&&s.getMetricNamespaces(O,ve).then(N=>{Ne(N.map(F=>({label:F.text,value:F.value})))})},[s,O,ve]),(0,o.useEffect)(()=>{O&&s.azureMonitorDatasource.getLocations([O]).then(N=>{const F=[];N.forEach(Et=>F.push({label:Et.displayName,value:Et.name})),G(F)})},[s,O,ve]);const St=typeof e=="object"&&e.namespace||"";if((0,o.useEffect)(()=>{O&&s.getResourceNames(O,ve,St).then(N=>{Xe(N.map(F=>({label:F.text,value:F.value})))})},[s,O,ve,St]),typeof e=="string")return null;const co=N=>{N.value&&r({...e,queryType:N.value,subscription:void 0,resourceGroup:void 0,namespace:void 0,resource:void 0})},uo=N=>{N.value&&r({...e,subscription:N.value,resourceGroup:void 0,namespace:void 0,resource:void 0})},lo=N=>{r({...e,resourceGroup:N.value,namespace:void 0,resource:void 0})},mo=N=>{r({...e,namespace:N.value,resource:void 0})},po=N=>{r({...e,region:N.value})},fo=N=>{r({...e,resource:N.value})},zt=N=>{r(N)};return o.createElement(o.Fragment,null,o.createElement(I._,{label:"Select query type",labelWidth:20,"data-testid":T.components.variableEditor.queryType.input},o.createElement(C.Ph,{"aria-label":"select query type",onChange:co,options:a,width:25,value:te})),e.queryType===m.LogAnalytics&&o.createElement(o.Fragment,null,o.createElement(nt,{subscriptionId:e.subscription,query:e,datasource:s,onChange:zt,variableOptionGroup:i,setError:ue,hideFormatAs:!0}),L&&o.createElement(o.Fragment,null,o.createElement(Q,{v:2}),o.createElement(H.b,{severity:"error",title:"An error occurred while requesting metadata from Azure Monitor"},L instanceof Error?L.message:L))),e.queryType===m.GrafanaTemplateVariableFn&&o.createElement(_s,{query:e,updateQuery:t.onChange,datasource:s}),n&&o.createElement(I._,{label:"Select subscription",labelWidth:20,"data-testid":T.components.variableEditor.subscription.input},o.createElement(C.Ph,{"aria-label":"select subscription",onChange:uo,options:D.concat(i),width:25,value:e.subscription||null})),(f||l)&&o.createElement(I._,{label:"Select resource group",labelWidth:20,"data-testid":T.components.variableEditor.resourceGroup.input},o.createElement(C.Ph,{"aria-label":"select resource group",onChange:lo,options:f?ce.concat(i):ce.concat(i,wt),width:25,value:e.resourceGroup||null,placeholder:f?void 0:"Optional"})),(z||g)&&o.createElement(I._,{label:"Select namespace",labelWidth:20,"data-testid":T.components.variableEditor.namespace.input},o.createElement(C.Ph,{"aria-label":"select namespace",onChange:mo,options:z?be.concat(i):be.concat(i,wt),width:25,value:e.namespace||null,placeholder:z?void 0:"Optional"})),h&&o.createElement(I._,{label:"Select region",labelWidth:20,"data-testid":T.components.variableEditor.region.input},o.createElement(C.Ph,{"aria-label":"select region",onChange:po,options:E.concat(i),width:25,value:e.region||null,placeholder:"Optional"})),M&&o.createElement(I._,{label:"Select resource",labelWidth:20,"data-testid":T.components.variableEditor.resource.input},o.createElement(C.Ph,{"aria-label":"select resource",onChange:fo,options:Oe.concat(i),width:25,value:e.resource||null})),e.queryType===m.AzureResourceGraph&&o.createElement(o.Fragment,null,o.createElement(qe,{subscriptionId:s.azureLogAnalyticsDatasource.defaultSubscriptionId,query:e,datasource:s,onChange:zt,variableOptionGroup:i,setError:ue}),L&&o.createElement(o.Fragment,null,o.createElement(Q,{v:2}),o.createElement(H.b,{severity:"error",title:"An error occurred while requesting metadata from Azure Monitor"},L instanceof Error?L.message:L))))};class to extends Js.Mg{constructor(e){super(),this.datasource=e,this.templateSrv=(0,P.J)(),this.editor=eo,this.datasource=e,this.query=this.query.bind(this),this.templateSrv=(0,P.J)()}hasValue(...e){return e.every(r=>!!this.templateSrv.replace(r))}query(e){const r=async()=>{const s=await yt(e.targets[0],{datasource:this.datasource});try{switch(s.queryType){case m.SubscriptionsQuery:const a=await this.datasource.getSubscriptions();return{data:a?.length?[(0,Z.g0)(a)]:[]};case m.ResourceGroupsQuery:if(s.subscription&&this.hasValue(s.subscription)){const c=await this.datasource.getResourceGroups(s.subscription);return{data:c?.length?[(0,Z.g0)(c)]:[]}}return{data:[]};case m.NamespacesQuery:if(s.subscription&&this.hasValue(s.subscription)){const c=await this.datasource.getMetricNamespaces(s.subscription,s.resourceGroup);return{data:c?.length?[(0,Z.g0)(c)]:[]}}return{data:[]};case m.ResourceNamesQuery:if(s.subscription&&this.hasValue(s.subscription)){const c=await this.datasource.getResourceNames(s.subscription,s.resourceGroup,s.namespace,s.region);return{data:c?.length?[(0,Z.g0)(c)]:[]}}return{data:[]};case m.MetricNamesQuery:if(s.subscription&&s.resourceGroup&&s.namespace&&s.resource&&this.hasValue(s.subscription,s.resourceGroup,s.namespace,s.resource)){const c=await this.datasource.getMetricNames(s.subscription,s.resourceGroup,s.namespace,s.resource);return{data:c?.length?[(0,Z.g0)(c)]:[]}}return{data:[]};case m.WorkspacesQuery:if(s.subscription&&this.hasValue(s.subscription)){const c=await this.datasource.getAzureLogAnalyticsWorkspaces(s.subscription);return{data:c?.length?[(0,Z.g0)(c)]:[]}}return{data:[]};case m.GrafanaTemplateVariableFn:if(s.grafanaTemplateVariableFn){const c=await this.callGrafanaTemplateVariableFn(s.grafanaTemplateVariableFn);return{data:c?.length?[(0,Z.g0)(c)]:[]}}return{data:[]};case m.LocationsQuery:if(s.subscription&&this.hasValue(s.subscription)){const c=await this.datasource.azureMonitorDatasource.getLocations([s.subscription]),n=[];return c.forEach(u=>{n.push({text:u.displayName,value:u.name})}),{data:n?.length?[(0,Z.g0)(n)]:[]}}default:e.targets[0]=s;const i=await(0,ft.n)(this.datasource.query(e));return{data:i.data,error:i.error?new Error(oe(i.error)):void 0}}}catch(a){return{data:[],error:new Error(oe(a))}}};return(0,Hs.D)(r())}callGrafanaTemplateVariableFn(e){return e.kind==="SubscriptionsQuery"?this.datasource.getSubscriptions():e.kind==="ResourceGroupsQuery"?this.datasource.getResourceGroups(this.replaceVariable(e.subscription)):e.kind==="ResourceNamesQuery"?this.datasource.getResourceNames(this.replaceVariable(e.subscription),this.replaceVariable(e.resourceGroup),this.replaceVariable(e.metricNamespace)):e.kind==="MetricNamespaceQuery"?this.datasource.azureMonitorDatasource.getMetricNamespaces(e,!0):e.kind==="MetricNamesQuery"?this.datasource.azureMonitorDatasource.getMetricNames(e):e.kind==="WorkspacesQuery"?this.datasource.azureLogAnalyticsDatasource.getWorkspaces(this.replaceVariable(e.subscription)):null}replaceVariable(e){return(0,P.J)().replace((e||"").trim())}}class ro extends ge.CK{constructor(e,r=(0,Ds.J)()){super(e),this.templateSrv=r,this.annotations={prepareAnnotation:Bs},this.pseudoDatasource={},this.azureMonitorDatasource=new Ws(e),this.azureLogAnalyticsDatasource=new xs(e),this.azureResourceGraphDatasource=new Us(e),this.resourcePickerData=new js(e,this.azureMonitorDatasource),this.pseudoDatasource={[m.AzureMonitor]:this.azureMonitorDatasource,[m.LogAnalytics]:this.azureLogAnalyticsDatasource,[m.AzureResourceGraph]:this.azureResourceGraphDatasource},this.variables=new to(this)}filterQuery(e){return e.queryType?this.pseudoDatasource[e.queryType]?.filterQuery?.(e)??!0:!1}query(e){const r=new Map;for(const a of e.targets){const i=Ue(a);if(!i.queryType||i.hide||!so(i))continue;if(!r.has(i.queryType)){const n=(0,w.cloneDeep)(e);n.requestId=`${n.requestId}-${i.refId}`,n.targets=[],r.set(i.queryType,n)}r.get(i.queryType)?.targets.push(i)}const s=Array.from(r.entries()).map(([a,i])=>{const c=a===m.AzureTraces?m.LogAnalytics:a,n=this.pseudoDatasource[c];if(!n)throw new Error("Data source not created for query type "+a);return n.query(i)});return s.length===1?s[0]:s.length>1?(0,Is.D)(s).pipe((0,Gs.U)(a=>{const i=[];for(const c of a)for(const n of c.data)i.push(n);return{state:gt.Gu.Done,data:i}})):(0,Fs.of)({state:gt.Gu.Done,data:[]})}targetContainsTemplate(e){if(e.subscription&&this.templateSrv.containsTemplate(e.subscription))return!0;let r;return e.queryType===m.AzureMonitor?r=JSON.stringify(e.azureMonitor):e.queryType===m.LogAnalytics?r=JSON.stringify(e.azureLogAnalytics):e.queryType===m.AzureResourceGraph&&(r=JSON.stringify([e.azureResourceGraph,e.subscriptions])),!!r&&this.templateSrv.containsTemplate(r)}async annotationQuery(e){return this.azureLogAnalyticsDatasource.annotationQuery(e)}getResourceGroups(e){return this.azureMonitorDatasource.getResourceGroups(this.templateSrv.replace(e))}getMetricNamespaces(e,r){let s=`/subscriptions/${e}`;return r&&(s+=`/resourceGroups/${r};`),this.azureMonitorDatasource.getMetricNamespaces({resourceUri:s},!0)}getResourceNames(e,r,s,a){return this.azureMonitorDatasource.getResourceNames({subscriptionId:e,resourceGroup:r,metricNamespace:s,region:a})}getMetricNames(e,r,s,a){return this.azureMonitorDatasource.getMetricNames({subscription:e,resourceGroup:r,metricNamespace:s,resourceName:a})}getAzureLogAnalyticsWorkspaces(e){return this.azureLogAnalyticsDatasource.getWorkspaces(e)}getSubscriptions(){return this.azureMonitorDatasource.getSubscriptions()}interpolateVariablesInQueries(e,r){return e.map(a=>{if(!a.queryType)return a;const i=a.queryType===m.AzureTraces?m.LogAnalytics:a.queryType,c=this.pseudoDatasource[i];return{datasource:c?.getRef(),...c?.applyTemplateVariables(a,r)??a}})}getVariables(){return this.templateSrv.getVariables().map(e=>`$${e.name}`)}getVariablesRaw(){return this.templateSrv.getVariables()}}function so(t){switch(t.queryType){case m.AzureMonitor:return!!t.azureMonitor;case m.LogAnalytics:return!!t.azureLogAnalytics;case m.AzureResourceGraph:return!!t.azureResourceGraph;case m.AzureTraces:return!!t.azureTraces;case m.GrafanaTemplateVariableFn:return!!t.grafanaTemplateVariableFn;default:return!1}}var oo=v(40507),ao=v(41818);const io=t=>{(0,ao.ff)("grafana_ds_azuremonitor_dashboard_loaded",t)},no=new kt.hf(ro).setConfigEditor(Ot).setQueryEditor(Cs);(0,Tt.N$)().subscribe(At.Pl,({payload:{dashboardId:t,orgId:e,userId:r,grafanaVersion:s,queries:a}})=>{const i=a[oo.id],c={hidden:0,visible:0,multiResource:0,count:0};let n={[m.AzureMonitor]:{...c},[m.LogAnalytics]:{...c},[m.AzureResourceGraph]:{...c},[m.AzureTraces]:{...c,table:0,trace:0,operationIdSpecified:0,eventTypesSpecified:0,filtersSpecified:0},[m.SubscriptionsQuery]:{...c},[m.ResourceGroupsQuery]:{...c},[m.NamespacesQuery]:{...c},[m.ResourceNamesQuery]:{...c},[m.MetricNamesQuery]:{...c},[m.WorkspacesQuery]:{...c},[m.GrafanaTemplateVariableFn]:{...c},[m.LocationsQuery]:{...c},unknown:{...c}};i.forEach(u=>{switch(u.queryType===m.AzureMonitor&&(n[m.AzureMonitor][u.hide?"hidden":"visible"]++,u.azureMonitor?.resources&&u.azureMonitor.resources.length>1&&n[m.AzureMonitor].multiResource++),u.queryType===m.LogAnalytics&&(n[m.LogAnalytics][u.hide?"hidden":"visible"]++,u.azureLogAnalytics?.resources&&u.azureLogAnalytics.resources.length>1&&n[m.LogAnalytics].multiResource++),u.queryType===m.AzureResourceGraph&&(n[m.AzureResourceGraph][u.hide?"hidden":"visible"]++,u.subscriptions&&u.subscriptions.length>1&&n[m.AzureResourceGraph].multiResource++),u.queryType===m.AzureTraces&&(n[m.AzureTraces][u.hide?"hidden":"visible"]++,u.azureTraces&&(u.azureTraces.resultFormat&&n[m.AzureTraces][u.azureTraces.resultFormat===j.Trace?j.Trace:j.Table]++,u.azureTraces.resources&&u.azureTraces.resources.length>1&&n[m.AzureTraces].multiResource++,u.azureTraces.operationId&&u.azureTraces.operationId!==""&&n[m.AzureTraces].operationIdSpecified++,u.azureTraces.traceTypes&&u.azureTraces.traceTypes.length>0&&n[m.AzureTraces].eventTypesSpecified++,u.azureTraces.filters&&u.azureTraces.filters.length>0&&n[m.AzureTraces].filtersSpecified++)),u.queryType){case m.AzureMonitor:case m.LogAnalytics:case m.AzureResourceGraph:case m.AzureTraces:case m.SubscriptionsQuery:case m.ResourceGroupsQuery:case m.NamespacesQuery:case m.ResourceNamesQuery:case m.MetricNamesQuery:case m.WorkspacesQuery:case m.GrafanaTemplateVariableFn:case m.LocationsQuery:n[u.queryType].count++;break;default:n.unknown.count++}}),i&&i.length>0&&io({grafana_version:s,dashboard_id:t,org_id:e,azure_monitor_queries:n[m.AzureMonitor].visible,azure_monitor_queries_hidden:n[m.AzureMonitor].hidden,azure_monitor_multiple_resource:n[m.AzureMonitor].multiResource,azure_monitor_query:n[m.AzureMonitor].count,azure_log_analytics_queries:n[m.LogAnalytics].visible,azure_log_analytics_queries_hidden:n[m.LogAnalytics].hidden,azure_log_multiple_resource:n[m.LogAnalytics].multiResource,azure_log_query:n[m.LogAnalytics].count,azure_resource_graph_queries:n[m.AzureResourceGraph].visible,azure_resource_graph_queries_hidden:n[m.AzureResourceGraph].hidden,azure_resource_graph_multiple_subscription:n[m.AzureResourceGraph].multiResource,azure_resource_graph_query:n[m.AzureResourceGraph].count,azure_traces_queries:n[m.AzureTraces].visible,azure_traces_queries_hidden:n[m.AzureTraces].hidden,azure_traces_multiple_resource:n[m.AzureTraces].multiResource,azure_traces_table:n[m.AzureTraces].table,azure_traces_trace:n[m.AzureTraces].trace,azure_traces_operation_id_specified:n[m.AzureTraces].operationIdSpecified,azure_traces_event_type_specified:n[m.AzureTraces].eventTypesSpecified,azure_traces_filters:n[m.AzureTraces].filtersSpecified,azure_traces_query:n[m.AzureTraces].count,azure_subscriptions_query:n[m.SubscriptionsQuery].count,azure_resource_groups_query:n[m.ResourceGroupsQuery].count,azure_namespaces_query:n[m.NamespacesQuery].count,azure_resource_names_query:n[m.ResourceNamesQuery].count,azure_metric_names_query:n[m.MetricNamesQuery].count,azure_workspaces_query:n[m.WorkspacesQuery].count,azure_grafana_template_variable_query:n[m.GrafanaTemplateVariableFn].count,azure_locations_query:n[m.LocationsQuery].count,azure_unknown_query:n.unknown.count})})},89829:()=>{}}]);

//# sourceMappingURL=9046.90e02afe6aabdefa9fea.js.map